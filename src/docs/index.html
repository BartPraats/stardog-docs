<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="description" content="blah blah blah Stardog graph blah">
<title>Stardog Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="book toc2 toc-right">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#stardog-manual">Stardog Manual</a>
<ul class="sectlevel1">
<li><a href="#downloading-stardog">Downloading Stardog</a></li>
<li><a href="#commercial-licensing-support">Commercial Licensing &amp; Support</a></li>
<li><a href="#contributing">Contributing</a></li>
</ul>
</li>
<li><a href="#quick-start-guide">Quick Start Guide</a>
<ul class="sectlevel1">
<li><a href="#linux-and-osx">Linux and OSX</a></li>
<li><a href="#windows">Windows</a></li>
</ul>
</li>
<li><a href="#using-stardog">Using Stardog</a>
<ul class="sectlevel1">
<li><a href="#querying">Querying</a>
<ul class="sectlevel2">
<li><a href="#functions">Functions</a></li>
<li><a href="#describe">DESCRIBE</a></li>
</ul>
</li>
<li><a href="#updating">Updating</a>
<ul class="sectlevel2">
<li><a href="#sparql-update">SPARQL Update</a></li>
<li><a href="#adding-data-with-the-cli">Adding Data with the CLI</a></li>
<li><a href="#removing-data-with-the-cli">Removing Data with the CLI</a></li>
<li><a href="#how-stardog-handles-rdf-parsing">How Stardog Handles RDF Parsing</a></li>
</ul>
</li>
<li><a href="#versioning">Versioning</a>
<ul class="sectlevel2">
<li><a href="#committing-changes">Committing Changes</a></li>
<li><a href="#viewing-revisions">Viewing Revisions</a></li>
<li><a href="#reverting-revisions">Reverting Revisions</a></li>
<li><a href="#viewing-diffs">Viewing Diffs</a></li>
<li><a href="#using-tags">Using Tags</a></li>
<li><a href="#querying-the-revision-history">Querying the Revision History</a></li>
</ul>
</li>
<li><a href="#exporting">Exporting</a></li>
<li><a href="#searching">Searching</a>
<ul class="sectlevel2">
<li><a href="#indexing-strategy">Indexing Strategy</a></li>
<li><a href="#search-in-sparql">Search in SPARQL</a></li>
<li><a href="#searching-with-the-command-line">Searching with the Command Line</a></li>
<li><a href="#query-syntax">Query Syntax</a></li>
</ul>
</li>
<li><a href="#obfuscating">Obfuscating</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#a-screenshot-tour">A Screenshot Tour&#8230;&#8203;</a>
<ul class="sectlevel2">
<li><a href="#login">Login</a></li>
<li><a href="#homepage">Homepage</a></li>
<li><a href="#databases">Databases</a></li>
<li><a href="#db-actions">DB Actions</a></li>
<li><a href="#searching-a-database">Searching a database</a></li>
<li><a href="#users-roles-permissions">Users, Roles, Permissions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#administration">Administration</a>
<ul class="sectlevel1">
<li><a href="#command-line-interface">Command Line Interface</a>
<ul class="sectlevel2">
<li><a href="#help">Help</a></li>
<li><a href="#security-considerations">Security Considerations</a></li>
<li><a href="#command-groups">Command Groups</a></li>
<li><a href="#autocomplete">Autocomplete</a></li>
<li><a href="#how-to-make-a-connection-string">How to Make a Connection String</a></li>
<li><a href="#example-connection-strings">Example Connection Strings</a></li>
</ul>
</li>
<li><a href="#server-admin">Server Admin</a>
<ul class="sectlevel2">
<li><a href="#http-snarl-server-unification">HTTP &amp; SNARL Server Unification</a></li>
<li><a href="#server-security">Server Security</a></li>
<li><a href="#configuring-stardog-server">Configuring Stardog Server</a></li>
<li><a href="#starting-stopping-the-server">Starting &amp; Stopping the Server</a></li>
<li><a href="#server-monitoring-with-watchdog-jmx">Server Monitoring with Watchdog &amp; JMX</a></li>
<li><a href="#locking-stardog-home">Locking Stardog Home</a></li>
<li><a href="#access-audit-logging">Access &amp; Audit Logging</a></li>
</ul>
</li>
<li><a href="#database-admin">Database Admin</a>
<ul class="sectlevel2">
<li><a href="#configuring-a-database">Configuring a Database</a></li>
<li><a href="#configuration-options">Configuration Options</a></li>
<li><a href="#managing-database-status">Managing Database Status</a></li>
<li><a href="#creating-a-database">Creating a Database</a></li>
<li><a href="#database-archetypes">Database Archetypes</a></li>
<li><a href="#database-creation-templates">Database Creation Templates</a></li>
<li><a href="#database-create-options">Database Create Options</a></li>
<li><a href="#repairing-a-database">Repairing a Database</a></li>
<li><a href="#backing-up-and-restoring">Backing Up and Restoring</a></li>
<li><a href="#namespace-prefix-bindings">Namespace Prefix Bindings</a></li>
<li><a href="#index-strategies">Index Strategies</a></li>
<li><a href="#differential-indexes">Differential Indexes</a></li>
<li><a href="#loading-compressed-data">Loading Compressed Data</a></li>
<li><a href="#dropping-a-database">Dropping a Database</a></li>
<li><a href="#using-integrity-constraint-validation">Using Integrity Constraint Validation</a></li>
<li><a href="#migrating-a-database">Migrating a Database</a></li>
<li><a href="#getting-database-information">Getting Database Information</a></li>
<li><a href="#managing-queries">Managing Queries</a></li>
<li><a href="#managing-search-indexes">Managing Search Indexes</a></li>
<li><a href="#transactions-and-database-guarantees">Transactions and Database Guarantees</a></li>
<li><a href="#optimizing-bulk-data-loading">Optimizing Bulk Data Loading</a></li>
</ul>
</li>
<li><a href="#capacity-planning">Capacity Planning</a>
<ul class="sectlevel2">
<li><a href="#memory-usage">Memory usage</a></li>
<li><a href="#disk-usage">Disk usage</a></li>
</ul>
</li>
<li><a href="#using-stardog-on-windows">Using Stardog on Windows</a>
<ul class="sectlevel2">
<li><a href="#running-stardog-as-a-windows-service">Running Stardog as a Windows Service</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#high-availability-cluster">High Availability Cluster</a>
<ul class="sectlevel1">
<li><a href="#what-is-stardog-cluster">What is Stardog Cluster?</a></li>
<li><a href="#what-about-deployment">What about Deployment?</a></li>
<li><a href="#configuring-stardog-cluster">Configuring Stardog Cluster</a></li>
<li><a href="#setting-up-stardog-cluster-with-starman">Setting Up Stardog Cluster with Starman</a>
<ul class="sectlevel2">
<li><a href="#virtual-machine">Virtual Machine</a></li>
<li><a href="#amazon-ec2">Amazon EC2</a></li>
<li><a href="#other-servers">Other Servers</a></li>
</ul>
</li>
<li><a href="#deploying-stardog-cluster">Deploying Stardog Cluster</a></li>
<li><a href="#cluster-management">Cluster Management</a>
<ul class="sectlevel2">
<li><a href="#adding-or-removing-nodes">Adding or removing nodes</a></li>
<li><a href="#listing-nodes">Listing Nodes</a></li>
<li><a href="#undeploying">Undeploying</a></li>
<li><a href="#managing-local-starman-repo">Managing local Starman Repo</a></li>
</ul>
</li>
<li><a href="#stardog-client">Stardog Client</a>
<ul class="sectlevel2">
<li><a href="#adding-removing-data">Adding/Removing data</a></li>
</ul>
</li>
<li><a href="#troubleshooting-zookeeper">Troubleshooting ZooKeeper</a></li>
<li><a href="#stardog-cluster-guarantees">Stardog Cluster Guarantees</a>
<ul class="sectlevel2">
<li><a href="#consistency-guarantees">Consistency Guarantees</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#security">Security</a>
<ul class="sectlevel1">
<li><a href="#resources">Resources</a></li>
<li><a href="#permissions">Permissions</a>
<ul class="sectlevel2">
<li><a href="#wildcards">Wildcards</a></li>
<li><a href="#superusers">Superusers</a></li>
<li><a href="#database-owner-default-permissions">Database Owner Default Permissions</a></li>
<li><a href="#default-security-configuration">Default Security Configuration</a></li>
<li><a href="#setting-password-constraints">Setting Password Constraints</a></li>
<li><a href="#using-a-password-file">Using a Password File</a></li>
</ul>
</li>
<li><a href="#managing-stardog-securely">Managing Stardog Securely</a>
<ul class="sectlevel2">
<li><a href="#users">Users</a></li>
<li><a href="#roles">Roles</a></li>
<li><a href="#databases-2">Databases</a></li>
<li><a href="#permissions-2">Permissions</a></li>
</ul>
</li>
<li><a href="#deploying-stardog-securely">Deploying Stardog Securely</a>
<ul class="sectlevel2">
<li><a href="#configuring-stardog-to-use-ssl">Configuring Stardog to use SSL</a></li>
<li><a href="#configuring-stardog-client-to-use-ssl">Configuring Stardog Client to use SSL</a></li>
</ul>
</li>
<li><a href="#securing-stardog-on-linux">Securing Stardog on Linux</a>
<ul class="sectlevel2">
<li><a href="#creating-a-basic-stardog-environment">Creating A Basic Stardog Environment</a></li>
</ul>
</li>
<li><a href="#introduction-2">Introduction</a>
<ul class="sectlevel2">
<li><a href="#examples-3">Examples</a></li>
<li><a href="#creating-administering-databases">Creating &amp; Administering Databases</a></li>
<li><a href="#creating-a-connection-string">Creating a Connection String</a></li>
<li><a href="#managing-security">Managing Security</a></li>
<li><a href="#using-snarl">Using SNARL</a></li>
<li><a href="#adding-data">Adding Data</a></li>
<li><a href="#removing-data">Removing Data</a></li>
<li><a href="#parameterized-sparql-queries">Parameterized SPARQL Queries</a></li>
<li><a href="#getter-interface">Getter Interface</a></li>
<li><a href="#reasoning">Reasoning</a></li>
<li><a href="#search">Search</a></li>
<li><a href="#snarl-connection-views">SNARL Connection Views</a></li>
<li><a href="#snarl-api-docs">SNARL API Docs</a></li>
</ul>
</li>
<li><a href="#using-sesame">Using Sesame</a>
<ul class="sectlevel2">
<li><a href="#wrap-the-connection-with-code-stardogrepository-code">Wrap the connection with <code>StardogRepository</code></a></li>
<li><a href="#autocommit">Autocommit</a></li>
</ul>
</li>
<li><a href="#using-jena">Using Jena</a>
<ul class="sectlevel2">
<li><a href="#init-in-jena">Init in Jena</a></li>
<li><a href="#add-in-jena">Add in Jena</a></li>
</ul>
</li>
<li><a href="#client-server-stardog">Client-Server Stardog</a></li>
<li><a href="#embedded-stardog">Embedded Stardog</a></li>
<li><a href="#connection-pooling">Connection Pooling</a></li>
<li><a href="#api-deprecation">API Deprecation</a></li>
<li><a href="#support-for-maven">Support for Maven</a></li>
<li><a href="#sparql-protocol">SPARQL Protocol</a></li>
<li><a href="#stardog-http-protocol">Stardog HTTP Protocol</a>
<ul class="sectlevel2">
<li><a href="#generating-urls">Generating URLs</a></li>
<li><a href="#http-headers-code-content-type-code-code-accept-code">HTTP Headers: <code>Content-Type</code> &amp; <code>Accept</code></a></li>
</ul>
</li>
<li><a href="#response-codes">Response Codes</a></li>
<li><a href="#stardog-resources">Stardog Resources</a>
<ul class="sectlevel2">
<li><a href="#a-stardog-database">A Stardog Database</a></li>
<li><a href="#database-size">Database Size</a></li>
<li><a href="#query-evaluation">Query Evaluation</a></li>
<li><a href="#sparql-update-2">SPARQL update</a></li>
<li><a href="#query-plan">Query Plan</a></li>
<li><a href="#transaction-begin">Transaction Begin</a></li>
<li><a href="#transaction-commit">Transaction Commit</a></li>
<li><a href="#transaction-rollback">Transaction Rollback</a></li>
<li><a href="#querying-transactionally">Querying (Transactionally)</a></li>
<li><a href="#adding-data-transactionally">Adding Data (Transactionally)</a></li>
<li><a href="#deleting-data-transactionally">Deleting Data (Transactionally)</a></li>
<li><a href="#clear-database">Clear Database</a></li>
<li><a href="#explanation-of-inferences">Explanation of Inferences</a></li>
<li><a href="#explanation-of-inconsistency">Explanation of Inconsistency</a></li>
<li><a href="#consistency-2">Consistency</a></li>
<li><a href="#listing-integrity-constraints">Listing Integrity Constraints</a></li>
<li><a href="#adding-integrity-constraints">Adding Integrity Constraints</a></li>
<li><a href="#removing-integrity-constraints">Removing Integrity Constraints</a></li>
<li><a href="#clearing-integrity-constraints">Clearing Integrity Constraints</a></li>
<li><a href="#converting-constraints-to-sparql-queries">Converting Constraints to SPARQL Queries</a></li>
</ul>
</li>
<li><a href="#admin-resources">Admin Resources</a>
<ul class="sectlevel2">
<li><a href="#list-databases">List databases</a></li>
<li><a href="#copy-a-database">Copy a database</a></li>
<li><a href="#create-a-new-database">Create a new database</a></li>
<li><a href="#drop-an-existing-database">Drop an existing database</a></li>
<li><a href="#migrate-an-existing-database">Migrate an existing database</a></li>
<li><a href="#optimize-an-existing-database">Optimize an existing database</a></li>
<li><a href="#sets-an-existing-database-online">Sets an existing database online.</a></li>
<li><a href="#sets-an-existing-database-offline">Sets an existing database offline.</a></li>
<li><a href="#set-option-values-to-an-existing-database">Set option values to an existing database.</a></li>
<li><a href="#get-option-values-of-an-existing-database">Get option values of an existing database.</a></li>
<li><a href="#add-a-new-user-to-the-system">Add a new user to the system.</a></li>
<li><a href="#change-user-password">Change user password.</a></li>
<li><a href="#check-if-user-is-enabled">Check if user is enabled.</a></li>
<li><a href="#check-if-user-is-superuser">Check if user is superuser.</a></li>
<li><a href="#listing-users-2">Listing users.</a></li>
<li><a href="#listing-user-roles">Listing user roles.</a></li>
<li><a href="#deleting-users">Deleting users.</a></li>
<li><a href="#enabling-users">Enabling users.</a></li>
<li><a href="#setting-user-roles">Setting user roles.</a></li>
<li><a href="#adding-new-roles">Adding new roles.</a></li>
<li><a href="#listing-roles-2">Listing roles.</a></li>
<li><a href="#listing-users-with-a-specified-role">Listing users with a specified role.</a></li>
<li><a href="#deleting-roles">Deleting roles.</a></li>
<li><a href="#assigning-permissions-to-roles">Assigning permissions to roles.</a></li>
<li><a href="#assigning-permissions-to-users">Assigning permissions to users.</a></li>
<li><a href="#deleting-permissions-from-roles">Deleting permissions from roles.</a></li>
<li><a href="#deleting-permissions-from-users">Deleting permissions from users.</a></li>
<li><a href="#listing-role-permissions">Listing role permissions.</a></li>
<li><a href="#listing-user-permissions">Listing user permissions.</a></li>
<li><a href="#listing-user-effective-permissions">Listing user effective permissions.</a></li>
<li><a href="#shutdown-server">Shutdown server.</a></li>
<li><a href="#query-version-metadata">Query Version Metadata</a></li>
<li><a href="#versioned-commit">Versioned Commit</a></li>
<li><a href="#create-tag">Create Tag</a></li>
<li><a href="#delete-tag">Delete Tag</a></li>
<li><a href="#revert-to-tag">Revert to Tag</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#owl-rule-reasoning">OWL &amp; Rule Reasoning</a>
<ul class="sectlevel1">
<li><a href="#introduction-3">Introduction</a>
<ul class="sectlevel2">
<li><a href="#reasoning-levels">Reasoning Levels</a></li>
</ul>
</li>
<li><a href="#using-reasoning">Using Reasoning</a>
<ul class="sectlevel2">
<li><a href="#query-answering">Query Answering</a></li>
<li><a href="#command-line">Command Line</a></li>
<li><a href="#http">HTTP</a></li>
<li><a href="#code-reasoningconnection-code-api"><code>ReasoningConnection</code> API</a></li>
</ul>
</li>
<li><a href="#explaining-reasoning-results">Explaining Reasoning Results</a>
<ul class="sectlevel2">
<li><a href="#proof-trees">Proof Trees</a></li>
</ul>
</li>
<li><a href="#user-defined-rule-reasoning">User-defined Rule Reasoning</a>
<ul class="sectlevel2">
<li><a href="#stardog-rules-syntax">Stardog Rules Syntax</a></li>
<li><a href="#supported-built-ins">Supported Built-Ins</a></li>
</ul>
</li>
<li><a href="#special-predicates">Special Predicates</a>
<ul class="sectlevel2">
<li><a href="#direct-strict-subclasses-subproperties-direct-types">Direct/Strict Subclasses, Subproperties, &amp; Direct Types</a></li>
<li><a href="#new-individuals-with-swrl">New Individuals with SWRL</a></li>
</ul>
</li>
<li><a href="#query-rewriting">Query Rewriting</a>
<ul class="sectlevel2">
<li><a href="#why-query-rewriting">Why Query Rewriting?</a></li>
</ul>
</li>
<li><a href="#performance-hints">Performance Hints</a>
<ul class="sectlevel2">
<li><a href="#hierarchies-and-queries">Hierarchies and Queries</a></li>
<li><a href="#domains-and-ranges">Domains and Ranges</a></li>
</ul>
</li>
<li><a href="#not-seeing-expected-results">Not Seeing Expected Results?</a>
<ul class="sectlevel2">
<li><a href="#are-variable-types-ambiguous">Are variable types ambiguous?</a></li>
<li><a href="#are-you-using-dl">Are you using DL?</a></li>
<li><a href="#are-you-using-swrl">Are you using SWRL?</a></li>
<li><a href="#do-you-know-what-to-expect">Do you know what to expect?</a></li>
</ul>
</li>
<li><a href="#known-issues">Known Issues</a></li>
<li><a href="#terminology">Terminology</a>
<ul class="sectlevel2">
<li><a href="#databases-3">Databases</a></li>
<li><a href="#queries">Queries</a></li>
<li><a href="#reasoning-2">Reasoning</a></li>
<li><a href="#owl-2-profiles">OWL 2 Profiles</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#integrity-constraint-validation">Integrity Constraint Validation</a>
<ul class="sectlevel1">
<li><a href="#what-is-integrity-constraint-validation">What is Integrity Constraint Validation?</a></li>
<li><a href="#getting-started-with-icv">Getting Started with ICV</a></li>
<li><a href="#icv-owl-2-reasoning">ICV &amp; OWL 2 Reasoning</a>
<ul class="sectlevel2">
<li><a href="#security-note">Security Note</a></li>
</ul>
</li>
<li><a href="#icv-examples">ICV Examples</a>
<ul class="sectlevel2">
<li><a href="#subsumption-constraints">Subsumption Constraints</a></li>
<li><a href="#domain-range-constraints">Domain-Range Constraints</a></li>
<li><a href="#participation-constraints">Participation Constraints</a></li>
<li><a href="#cardinality-constraints">Cardinality Constraints</a></li>
<li><a href="#property-constraints">Property Constraints</a></li>
<li><a href="#complex-constraints">Complex Constraints</a></li>
</ul>
</li>
<li><a href="#explaining-icv-violations">Explaining ICV Violations</a></li>
<li><a href="#using-icv-programmatically">Using ICV Programmatically</a>
<ul class="sectlevel2">
<li><a href="#creating-constraints">Creating Constraints</a></li>
<li><a href="#adding-constraints-to-stardog">Adding Constraints to Stardog</a></li>
<li><a href="#ic-validation">IC Validation</a></li>
<li><a href="#icv-and-transactions">ICV and Transactions</a></li>
</ul>
</li>
<li><a href="#terminology-2">Terminology</a>
<ul class="sectlevel2">
<li><a href="#icv-integrity-constraint-validation">ICV, Integrity Constraint Validation</a></li>
<li><a href="#schema-tbox">Schema, TBox</a></li>
<li><a href="#data-abox">Data, ABox</a></li>
<li><a href="#integrity-constraint">Integrity Constraint</a></li>
<li><a href="#constraints">Constraints</a></li>
<li><a href="#closed-world-assumption-closed-world-reasoning">Closed World Assumption, Closed World Reasoning</a></li>
<li><a href="#open-world-assumption-open-world-reasoning">Open World Assumption, Open World Reasoning</a></li>
<li><a href="#monotonicity">Monotonicity</a></li>
</ul>
</li>
<li><a href="#overview">Overview</a></li>
<li><a href="#building-spring-for-stardog">Building Spring for Stardog</a></li>
<li><a href="#basic-spring">Basic Spring</a></li>
<li><a href="#spring-batch">Spring Batch</a></li>
<li><a href="#examples-4">Examples</a>
<ul class="sectlevel2">
<li><a href="#query-with-select-queries">query() with SELECT queries</a></li>
<li><a href="#dowithgetter">doWithGetter</a></li>
<li><a href="#dowithadder">doWithAdder</a></li>
<li><a href="#dowithremover">doWithRemover</a></li>
<li><a href="#construct">construct()</a></li>
<li><a href="#update">update()</a></li>
<li><a href="#ask">ask()</a></li>
</ul>
</li>
<li><a href="#overview-2">Overview</a></li>
<li><a href="#building-groovy-for-stardog">Building Groovy for Stardog</a></li>
<li><a href="#examples-5">Examples</a>
<ul class="sectlevel2">
<li><a href="#create-a-connection">Create a Connection</a></li>
<li><a href="#sparql-vars-projected-into-groovy-closures">SPARQL Vars Projected into Groovy Closures</a></li>
<li><a href="#add-remove-triples">Add &amp; Remove Triples</a></li>
<li><a href="#code-withconnection-code-closure"><code>withConnection</code> Closure</a></li>
<li><a href="#sparql-update-support">SPARQL Update Support</a></li>
</ul>
</li>
<li><a href="#introduction-4">Introduction</a></li>
<li><a href="#creating-administering-databases-2">Creating &amp; Administering Databases</a>
<ul class="sectlevel2">
<li><a href="#creating-a-database-3">Creating a Database</a></li>
</ul>
</li>
<li><a href="#connecting-to-a-database">Connecting to a Database</a></li>
<li><a href="#using-the-storage-api">Using the Storage API</a>
<ul class="sectlevel2">
<li><a href="#adding-data-2">Adding Data</a></li>
<li><a href="#modifying-data">Modifying Data</a></li>
<li><a href="#loading-data">Loading Data</a></li>
<li><a href="#removing-data-2">Removing Data</a></li>
</ul>
</li>
<li><a href="#making-sparql-queries">Making SPARQL Queries</a>
<ul class="sectlevel2">
<li><a href="#reasoning-3">Reasoning</a></li>
</ul>
</li>
<li><a href="#making-sparql-updates">Making SPARQL Updates</a>
<ul class="sectlevel2">
<li><a href="#approximating-stardog-updates">Approximating Stardog Updates</a></li>
</ul>
</li>
<li><a href="#dotnetrdf-documentation-h2">dotNetRDF Documentation&lt;/h2&gt;</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#overview-3">Overview</a></li>
<li><a href="#api-overview">API Overview</a></li>
<li><a href="#building-stardog-clj">Building Stardog-clj</a></li>
<li><a href="#examples-6">Examples</a>
<ul class="sectlevel2">
<li><a href="#create-a-connection-and-run-a-query">Create a connection and run a query</a></li>
<li><a href="#insert-data">Insert data</a></li>
<li><a href="#run-a-query-with-a-connection-pool">Run a query with a connection pool</a></li>
<li><a href="#sparql-update-example">SPARQL Update Example</a></li>
<li><a href="#graph-function-for-construct-queries">Graph function for Construct queries</a></li>
<li><a href="#ask-function-for-ask-queries">Ask function for ASK queries</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#snarl-migration-guide">SNARL Migration Guide</a>
<ul class="sectlevel1">
<li><a href="#protocols">Protocols</a></li>
<li><a href="#command-line-2">Command line</a></li>
<li><a href="#code-stardog-code-cli"><code>stardog</code> CLI</a></li>
<li><a href="#code-stardog-admin-code-cli"><code>stardog-admin</code> CLI</a></li>
<li><a href="#sparql-1-1">SPARQL 1.1</a></li>
<li><a href="#deadlocks-and-slowdowns">Deadlocks and Slowdowns</a></li>
<li><a href="#bulk-update-performance">Bulk Update Performance</a></li>
<li><a href="#public-endpoint">Public Endpoint</a></li>
<li><a href="#remote-bulk-loading">Remote Bulk Loading</a></li>
</ul>
</li>
<li><a href="#compatibility-policies">Compatibility Policies</a>
<ul class="sectlevel1">
<li><a href="#expectations">Expectations</a></li>
<li><a href="#data-migration-safety">Data Migration &amp; Safety</a></li>
<li><a href="#code-migration">Code Migration</a></li>
</ul>
</li>
<li><a href="#known-issues-2">Known Issues</a></li>
<li><a href="#terminology-3">Terminology</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>I&#8217;m a Stardog Champion. I&#8217;m a Stardog, that&#8217;s right</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Mother Love Bone
</div>
</div>
</div>
</div>
<h1 id="stardog-manual" class="sect0">Stardog Manual</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Stardog is a graph database—fast, lightweight, pure Java storage for
mission-critical apps—that supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the RDF graph data model</p>
</li>
<li>
<p>SPARQL 1.1 query language</p>
</li>
<li>
<p>HTTP and SNARL protocols for remote access and control</p>
</li>
<li>
<p>OWL 2 and rules for inference and data analytics</p>
</li>
<li>
<p>Java, JavaScript, Ruby, Python, .Net, Groovy, Spring, Clojure etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is Stardog <strong>2.2.3</strong> (25 November 2014—release notes and timeline)
documentation. Check out the <a href="#quick-start-guide">Quick Start Guide</a> to get Stardog installed and
running in five easy steps.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="downloading-stardog">Downloading Stardog</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Download Stardog to get started. The Stardog support forum,
<a href="mailto:stardog@clarkparsia.com">stardog@clarkparsia.com</a>, is the place to report bugs, ask questions, etc. You
can also ask questions on Stack Overflow using the tag stardog.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commercial-licensing-support">Commercial Licensing &amp; Support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For information about Stardog commercial licensing, please
<a href="mailto:sales@clarkparsia.com">email</a> for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing">Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are several open source components of Stardog; feel free to submit pull
requests: Starman, stardog-docs, stardog.js, stardog-groovy, stardog-spring,
stardog.rb, and stardog-clj. Many thanks to everyone who&#8217;s contributed so
far.<span class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</span></p>
</div>
</div>
</div>
<h1 id="quick-start-guide" class="sect0">Quick Start Guide</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Stardog runs on Java 6, Java 7, and is entirely untested on Java 8 (YMMV).
Stardog runs best on, but does not require a 64-bit JVM that supports
<code>sun.misc.Unsafe</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Stardog ships with an <strong>insecure</strong> but usable default setting: the
super user is <code>admin</code> and the <code>admin</code> password is "admin".
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is fine until it isn&#8217;t, at which point you should read the <a href="#security">Security</a> section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="linux-and-osx">Linux and OSX</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, tell Stardog where its home directory (where databases and other files will be stored) is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ export STARDOG_HOME=/data/stardog</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re using some weird Unix shell that doesn&#8217;t create environment variables
in this way, adjust accordingly. <strong>If <code>STARDOG_HOME</code> isn&#8217;t defined, Stardog will
use the Java <code>user.dir</code> property value.</strong></p>
</div>
<div class="paragraph">
<p>Second, copy the <code>stardog-license-key.bin</code> into the right place:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ cp stardog-license-key.bin $STARDOG_HOME</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course <code>stardog-license-key.bin</code> has to be readable by the Stardog process.</p>
</div>
<div class="paragraph">
<p><strong>Stardog won&#8217;t run without a valid <code>stardog-license-key.bin</code> in <code>STARDOG_HOME</code>.</strong></p>
</div>
<div class="paragraph">
<p>Third, start the Stardog server. By default the server will expose SNARL and
HTTP interfaces on port 5820.<span class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./stardog-admin server start</code></pre>
</div>
</div>
<div class="paragraph">
<p>Fourth, create a database with an input file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./stardog-admin db create -n myDB examples/data/University0_0.owl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Fifth, query the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./stardog query myDB &quot;SELECT DISTINCT ?s WHERE { ?s ?p ?o } LIMIT 10&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the Web Console to search or query the new database you created by
visiting <a href="http://localhost:5820/myDB" class="bare">http://localhost:5820/myDB</a> in your browser.</p>
</div>
<div class="paragraph">
<p>Now, go have a drink: you&#8217;ve earned it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="windows">Windows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Windows&#8230;&#8203;really? Okay, but don&#8217;t blame us if this hurts&#8230;&#8203;The following steps
are carried out using the Windows command prompt which you can find under
<span class="menuseq"><span class="menu">Start</span>&#160;&#9656; <span class="submenu">Programs</span>&#160;&#9656; <span class="submenu">Accessories</span>&#160;&#9656; <span class="menuitem">Command Prompts</span></span> or <span class="menuseq"><span class="menu">Start</span>&#160;&#9656; <span class="submenu">Run</span>&#160;&#9656; <span class="menuitem"><code>cmd</code></span></span>.</p>
</div>
<div class="paragraph">
<p>First, tell Stardog where its home directory (where databases and other
files will be stored) is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">&gt; set STARDOG_HOME=C:\data\stardog</code></pre>
</div>
</div>
<div class="paragraph">
<p>Second, copy the <code>stardog-license-key.bin</code> into the right place:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">&gt; COPY /B stardog-license-key.bin %STARDOG_HOME%</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>/B</code> is required to perform a binary copy or the license file may get
corrupted. Of course <code>stardog-license-key.bin</code> has to be readable by the
Stardog process. Finally, Stardog won&#8217;t run without a valid <code>stardog-license-key.bin</code>
in <code>STARDOG_HOME</code>.</p>
</div>
<div class="paragraph">
<p>Third, start the Stardog server. By default the server will expose SNARL and
HTTP interfaces on port 5820.<span class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">&gt; stardog-admin.bat server start</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will start the server in the current command prompt, you should leave this
window open and open a new command prompt window to continue.</p>
</div>
<div class="paragraph">
<p>Fourth, create a database with an input file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">&gt; stardog-admin.bat db create -n myDB examples/data/University0_0.owl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Fifth, query the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">&gt; stardog.bat query myDB &quot;SELECT DISTINCT ?s WHERE { ?s ?p ?o } LIMIT 10&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the Web Console to search or query the new database you created by
hitting <a href="http://localhost:5820/myDB" class="bare">http://localhost:5820/myDB</a> in your
browser.</p>
</div>
<div class="paragraph">
<p>You should drink the whole bottle, brave Windows user!</p>
</div>
</div>
</div>
<h1 id="using-stardog" class="sect0">Using Stardog</h1>
<div class="openblock partintro">
<div class="content">
Stardog is a full-featured RDF database: its primary purpose is to execute
queries against RDF data which it has under direct management.<span class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnote_4" title="View footnote.">4</a>]</span> Stardog supports
<a href="http://www.cambridgesemantics.com/2008/09/sparql-by-example">SPARQL</a>, the W3C
standard for querying RDF graphs.
</div>
</div>
<div class="sect1">
<h2 id="querying">Querying</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog supports SPARQL 1.1 <span class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnote_5" title="View footnote.">5</a>]</span> and also the
<a href="http://www.w3.org/TR/2012/CR-sparql11-entailment-20121108/">OWL 2 Direct
Semantics entailment regime</a>.</p>
</div>
<div class="paragraph">
<p>To execute a SPARQL query against a Stardog database, use the <code>query</code>
subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog query myDb &quot;select * where { ?s ?p ?o }&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Detailed information on using the query command in Stardog can be found
on its [<code>man</code> page](/man/query-execute.html).</p>
</div>
<div class="sect2">
<h3 id="functions">Functions</h3>
<div class="paragraph">
<p>Stardog supports all of the functions in SPARQL, as well as some others from
XPath and SWRL. Any of these functions can be used in queries or rules. Some
functions appear in multiple namespaces, but all of the namespaces will work:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of Stardog Function Namespaces</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Namespace</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stardog</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tag:stardog:api:functions:</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://www.w3.org/2005/xpath-functions#</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://www.w3.org/2005/xpath-functions/math#</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://www.w3.org/2003/11/swrlb#</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>afn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://jena.hpl.hp.com/ARQ/function#</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The function names and URIs supported by Stardog are included below.
Some of these functions exist in SPARQL natively, which just means they can be
used without an explicit namespace.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of Stardog Function Names &amp; URIs</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function name</th>
<th class="tableblock halign-left valign-top">Recognized URI(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>abs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-abs</code><br>
<code>swrlb:abs</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>acos</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:acos</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-add</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:asin</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>atan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:atan</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ceil</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-ceil</code><br>
<code>swrlb:ceiling</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>concat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:concat</code><br>
<code>swrlb:stringConcat</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>contains</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:contains</code><br>
<code>swrlb:contains</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>containsIgnoreCase</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:containsIgnoreCase</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cos</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:cos</code><br>
<code>swrlb:cos</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cosh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stardog:cosh</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:date</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dateTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>day</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:day-from-dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dayTimeDuration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:dayTimeDuration</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divide</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-divide</code><br>
<code>swrlb:divide</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>encode_for_uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:encode_for_uri</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>exp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:exp</code><br>
<code>afn:e</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>floor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-floor</code><br>
<code>swrlb:floor</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hours</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:hours-from-dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>integerDivide</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-integer-divide</code><br>
<code>swlrb:integerDivide</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lcase</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:lower-case</code><br>
<code>swlrb:lowerCase</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:log</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:log10</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:max</code><br>
<code>afn:max</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:min</code><br>
<code>afn:min</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minutes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:minutes-from-dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:mod</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>month</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:month-from-dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>multiply</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-multiply</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>normalizeSpace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:normalize-space</code><br>
<code>swrlb:normalizeSpace</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:pi</code><br>
<code>afn:pi</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:pow</code><br>
<code>swrlb:pow</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>replace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:replace</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>round</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-round</code><br>
<code>swrlb:round</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>roundHalfToEven</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-round-half-to-even</code><br>
<code>swrlb:roundHalfToEven</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>seconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:seconds-from-dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:sin</code><br>
<code>swrlb:sin</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sinh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stardog:sinh</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sqrt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:sqrt</code><br>
<code>afn:sqrt</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>strafter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:substring-after</code><br>
<code>swrlb:substringAfter</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>strbefore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:substring-before</code><br>
<code>swrlb:substringBefore</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>strends</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:ends-with</code><br>
<code>swrlb:endsWith</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stringEqualIgnoreCase</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:stringEqualIgnoreCase</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>strlen</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:string-length</code><br>
<code>swrlb:stringLength</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>strstarts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:starts-with</code><br>
<code>swrlb:startsWith</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>substring</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:substring</code><br>
<code>swrlb:substring</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subtract</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-subtract</code><br>
<code>swrlb:subtract</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>math:tan</code><br>
<code>swrlb:tan</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tanh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stardog:tanh</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timezone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:timezone-from-dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>toDegrees</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stardog:toDegrees</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>toRadians</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stardog:toRadians</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>translate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:translate</code><br>
<code>swrlb:translate</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ucase</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:upper-case</code><br>
<code>swrlb:upperCase</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unaryMinus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-unary-minus</code><br>
<code>swrlb:unaryMinus</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unaryPlus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:numeric-unary-plus</code><br>
<code>swrlb:unaryPlus</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>year</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fn:year-from-dateTime</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yearMonthDuration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>swrlb:yearMonthDuration</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="describe">DESCRIBE</h3>
<div class="paragraph">
<p>SPARQL&#8217;s <code>DESCRIBE</code> keyword is deliberately underspecified;
vendors are free to do, for good or bad, whatever they want.
In Stardog a <code>DESCRIBE &lt;theResource&gt;</code> query retrieves the predicates and
objects for all the triples for which <code>&lt;theResource&gt;</code> is the subject.
There are, of course, about seventeen thousand other ways to implement
<code>DESCRIBE</code>; we&#8217;ve implemented four or five of them and may expose them to
users in a future release of Stardog <em>based on user feedback and requests</em>.</p>
</div>
<div class="paragraph">
<p>Now you know and knowing is one-quarter of the fun.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating">Updating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are many ways to update the data in a Stardog database; the most commonly used methods are the CLI and SPARQL Update queries, both of which we discuss below.</p>
</div>
<div class="sect2">
<h3 id="sparql-update">SPARQL Update</h3>
<div class="paragraph">
<p>SPARQL 1.1 Update can be used to insert RDF into or delete RDF from a Stardog
database using SPARQL query forms <code>INSERT</code> and <code>DELETE</code>, respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="SPARQL"><span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">dc</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://purl.org/dc/elements/1.1/&gt;</span><span class="tok-w"></span>
<span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">ns</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://example.org/ns#&gt;</span><span class="tok-w"></span>
<span class="tok-k">INSERT DATA</span><span class="tok-w"></span>
<span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-k">GRAPH</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://example/bookStore&gt;</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://example/book1&gt;</span><span class="tok-w">  </span><span class="tok-nn">ns</span><span class="tok-p">:</span><span class="tok-nt">price</span><span class="tok-w">  </span><span class="tok-mi">42</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An example of deleting RDF:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="SPARQL"><span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">dc</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://purl.org/dc/elements/1.1/&gt;</span><span class="tok-w"></span>

<span class="tok-k">DELETE DATA</span><span class="tok-w"></span>
<span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-nl">&lt;http://example/book2&gt;</span><span class="tok-w"> </span><span class="tok-nn">dc</span><span class="tok-p">:</span><span class="tok-nt">title</span><span class="tok-w"> </span><span class="tok-s">&quot;David Copperfield&quot;</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">                         </span><span class="tok-nn">dc</span><span class="tok-p">:</span><span class="tok-nt">creator</span><span class="tok-w"> </span><span class="tok-s">&quot;Edmund Wells&quot;</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or they can be combined with <code>WHERE</code> clauses:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="SPARQL"><span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">foaf</span><span class="tok-p">:</span><span class="tok-w">  </span><span class="tok-nl">&lt;http://xmlns.com/foaf/0.1/&gt;</span><span class="tok-w"></span>

<span class="tok-err">WITH</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://example/addresses&gt;</span><span class="tok-w"></span>
<span class="tok-k">DELETE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-nn">foaf</span><span class="tok-p">:</span><span class="tok-nt">givenName</span><span class="tok-w"> </span><span class="tok-s">&#39;Bill&#39;</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-k">INSERT</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-nn">foaf</span><span class="tok-p">:</span><span class="tok-nt">givenName</span><span class="tok-w"> </span><span class="tok-s">&#39;William&#39;</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-k">WHERE</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-nn">foaf</span><span class="tok-p">:</span><span class="tok-nt">givenName</span><span class="tok-w"> </span><span class="tok-s">&#39;Bill&#39;</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-data-with-the-cli">Adding Data with the CLI</h3>
<div class="paragraph">
<p>The most efficient way to load data into Stardog is at database creation
time. See the [Creating a Database](../admin/#create) section for bulk
loading data at database creation time. To add data to an existing
Stardog database, use the [add](/docs/man/data-add.html) command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog data add myDatabase 1.rdf 2.rdf 3.rdf</code></pre>
</div>
</div>
<div class="paragraph">
<p>The optional arguments are <code>-f</code> (or <code>--format</code>) to specify the RDF
serialization type of the files to be loaded; if you specify the wrong
type, <code>add</code> will fail. If you don&#8217;t specify a type, Stardog will try to
determine the type on its own based on the file extension. For example,
the files that have names ending with '.ttl' will be parsed with Turtle
syntax. If you specify a type, then all the files being loaded must of
that same type.</p>
</div>
<div class="paragraph">
<p>If you want to add data to a named graph, specify it via the
<code>--graph-uri</code> or <code>-g</code> options.</p>
</div>
</div>
<div class="sect2">
<h3 id="removing-data-with-the-cli">Removing Data with the CLI</h3>
<div class="paragraph">
<p>To remove data from a Stardog database, <a href="/docs/man/data-remove.html"><code>remove</code></a>
is used by specifying</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>one Named Graph, <em>or</em></p>
</li>
<li>
<p>one or more files containing RDF (in some recognized serialization
format, i.e., RDF/XML, Turtle, Trig), <em>or</em></p>
</li>
<li>
<p>one Named Graph and one or more RDF files.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog data remove -g http://foo myDatabase</code></pre>
</div>
</div>
<div class="paragraph">
<p>will remove the named graph <code>http://foo</code> and all its triples from
<code>myDatabase</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog data remove myDatabase 1.rdf</code></pre>
</div>
</div>
<div class="paragraph">
<p>will remove the triples in <code>1.rdf</code> from (the default graph of)
<code>myDatabase</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog data remove -g http://foo -f TURTLE myDatabase 2.rdf 3.rdf</code></pre>
</div>
</div>
<div class="paragraph">
<p>will remove the triples in the Turtle files <code>2.rdf</code> and <code>3.rdf</code> from the
named graph <code>http://foo</code> of <code>myDatabase</code>.</p>
</div>
<div class="paragraph">
<p>Strict or loose parsing may be set for the input payload by using
<code>--strict-parsing=TRUE|FALSE</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="how-stardog-handles-rdf-parsing">How Stardog Handles RDF Parsing</h3>
<div class="paragraph">
<p>RDF parsing in Stardog is strict: it requires typed RDF literals to
match their explicit datatypes, URIs to be well-formed, etc. In some
cases, strict parsing isn&#8217;t ideal—it may be disabled using the
<code>--strict-parsing=FALSE</code>.</p>
</div>
<div class="paragraph">
<p>However, even with strict parsing disabled, Stardog&#8217;s RDF parser may
encounter parse errors from which it cannot recover. And loading data in
lax mode may lead to unexpected SPARQL query results. For example,
malformed literals (<code>"2.5"^^xsd:int</code>) used in filter evaluation may lead
to undesired results.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="versioning">Versioning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog supports graph change management capability that lets users track changes between
revisions of a Stardog database, add comments and other metadata to the revisions,
extract diffs between those revisions, tag revisions with labels, and query over the revision history of the database using SPARQL.</p>
</div>
<div class="paragraph">
<p>Versioning support for a database is disabled by default but can be enabled at any time by setting the configuration option <code>versioning.enabled</code> to true. For example, you can create a database with versioning support as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db create -o versioning.enabled=true -n myDb</code></pre>
</div>
</div>
<div class="paragraph">
<p>This option can also be set after database creation using the <code>stardog-admin metadata set</code> command.</p>
</div>
<div class="paragraph">
<p>The following examples give a <strong>very brief overview</strong> of this capability;
see the <a href="/manpages/">VCS man pages</a> for all the details.</p>
</div>
<div class="sect2">
<h3 id="committing-changes">Committing Changes</h3>
<div class="paragraph">
<p>Commit a new version by adding and removing triples specified in files.
Different from the <code>data add/remove</code> commands, <code>commit</code> allows one to add and
remove triples in one commit and to associate a commit message.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Removals are performed before additions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To commit changes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog vcs commit --add add_file1.ttl add_file2.ttl --remove remove_file.ttl -m &quot;This is an example commit&quot; myDb</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="viewing-revisions">Viewing Revisions</h3>
<div class="paragraph">
<p>To see all revisions (commits) in a database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog vcs list myDb
$ stardog vcs list --committer userName myDb</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output can be tweaked using <code>--after</code>, <code>--before</code>, and <code>--committer</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="reverting-revisions">Reverting Revisions</h3>
<div class="paragraph">
<p>You can revert specific revisions, ranges, etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog vcs revert myDb
$ stardog vcs revert myDb de44369d-cc7b-4244-a3fb-3f6e271420b0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="viewing-diffs">Viewing Diffs</h3>
<div class="paragraph">
<p>You can also see the differences between revisions; by default, between the
head version and its previous versions or the changes in a specific commit,
respectively:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">----$ stardog vcs diff myDb
$ stardog vcs diff myDb de44369d-cc7b-4244-a3fb-3f6e271420b0
----</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Diffs are represented as SPARQL Update queries so that they may be used as
a kind of graph patch.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-tags">Using Tags</h3>
<div class="paragraph">
<p>You can also create, drop, list tags, i.e., named revisions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog vcs tag --list myDb</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="querying-the-revision-history">Querying the Revision History</h3>
<div class="paragraph">
<p>The revision history of the database is represented as RDF using the W3C PROV
vocabulary and can be queried using SPARQL:<span class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnote_6" title="View footnote.">6</a>]</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog vcs query myDb &#39;SELECT...&#39;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exporting">Exporting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To export data from a Stardog database back to RDF,
<a href="/docs/man/data-export.html"><code>export</code></a> is used by specifying</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the connection string of the database to export</p>
</li>
<li>
<p>the export format: <code>N-TRIPLES, RDF/XML, TURTLE, TRIG</code>. The default is
<code>N-TRIPLES</code>. <code>TRIG</code> must be used when exporting the entire database
if the database contains triples inside named graphs</p>
</li>
<li>
<p>optionally, the URI of the named graph to export if you wish to
export a single named graph only</p>
</li>
<li>
<p>a file to export to</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog data export --format TURTLE myDatabase myDatabase_output.ttl

$ stardog data export --graph-uri http://example.org/context myDatabase myDatabase_output.nt</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="searching">Searching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog includes an RDF-aware semantic search capability: it will index
RDF literals and supports information retrieval-style queries over
indexed data.</p>
</div>
<div class="sect2">
<h3 id="indexing-strategy">Indexing Strategy</h3>
<div class="paragraph">
<p>The indexing strategy creates a "search document" per RDF literal. Each
document consists of the following fields: literal ID; literal value;
and contexts.</p>
</div>
</div>
<div class="sect2">
<h3 id="search-in-sparql">Search in SPARQL</h3>
<div class="paragraph">
<p>We use the predicate <code>http://jena.hpl.hp.com/ARQ/property#textMatch</code> to
access the search index in a SPARQL query.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="SPARQL"><span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-k">DISTINCT</span><span class="tok-w"> </span><span class="tok-nv">?s</span><span class="tok-w"> </span><span class="tok-nv">?score</span><span class="tok-w"></span>
<span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-nv">?s</span><span class="tok-w"> </span><span class="tok-nv">?p</span><span class="tok-w"> </span><span class="tok-nv">?l</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-nv">?l</span><span class="tok-w"> </span><span class="tok-nv">?score</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://jena.hpl.hp.com/ARQ/property#textMatch&gt;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-s">&#39;mac&#39;</span><span class="tok-w"> </span><span class="tok-mf">0.5</span><span class="tok-w"> </span><span class="tok-mi">50</span><span class="tok-w"> </span><span class="tok-p">).</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This query selects the top 50 literals, and their scores, which match
'mac' and whose scores are above a threshold of 0.5. These literals are
then joined with the generic BGP <code>?s ?p ?l</code> to get the resources (?s)
that have those literals. Alternatively, you could use
<code>?s rdf:type ex:Book</code> if you only wanted to select the books which
reference the search criteria; you can include as many other BGPs as
you like to enhance your initial search results.</p>
</div>
</div>
<div class="sect2">
<h3 id="searching-with-the-command-line">Searching with the Command Line</h3>
<div class="paragraph">
<p>First, check out the
<a href="/docs/man/query-search.html"><code>search</code> man page</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog help query search</code></pre>
</div>
</div>
<div class="paragraph">
<p>Okay, now let&#8217;s do a search over the O&#8217;Reilly book catalog in RDF for
everything mentioning "html":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog query search -q &quot;html&quot; -l 10 catalog</code></pre>
</div>
</div>
<div class="paragraph">
<p>The results?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>Index    Score    Hit
====================
0    6.422    urn:x-domain:oreilly.com:product:9780596527402.IP
1    6.422    urn:x-domain:oreilly.com:product:9780596003166.IP
2    6.422    urn:x-domain:oreilly.com:product:9781565924949.IP
3    6.422    urn:x-domain:oreilly.com:product:9780596002251.IP
4    6.422    urn:x-domain:oreilly.com:product:9780596101978.IP
5    6.422    urn:x-domain:oreilly.com:product:9780596154066.IP
6    6.422    urn:x-domain:oreilly.com:product:9780596157616.IP
7    6.422    urn:x-domain:oreilly.com:product:9780596805876.IP
8    6.422    urn:x-domain:oreilly.com:product:9780596527273.IP
9    6.422    urn:x-domain:oreilly.com:product:9780596002961.IP</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="query-syntax">Query Syntax</h3>
<div class="paragraph">
<p>Stardog search is based on Lucene 4.2.0: we support all of the
<a href="http://lucene.apache.org/java/3_4_0/queryparsersyntax.html">search modifiers</a>
that Lucene supports, with the exception of fields.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>wildcards: <code>?</code> and <code>*</code></p>
</li>
<li>
<p>fuzzy: <code>~</code> and <code>~</code> with similarity weights (e.g. <code>foo~0.8</code>)</p>
</li>
<li>
<p>proximities: <code>"semantic web"~5</code></p>
</li>
<li>
<p>term boosting</p>
</li>
<li>
<p>booleans: <code>OR</code>, <code>AND</code>, <code>NOT</code>, +<code>, and `-</code>.</p>
</li>
<li>
<p>grouping</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a more detailed discussion, see the <a href="http://lucene.apache.org/java/3_3_0/queryparsersyntax.html">Lucene docs</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="obfuscating">Obfuscating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When sharing sensitive RDF data with others, you might
want to (selectively) obfuscate it so that sensitive bits are not present,
but non-sensitive bits remain. For example, this feature can be used to
submit Stardog bug reports using sensitive data.</p>
</div>
<div class="paragraph">
<p>Data obfuscation works much the same way as the <code>export</code> command and supports
the same set of arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog data obfuscate myDatabase obfDatabase.ttl</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, all URIs, bnodes, and string literals in the database will be
obfuscated using the SHA256 message digest algorithm. Non-string typed literals
(numbers, dates, etc.) are left unchanged as well as URIs from built-in
namespaces (<code>RDF</code>, <code>RDFS</code>, and <code>OWL</code>). It&#8217;s possible to customize obfuscation by providing a configuration file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog data obfuscate --config obfConfig.ttl myDatabase  obfDatabase.ttl</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration specifies which URIs and strings will be obfuscated by
defining inclusion and exclusion filters. See the example configuration file
provided in the distribution for details.</p>
</div>
<div class="paragraph">
<p>Once the data is obfuscated, queries written against the original data will
no longer work. Stardog provides query obfuscation capability, too, so that
queries can be executed against the obfuscated data. If a custom configuration
file is used to obfuscate the data, then the same configuration should be used
for obfuscating the queries as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog query obfuscate --config obfConfig.ttl myDatabase myQuery.sparql &gt; obfQuery.ttl</code></pre>
</div>
</div>
<hr>
<div class="paragraph">
<p>title: Web Console
shortTitle: Console
layout: default
toc: true
quote: Interfaces keep things tidy, but don&#8217;t accelerate growth: Functions do.
---</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Stardog Web Console is a responsive web app for the Stardog Server and for every Stardog database that makes administration and interaction with data quick and easy; you can access it at <code><a href="http://foo:5820" class="bare">http://foo:5820</a></code> where <code>foo</code> is the name of the machine where Stardog is running.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a-screenshot-tour">A Screenshot Tour&#8230;&#8203;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Seriously, this is a lot more fun if you just [download](<a href="http://stardog.com/" class="bare">http://stardog.com/</a>) the damn thing and hit it with a browser!</p>
</div>
<div class="sect2">
<h3 id="login">Login</h3>
<div class="paragraph">
<p>To login into the Stardog Web Console, provide your username and password. If you&#8217;re an administrative user, you&#8217;ll have all the operations available, otherwise the functionality will be limited by your permissions.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Login](/img/console/screen_login.png)</p>
</div>
</div>
<div class="sect2">
<h3 id="homepage">Homepage</h3>
<div class="paragraph">
<p>![Stardog Web Console - Homepage](/img/console/screen_home.png)</p>
</div>
</div>
<div class="sect2">
<h3 id="databases">Databases</h3>
<div class="paragraph">
<p>![Stardog Web Console - Databases](/img/console/screen_dbs.png)</p>
</div>
<div class="sect3">
<h4 id="view-a-database-settings">View a database settings</h4>
<div class="paragraph">
<p>![Stardog Web Console - DB View](/img/console/screen_db_view.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="database-status">Database Status</h4>
<div class="paragraph">
<p>You can set the database online/offline with the switch included in the top right of the action bar. Setting the switch to <code>on</code> will set the database <code>online</code>, switching it <code>off</code> will set the database <code>offline</code>.</p>
</div>
<div class="paragraph">
<p><em>NOTE</em>: Setting a database offline will result in downtime on all the services provided by the database, e.g. querying, searching, modifying, etc.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="db-actions">DB Actions</h3>
<div class="paragraph">
<p>Within the database view, a bar with actions available on the database is included. Depending on the database status, the actions available are:</p>
</div>
<div class="paragraph">
<p>Status: <em>Online</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Query - Takes you to the Query Panel of the database, letting you query the DB with SPARQL queries</p>
</li>
<li>
<p>Browse - Takes you to the Schema Browser of the database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Status: <em>Offline</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Edit - Will render the database view in edit mode, letting you modify the database settings</p>
</li>
<li>
<p>Migrate - Migrates the existing content of a legacy database to new format</p>
</li>
<li>
<p>Optimize - Optimize an existing database</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="drop-a-database">Drop a database</h4>
<div class="paragraph">
<p>To drop a database click on the <code>Drop</code> button, a confirmation will appear to verify the removal.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Drop a Database](/img/console/screen_delete_confirm.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-new-database">Creating a new database</h4>
<div class="paragraph">
<p>To create a new database click the <code>New DB</code> button in the database listing screen. A wizard will be shown to select and customize the settings of the DB.
All values are optional except the database name, and all of them are pre-filled with the default values. You can finish the wizard to create a DB since the first step, just typing the database name and finish.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - New DB](/img/console/screen_new_db.png)</p>
</div>
<div class="paragraph">
<p>You can go through the wizard with the <code>Next</code> and <code>Back</code> buttons, setting up every section of the database options. Every option contains help as a tooltip that is shown having the cursor over the option label.</p>
</div>
<div class="paragraph">
<p>Once you&#8217;re done setting the database options, at any step of the wizard, just click finish to create the database. You&#8217;ll be redirected to the database view once it has been created in Stardog.</p>
</div>
</div>
<div class="sect3">
<h4 id="browsing-the-database-as-linked-data">Browsing the database as Linked Data</h4>
<div class="paragraph">
<p>You can browse the database as Linked Data graph, too.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Browse](/img/console/screen_instance_browsing.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="browsing-the-schema">Browsing the Schema</h4>
<div class="paragraph">
<p>You can browse the schema (the class and property trees).</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Schema Browsing](/img/console/screen_schema_browsing.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="querying-a-database">Querying a database</h4>
<div class="paragraph">
<p>Stardog Web Console includes a SPARQL query editor for executing queries against the database; the editor includes some canned exploration queries, too.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - SPARQL Query](/img/console/screen_sparql_query.png)</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Exploration Queries](/img/console/screen_exploration_queries.png)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="searching-a-database">Searching a database</h3>
<div class="paragraph">
<p>You can search the contents of the database using Stardog&#8217;s search capability.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Searching](/img/console/screen_semantic_search.png)</p>
</div>
<div class="sect3">
<h4 id="editing-data-in-a-database">Editing data in a database</h4>
<div class="paragraph">
<p>You can edit any statements in the database (with the requisite permissions).</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Editing](/img/console/screen_editing.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="listing-running-queries">Listing running queries</h4>
<div class="paragraph">
<p>To list the current running queries on the system click on <code>Query Management</code> in the top navbar, you&#8217;ll be redirected to an accordion style listing of running queries. This listing is refreshed constantly to reflect the running queries in real time, if you have a query that has been running for a while it will be shown here.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Query List](/img/console/screen_query_list.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="view-a-running-query">View a running query</h4>
<div class="paragraph">
<p>Clicking on the query entry in the listing will show the running query related information, such as the user who posted the query, the database it is running on, the reasoning level used for the query and the related timestamps. The query will be shown at the bottom.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Query Info](/img/console/screen_query_info.png)</p>
</div>
<div class="paragraph">
<p>To kill a running query, click on the query element in the listing to expand it and show its related information, a <code>Kill</code> button will be show, you can click on that button to terminate the query.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="users-roles-permissions">Users, Roles, Permissions</h3>
<div class="sect3">
<h4 id="listing-users">Listing users</h4>
<div class="paragraph">
<p>On the navbar click on <code>Security &gt; Users</code>, a listing of the existent users in the system will be shown.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Admin Console - Users](/img/console/screen_users.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="view-user-permissions-roles">View user permissions &amp; roles</h4>
<div class="paragraph">
<p>The user&#8217;s view lets you administer a user&#8217;s permissions and the roles it has been assigned to. To add permissions to a new resource for the user, click on the <code>Add Permission</code> button and provide the information for the resource, once it has been added to the list, click on the specific allowed actions. To add permissions to a resource already in the permissions table, just click on the permission actions to add/remove.</p>
</div>
<div class="paragraph">
<p>To assign the user to a role, just type the role name in the <code>Add role</code> input and click on <code>Add</code>. The role names will be autocompleted to the ones already existing in the system.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - User View](/img/console/screen_user_view.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="create-a-new-user">Create a new user</h4>
<div class="paragraph">
<p>To create a new user click on the <code>New User</code> button and provide the required information on the new User popup modal. You&#8217;ll be redirected to the user&#8217;s view once it has been created in Stardog.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Admin Console - New User](/img/console/screen_new_user.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="listing-roles">Listing roles</h4>
<div class="paragraph">
<p>On the navbar click on <code>Security &gt; Roles</code>, a listing of the existent roles in the system will be shown.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Roles](/img/console/screen_roles.png)</p>
</div>
</div>
<div class="sect3">
<h4 id="view-role-permissions-users-assigned-to-it">View role permissions &amp; users assigned to it</h4>
<div class="paragraph">
<p>The roles&#8217;s view lets you administer a role&#8217;s permissions and the users it has been assigned to. To add permissions to a new resource for the role, click on the <code>Add Permission</code> button and provide the information for the resource, once it has been added to the list, click on the specific allowed actions. To add permissions to a resource already in the permissions table, just click on the permission actions to add/remove.</p>
</div>
<div class="paragraph">
<p>To assign a user to the role, just type the username in the <code>Add user</code> input and click on <code>Add</code>. The usernames will be autocompleted to the ones already existing in the system.</p>
</div>
<div class="paragraph">
<p>![Stardog Web Console - Role View](/img/console/screen_role_view.png)</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="administration" class="sect0">Administration</h1>
<div class="openblock partintro">
<div class="content">
In this chapter we describe the administration of Stardog Server and
Stardog databases, including the various
command-line programs, configuration options, etc. Security is an
important part of Stardog administration; it&#8217;s
discussed in a separate <a href="/security">chapter</a>.
</div>
</div>
<div class="sect1">
<h2 id="command-line-interface">Command Line Interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog&#8217;s command-line interface (CLI) comes in two parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>stardog-admin</code>: admininstrative client</p>
</li>
<li>
<p><code>stardog</code>: a user&#8217;s client</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The admin and user&#8217;s tools operate on local or remote databases, using
either HTTP or SNARL protocols. Both of these CLI tools are Unix-only,
are self-documenting, and the help output of these tools is their
canonical documentation. In other words, if there is a conflict between this
documentation and the output of the CLI tools' <code>help</code> command, the CLI
tools' output is correct.</p>
</div>
<div class="sect2">
<h3 id="help">Help</h3>
<div class="paragraph">
<p>To use the Stardog CLI tools, you can start by asking them to display
help:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">stardog help</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin help</code></pre>
</div>
</div>
<div class="paragraph">
<p>And for the very laziest among us, these work too:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog
$ stardog-admin</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="security-considerations">Security Considerations</h3>
<div class="paragraph">
<p>We split administrative functionality into two CLI programs
because of security: <code>stardog-admin</code> will need, in
production environments, to have considerably tighter access
restrictions than <code>stardog</code>.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
For usability, Stardog provides a
default user "admin" and password "admin" in <code>stardog-admin</code> commands
if no user or password are given. This is obviously <strong>insecure</strong>;
before any serious use of Stardog is contemplated, read the
<a href="/security">Security</a> chapter at least twice, and
then&#8212;&#8203;minimally&#8212;&#8203;change the administrative password to something we
haven&#8217;t published on the interwebs!
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="command-groups">Command Groups</h3>
<div class="paragraph">
<p>The CLI tools use "command groups" to make CLI subcommands easier to find.
To print help for a particular command group, just ask for help:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog help [command_group_name]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command groups and their subcommands include</p>
</div>
<div class="ulist">
<ul>
<li>
<p>data: add, remove, export;</p>
</li>
<li>
<p>query: search, execute, explain, status;</p>
</li>
<li>
<p>reasoning: explain, consistency; namespace: add, list, remove;</p>
</li>
<li>
<p>server: start, stop;</p>
</li>
<li>
<p>metadata: get, set;</p>
</li>
<li>
<p>user: add, drop, edit, grant, list, permission, revoke, passwd;</p>
</li>
<li>
<p>role: add, drop, grant, list, permission, revoke;</p>
</li>
<li>
<p>db: backup, copy, create, drop, migrate, optimize, list, online, offline, repair, restore, status.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The main help command for either CLI tool will print a listing of the
command groups:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>usage: stardog []

The most commonly used stardog commands are:
    data        Commands which can modify or dump the contents of a database
    help        Display help information
    icv         Commands for working with Stardog Integrity Constraint support
    namespace   Commands which work with the namespaces defined for a database
    query       Commands which query a Stardog database
    reasoning   Commands which use the reasoning capabilities of a Stardog database
    version     Prints information about this version of Stardog

See 'stardog help' for more information on a specific command.</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get more information about a particular command, simply issue the
help command for it including its command group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog help query execute</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, everything here about command groups, commands, and online help
works for <code>stardog-admin</code>, too. The result of all these changes is a
better user experience:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog reasoning consistency -u myUsername -p myPassword -r QL myDB

$ stardog-admin db migrate -u myUsername -p myPassword myDb</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="autocomplete">Autocomplete</h3>
<div class="paragraph">
<p>Stardog also supports CLI autocomplete via <code>bash</code>
autocompletion. To install autocomplete for bash shell, you&#8217;ll
first want to make sure bash completion is installed:</p>
</div>
<div class="sect3">
<h4 id="homebrew">Homebrew</h4>
<div class="paragraph">
<p>To install:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ brew install bash-completion</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable, edit <code>`.bash\_profile</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">if [ -f `brew --prefix`/etc/bash_completion ]; then
  . `brew --prefix`/etc/bash_completion
fi</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="macports">MacPorts</h4>
<div class="paragraph">
<p>First, you really should be using Homebrew&#8230;&#8203;ya heard?</p>
</div>
<div class="paragraph">
<p>If not, then:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ sudo port install bash-completion</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, edit <code>.bash\_profile</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">if [ -f /opt/local/etc/bash_completion ]; then
   . /opt/local/etc/bash_completion
fi</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ubuntu">Ubuntu</h4>
<div class="paragraph">
<p>And for our Linux friends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ sudo apt-get install bash-completion</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="fedora">Fedora</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ sudo yum install bash-completion</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="all-platforms">All Platforms</h4>
<div class="paragraph">
<p>Now put the Stardog autocomplete script—<code>stardog-completion.sh</code>—into yr
<code>bash\_completion.d</code> directory, typically one of
<code>/etc/bash_completion.d, /usr/local/etc/bash_completion.d or ~/bash_completion.d.</code></p>
</div>
<div class="paragraph">
<p>Alternately you can put it anywhere you want, but tell <code>.bash_profile</code>
about it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">source ~/.stardog-completion.sh</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="how-to-make-a-connection-string">How to Make a Connection String</h3>
<div class="paragraph">
<p>You need to make a connection string to talk to a Stardog database.</p>
</div>
<div class="paragraph">
<p>A connection string may consist solely of the <strong>database name</strong> in cases
where</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stardog is listening on the standard port(s);</p>
</li>
<li>
<p>SNARL is enabled; and</p>
</li>
<li>
<p>the command is invoked on the same machine where the server is running.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In other cases, a "fully qualified" connection string, as described below, is required.</p>
</div>
<div class="paragraph">
<p>Further, the connection string is now assumed to be the first argument of any
command that requires a connection string. Some CLI subcommands require a
Stardog connection string as an argument to identify the server and database
upon which operations are to be performed.</p>
</div>
<div class="paragraph">
<p>Connection strings are URLs and may either be local to the
machine where the CLI is run or they may be on some other remote
machine.</p>
</div>
<div class="paragraph">
<p>There are two URL schemes recognized by Stardog:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>http://</code></p>
</li>
<li>
<p><code>snarl://</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The former uses Stardog&#8217;s (extended) version of SPARQL
Protocol; the latter uses Stardog&#8217;s native data access protocol, called
SNARL.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>stardog-admin</code> and <code>stardog</code> works with HTTP or
SNARL Protocol, interchangeably. SNARL is faster than HTTP in cases where
payloads to and from the server are relatively <strong>small</strong>; for payloads
that are large, raw transfer time dominates and there isn&#8217;t much or any
difference in performance between them.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="example-connection-strings">Example Connection Strings</h3>
<div class="paragraph">
<p>To make a connection string, you need to know the URL scheme; the
machine name and port Stardog Server is running on; any (optional)
URL path to the database;<span class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnote_7" title="View footnote.">7</a>]</span> and the
name of the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>{scheme}{machineName}:{port}/{databaseName};{connectionOptions}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>snarl://server/billion-triples-punk
http://localhost:5000/myDatabase
http://169.175.100.5:1111/myOtherDatabase;reasoning=QL
snarl://stardog:8888/the_database
snarl://localhost:1024/db1;reasoning=NONE</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the default ports for SNARL and HTTP protocols simplifies
connection strings. <code>connectionOptions</code> are a series of <code>;</code> delimited
key-value pairs which themselves are <code>=</code> delimited. Key names must be
<strong>lowercase</strong> and their values are case-sensitive. Finally, in the case where
the scheme is SNARL, the machine is "localhost", and the port is the default
SNARL port, a connection string may consist of the "databaseName" only.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="server-admin">Server Admin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog Server is multi-protocol, supporting SNARL and HTTP. The default port
for SNARL is <strong>5820</strong>; the default port for HTTP is <strong>5822</strong>.</p>
</div>
<div class="paragraph">
<p><strong>All administrative functions work over SNARL or HTTP protocols.</strong></p>
</div>
<div class="sect2">
<h3 id="http-snarl-server-unification">HTTP &amp; SNARL Server Unification</h3>
<div class="paragraph">
<p>To use any of these commands against a remote server, pass a global
<code>--server</code> argument with an HTTP or SNARL URL.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are running <code>stardog-admin</code> on the same machine where
Stardog Server is running, and you&#8217;re using the default protocol ports,
then you can omit the <code>--server</code> argument and simply pass a database
name via <code>-n</code> option. Most of the following commands assume this case
for the sake of exposition.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="server-security">Server Security</h3>
<div class="paragraph">
<p>See the <a href="/security">Security chapter</a> for information about Stardog&#8217;s
security system, secure deployment patterns, and more.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-stardog-server">Configuring Stardog Server</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The properties described in this section control the behavior
of the Stardog Server (whether HTTP or SNARL protocols are in use); to
set properties or other metadata on individual Stardog <strong>databases</strong>, see
<a href="#admin-database">Administering a Database</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Stardog Server&#8217;s behavior can be configured via the JVM arg
<code>stardog.home</code>, which sets Stardog Home, overriding the value of
<code>STARDOG_HOME</code> set as an environment variable. Stardog Server&#8217;s behavior
can also be configured via a <code>stardog.properties</code>—which is a Java
Properties file—file in <code>STARDOG_HOME</code>. To change the behavior of a
running Stardog Server, it is necessary to restart it.</p>
</div>
<div class="paragraph">
<p>The following twiddly knobs for Stardog Server are available in
<code>stardog.properties</code>:<span class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnote_8" title="View footnote.">8</a>]</span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>strict.parsing</code>: Controls whether Stardog parses RDF strictly
(<code>true</code>, the default) or loosely (<code>false</code>)</p>
</li>
<li>
<p><code>query.all.graphs</code>: Controls what data Stardog Server evaluates queries against; if
<code>true</code>, it will query over the default graph and the union of all
named graphs; if <code>false</code> (the default), it will query only over the
default graph.</p>
</li>
<li>
<p><code>query.timeout</code>: Sets the upper bound for query execution time
that&#8217;s inherited by all databases unless explicitly overriden. See
<a href="#manage-queries">Query Management</a> section below for details.</p>
</li>
<li>
<p><code>logging.[access,audit].[enabled,type,file]</code>: Controls whether and
how Stardog logs server events; described in detail below.</p>
</li>
<li>
<p><code>logging.slow_query.enabled</code>, <code>logging.slow_query.time</code>, <code>logging.slow_query.type</code>:
The three slow query logging options are
used in the following way. To enable logging of slow queries, set
<code>enabled</code> to <code>true</code>. To define what counts as a "slow" query, set
<code>time</code> to a time duration value (positive integer plus "h", "m",
"s", or "ms" for hours, minutes, seconds, or milliseconds
respectively). To determine the type of logging, set <code>type</code> to
<code>text</code> (the default) or <code>binary</code>. <strong>To state the obvious explicitly,
a <code>logging.slow_query.time</code> that exceeds the value of
<code>query.timeout</code> will result in null logs.</strong></p>
</li>
<li>
<p><code>database.connection.timeout.ms</code>: Controls how long, in
milliseconds, connections may idle before being automatically closed
by the server.</p>
</li>
<li>
<p><code>http.max.connections</code>: The next two parameters control the maximum
number of simultaneous connections that the Stardog client will use; for more
information, see the <a href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html">relevant Apache
docs</a>.</p>
</li>
<li>
<p><code>http.max.get.query.length</code>: The length in characters of the longest
SPARQL query that will be serialized via HTTP <code>GET</code>; queries longer
are serialized via <code>POST</code>.</p>
</li>
<li>
<p><code>bnode.preserve.id</code>: Determines how the Stardog parser handles bnode
identifiers that may be present in (some) RDF input. If this
property is enabled (i.e., <code>TRUE</code>), parsing and data loading
performance are improved; but the other effect is that if distinct
input files use (randomly or intentionally) the same bnode
identifier, that bnode will point to one and the same node in the
database. If you have input files that use explicit bnode
identifiers, and multiple files may use the asame bnode idenitifers,
and you don&#8217;t want those bnodes to be smushed into a single node in
the database, then this configuration option should be disabled (set
to <code>FALSE</code>).</p>
</li>
<li>
<p><code>load.parser.count</code>, <code>load.processor.count</code>: Determines the number of parser and
processor threads, respectively, to be used during bulk loading
of data at database creation time. The default values are <code>3</code>
and <code>4</code> respectively, but they may be set higher, to good effect,
if you have multi-core CPUs. The former is effective only if multiple
input files are being processed; the latter is effective even
if a single file is processed as input. The heuristic for these settings is</p>
<div class="ulist">
<ul>
<li>
<p>the value of <code>load.parser.count</code> + <code>load.processor.count</code> should neither exceed <code>20</code> nor be equal to or greater than the number of available cores</p>
</li>
<li>
<p>the two values should be roughly equal</p>
</li>
<li>
<p>the values don&#8217;t have much effect unless or until you&#8217;re loading billions of triples</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>password.length.min</code>: Sets the password policy for the minimum length of
user passwords, the value can&#8217;t be lower than <code>password.length.min</code> or greater
than <code>password.length.max</code>. Default: <code>4</code>.</p>
</li>
<li>
<p><code>password.length.max</code>: Sets the password policy for the maximum length of
user passwords. Default: <code>1024</code>.</p>
</li>
<li>
<p><code>password.regex</code>: Sets the password policy of accepted chars in user passwords, via a
Java regular expression. Default: <code>[\\w@#$%]+</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="starting-stopping-the-server">Starting &amp; Stopping the Server</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Unlike the other <code>stardog-admin</code> subcommands, starting the
server may only be run locally, i.e., on the same machine
the Stardog Server is will run on.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The simplest way to start the server—running on the default port,
detaching to run as a daemon, and writing <code>stardog.log</code> to the current
working directory— is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin server start</code></pre>
</div>
</div>
<div class="paragraph">
<p>To specify parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin server start --logfile mystardog.log --port=8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The port can be specified using the property <code>--port</code>.
The HTTP interface can be disabled by using the flag
<code>--no-http</code> and the SNARL interface via <code>--no-snarl</code>.</p>
</div>
<div class="paragraph">
<p>To shut the server down:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin server stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you started Stardog on a port other than the default, or want to shut
down a remote server, you can simply use the <code>--server</code> option to
specify the location of the server to shutdown.</p>
</div>
<div class="paragraph">
<p>By default Stardog will bind it&#8217;s server to <code>0.0.0.0</code>.  You can specify a different
network interface for Stardog to bind to using the <code>--bind</code> property
of <code>server start</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="server-monitoring-with-watchdog-jmx">Server Monitoring with Watchdog &amp; JMX</h3>
<div class="paragraph">
<p>Stardog&#8217;s JMX implementation is called Watchdog.  In addition to providing
some basic JVM information, Watchdog also exports information about the Stardog
DBMS configuration as well as stats for all of the databases within the system,
such as the total number of open connections, size, and average query time.</p>
</div>
<div class="sect3">
<h4 id="accessing-watchdog">Accessing Watchdog</h4>
<div class="paragraph">
<p>To access Watchdog, you can simply use a tool like VisualVM or JConsole
to attach to the process running the JVM, or connect directly to the JMX server.
You can also access information from Watchdog in the web console for the database,
or by performing a <code>GET</code> on <code>/{db}/watchdog</code> which will return a simple JSON object
containing the information available via JMX.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuring-watchdog">Configuring Watchdog</h4>
<div class="paragraph">
<p>By default, Watchdog will bind an RMI server for remote access on port <code>5833</code>.  If you
want to change which port Watchdog binds the remote server to, you can set the property
<code>watchdog.port</code> via <code>stardog.properties</code>.  If you wish
to disable remote access to JMX, you can set <code>watchdog.remote.access</code> to <code>false</code>
in <code>stardog.properties</code>.  Finally, if you wish to disable Watchdog completely,
set <code>watchdog.enabled</code> to <code>false</code> in <code>stardog.properties</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="locking-stardog-home">Locking Stardog Home</h3>
<div class="paragraph">
<p>Stardog Server will lock <code>STARDOG_HOME</code> when it starts to prevent
synchronization errors and other nasties if you start more than one
Stardog Server with the same <code>STARDOG_HOME</code>. If you need to run more
than one Stardog Server instance, choose a different <code>STARDOG_HOME</code> or
pass a different value to <code>--home</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="access-audit-logging">Access &amp; Audit Logging</h3>
<div class="paragraph">
<p>See the <code>stardog.properties</code> file (in the distribution) for a complete
discussion of how access and audit logging work in Stardog Server.
Basically, audit logging is a
superset of the events in access logging. Access logging covers the most
often required logging events; you should consider enabling audit
logging if you really need to log <strong>every</strong> server event. Logging
generally doesn&#8217;t have much impact on
performance; but the safest way to insure that impact is negligible is to log to
a separate disk (or to a centralized logging server, etc.).</p>
</div>
<div class="paragraph">
<p>The important configuration choices are whether logs should be binary or
plain text (both based on ProtocolBuffer message formats); the type of
logging (audit or access); the logging location (which may be "off disk"
or even "off machine") Logging to a centralized logging facility
requires a Java plugin that implements the Stardog Server logging
interface; see the [Java Chapter](/java/) for more information; and
the log rotation policy (file size or time).</p>
</div>
<div class="paragraph">
<p>Slow query logging is also available. See the <a href="#managing-queries">Managing Queries</a>
section below.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="database-admin">Database Admin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog is a multi-tenancy system and will happily provide access to
multiple, distinct databases.</p>
</div>
<div class="sect2">
<h3 id="configuring-a-database">Configuring a Database</h3>
<div class="paragraph">
<p>To administer a Stardog database, some config options must be set at
creation time; others may be changed subsequently and some may never be
changed. All of the config options have sensible defaults (except,
obviously, for the database name), so you don&#8217;t have to twiddle any of the
knobs till you really need to.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuration-options">Configuration Options</h3>
<div class="paragraph">
<p>The following are the legal configuration options for a Stardog database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>database.name</code>: A legal database name.</p>
</li>
<li>
<p><code>database.online</code>: The status of the database: online or offline. It may be set so that the database is created initially in online or offline status; subsequently, it can&#8217;t be set directly but only by using the relevant admin commands.</p>
</li>
<li>
<p><code>icv.active.graphs</code>: Specifies which part of the database, in terms of named graphs, is checked with IC validation. Set to <code>tag:stardog:api:context:all</code> to validate all the named graphs in the database.</p>
</li>
<li>
<p><code>icv.enabled</code>: Determines whether ICV is active for the database; if true, all database mutations are subject to IC validation (i.e., "guard mode").</p>
</li>
<li>
<p><code>icv.reasoning-type</code>: Determines what kind of reasoning is used during IC validation.</p>
</li>
<li>
<p><code>index.differential.enable.limit</code>: Sets the minimum size of the Stardog database before differential indexes are used.</p>
</li>
<li>
<p><code>index.differential.merge.limit</code>: Sets the size in number of RDF triples before the differential indexes are merged to the main indexes.</p>
</li>
<li>
<p><code>index.literals.canonical</code>: Enables RDF literal canonicalization.
See <a href="../java/snarl/com/clarkparsia/stardog/index/IndexOptions.html#CANONICAL_LITERALS">literal canonicalization</a>
for details.</p>
</li>
<li>
<p><code>index.named.graphs</code>: Enables optimized index support for named graphs; speeds SPARQL query evaluation with named graphs at the cost of some overhead for database loading and index maintenance.</p>
</li>
<li>
<p><code>index.persist</code>: Enables persistent indexes.</p>
</li>
<li>
<p><code>index.persist.sync</code>: Enables whether memory indexes are synchronously or asynchronously persisted to disk with respect to a transaction.</p>
</li>
<li>
<p><code>index.statistics.update.automatic</code>: Sets whether statistics are maintained automatically.</p>
</li>
<li>
<p><code>index.type</code>: Sets the index type (memory or disk).</p>
</li>
<li>
<p><code>reasoning.consistency.automatic</code>: Enables automatic consistency checking with respect to a transaction.</p>
</li>
<li>
<p><code>reasoning.punning.enabled</code>: Enables punning.</p>
</li>
<li>
<p><code>reasoning.schema.graphs</code>: Determines which, if any, named graph or graphs contains the "tbox", i.e., the schema part of the data.</p>
</li>
<li>
<p><code>search.enabled</code>: Enables semantic search on the database.</p>
</li>
<li>
<p><code>search.reindex.mode</code>: Sets how search indexes are maintained.</p>
</li>
<li>
<p><code>transactions.durable</code>: Enables durable transactions.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="a-note-about-database-status">A Note About Database Status</h4>
<div class="paragraph">
<p>A database must be set to <code>offline</code> status before most configuration
parameters may be changed. Hence, the normal routine is to set the database
offline, change the parameters, and then set the database to online. All
of these operations may be done programmatically from CLI tools, such
that they can be scripted in advance to minimize downtime. In a future
version, we will allow some properties to be set while the database
remains online.</p>
</div>
</div>
<div class="sect3">
<h4 id="summary-of-configuration-options">Summary of Configuration Options</h4>
<div class="paragraph">
<p>The following table summarizes the options:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of Configuration Options</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Mutable</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">API</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database.archetypes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#ARCHETYPES">DatabaseOptions.ARCHETYPES</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#NAME">DatabaseOptions.NAME</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database.namespaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rdf, rdfs, xsd, owl, stardog</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#NAMESPACES">DatabaseOptions.NAMESPACES</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>database.online</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#ONLINE">DatabaseOptions.ONLINE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>icv.active.graphs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#ICV_ACTIVE_GRAPHS">DatabaseOptions.ICV_ACTIVE_GRAPHS</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">icv.consistency.automatic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#ICV_CONSISTENCY_AUTOMATIC">DatabaseOptions.ICV_CONSISTENCY_AUTOMATIC</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>icv.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#ICV_ENABLED">DatabaseOptions.ICV_ENABLED</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>icv.reasoning.type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NONE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#ICV_REASONING_TYPE">DatabaseOptions.ICV_REASONING_TYPE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.connection.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3,600,000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#INDEX_CONNECTION_TIMEOUT_MS">IndexOptions.INDEX_CONNECTION_TIMEOUT_MS</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.differential.enable.limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1,000,000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#DIFF_INDEX_MIN_LIMIT">IndexOptions.DIFF_INDEX_MIN_LIMIT</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.differential.merge.limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10,000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#DIFF_INDEX_MAX_LIMIT">IndexOptions.DIFF_INDEX_MAX_LIMIT</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.literals.canonical</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#CANONICAL_LITERALS">IndexOptions.CANONICAL_LITERALS</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.named.graphs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#INDEX_NAMED_GRAPHS">IndexOptions.INDEX_NAMED_GRAPHS</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.persist</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#PERSIST">IndexOptions.PERSIST</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.persist.sync</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#SYNC">IndexOptions.SYNC</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.statistics.update.automatic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#AUTO_STATS_UPDATE">IndexOptions.AUTO_STATS_UPDATE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index.type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disk</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/index/IndexOptions.html#INDEX_TYPE">IndexOptions.INDEX_TYPE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>query.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#QUERY_TIMEOUT">DatabaseOptions.QUERY_TIMEOUT</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reasoning.consistency.automatic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#CONSISTENCY_AUTOMATIC">DatabaseOptions.CONSISTENCY_AUTOMATIC</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reasoning.punning.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#PUNNING_ENABLED">DatabaseOptions.PUNNING_ENABLED</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reasoning.schema.graphs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#SCHEMA_GRAPHS">DatabaseOptions.SCHEMA_GRAPHS</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>search.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#SEARCHABLE">DatabaseOptions.SEARCHABLE</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>transactions.durable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="/java/snarl/com/complexible/stardog/db/DatabaseOptions.html#TRANSACTIONS_DURABLE">DatabaseOptions.TRANSACTIONS_DURABLE</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="legal-values-of-configuration-options">Legal Values of Configuration Options</h4>
<div class="paragraph">
<p>The following options take a boolean value:
<code>database.online, icv.enabled, index.literals.canonical, index.named.graphs, index.persist, index.sync, index.statistics.update.automatic, reasoning.consistency.automatic, reasoning.punning.enabled, search.enabled, transactions.durable</code>.</p>
</div>
<div class="paragraph">
<p>The legal value of <code>database.name</code> is given by the regular expression
<code>[A-Za-z]{1}[A-Za-z0-9_-]</code>.</p>
</div>
<div class="paragraph">
<p>The legal value of <code>icv.active.graphs</code> is a comma-separated list of named graph
identifiers. See <code>reasoning.schema.graphs</code> below for syntactic sugar
URIs for default graph and all named graphs.</p>
</div>
<div class="paragraph">
<p>The legal value of <code>icv.reasoning.type</code> is one of the reasoning levels
(i.e, one of the following strings): <code>NONE, RDFS, QL, RL, EL, DL</code>.</p>
</div>
<div class="paragraph">
<p>The legal value of <code>index.differential.*</code> is an integer.</p>
</div>
<div class="paragraph">
<p>The legal value of <code>index.type</code> is the string "disk" or "memory"
(case-insensitive).</p>
</div>
<div class="paragraph">
<p>The legal value of <code>reasoning.schema.graphs</code> is a comma-separated list of named graph
identifiers, including (optionally) the special names,
<code>tag:stardog:api:context:default</code> and <code>tag:stardog:api:context:all</code>,
which represent the default graph and the union of all named graphs and
the default graph, respectively. In the context of database
configurations only, Stardog will recognize <code>default</code> and <code>*</code> as shorter
forms of those URIs, respectively.</p>
</div>
<div class="paragraph">
<p>The legal value of <code>search.reindex.mode</code> is one of the strings <code>sync</code> or
<code>async</code> (case insensitive) or a legal [Quartz cron
expression](<a href="http://www.quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/crontrigger" class="bare">http://www.quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/crontrigger</a>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="managing-database-status">Managing Database Status</h3>
<div class="paragraph">
<p>Databases are either online or offline; this allows database maintenance
to be decoupled from server maintenance.</p>
</div>
<div class="sect3">
<h4 id="online-and-offline">Online and Offline</h4>
<div class="paragraph">
<p>Databases are put online or offline synchronously: these operations
block until other database activity is completed or terminated. See
<code>stardog-admin help db</code> for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="examples">Examples</h4>
<div class="paragraph">
<p>To set a database from offline to online:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db offline myDatabase</code></pre>
</div>
</div>
<div class="paragraph">
<p>To set the database online:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db online myDatabase</code></pre>
</div>
</div>
<div class="paragraph">
<p>If Stardog Server is shutdown while a database is offline, the database
will be offline when the server restarts.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-database">Creating a Database</h3>
<div class="paragraph">
<p>Stardog databases may be created locally or remotely; but, of course,
performance is better if data files don&#8217;t have to be transferred over a
network during creation and initial loading. See the section below about
loading compressed data. All data files, indexes, and server metadata
for the new database will be stored in Stardog Home. Stardog won&#8217;t
create a database with the same name as an existing database. Stardog
database names must conform to the regular expression,
<code>[A-Za-z]{1}[A-Za-z0-9_-]</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There are four reserved words that may not be used for the
names of Stardog databases: <code>system</code>, <code>admin</code>, <code>watchdog</code>, and <code>docs</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Minimally, the only thing you must know to create a Stardog database is
a database <strong>name</strong>; alternately, you may customize some other database
parameters and options depending on anticipated workloads, data
modeling, and other factors.</p>
</div>
<div class="paragraph">
<p>See <code>stardog-admin help db create</code> for all the details including
examples.</p>
</div>
</div>
<div class="sect2">
<h3 id="database-archetypes">Database Archetypes</h3>
<div class="paragraph">
<p>Stardog database archetypes are a new feature in 2.0. A database archetype is a
named, vendor-defined or user-defined bundle of data and functionality to be
applied at database-creation time. Archetypes are primarily for supporting
various data standards or toolchain configurations in a simple way.</p>
</div>
<div class="paragraph">
<p>For example, the SKOS standard from W3C defines an OWL vocabulary for building
taxonomies, thesauruses, etc. SKOS is made up by a vocabulary, some constraints,
some kinds of reasoning, and (typically) some SPARQL queries. If you are
developing an app that uses SKOS, without Stardog&#8217;s SKOS archetype, you
are responsible for assembling all that SKOS stuff yourself. Which is tedious,
error-prone, and not very rewarding&#8212;&#8203;even when it&#8217;s done right the first time.</p>
</div>
<div class="paragraph">
<p>Rather than putting that burden on Stardog users, we&#8217;ve created database
archetypes as a mechanism to collect these "bundles of stuff" which, as a
developer, you can then simply attach to a particular database.</p>
</div>
<div class="paragraph">
<p>The last point to make is that archetypes are composable: you can mix-and-match
them at database creation time as needed.</p>
</div>
<div class="paragraph">
<p>Stardog supports two database archetypes out-of-the-box:
<a href="http://www.w3.org/TR/prov-overview/">PROV</a> and
<a href="http://www.w3.org/2004/02/skos/">SKOS</a>.</p>
</div>
<div class="sect3">
<h4 id="skos-archetype">SKOS Archetype</h4>
<div class="paragraph">
<p>The SKOS archetype is for databases that will contain SKOS data, and includes
the SKOS schema, SKOS constraints using Stardog&#8217;s Integrity Constraint
Validation, and some namespace-prefix bindings.</p>
</div>
</div>
<div class="sect3">
<h4 id="prov-archetype">PROV Archetype</h4>
<div class="paragraph">
<p>The PROV archetype is for databases that will contain PROV data, and includes
the SKOS schema, SKOS constraints using Stardog&#8217;s Integrity Constraint
Validation, and some namespace-prefix bindings.</p>
</div>
<div class="paragraph">
<p>Archetypes are composable, so you can use more of them and they are
intended to be used alongside <strong>your domain data</strong>, which may include as many
other schemas, ontologies, etc. as are required.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="database-creation-templates">Database Creation Templates</h3>
<div class="paragraph">
<p>As a boon to the overworked admin or devops peeps, Stardog Server supports
database creation templates: you can pass a Java Properties file with config
values set and with the values (typically just the database name) that are
unique to a specific database passed in CLI parameters.</p>
</div>
<div class="sect3">
<h4 id="examples-2">Examples</h4>
<div class="paragraph">
<p>To create a new database with the default options by simply providing a
name and a set of initial datasets to load:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db create -n myDb input.ttl another_file.rdf moredata.rdf.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Datasets can be loaded later as well. To create (in this case, an empty)
database from a template file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db create -c database.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>At a minimum, the configuration file must have a value for
<code>database.name</code> option.</p>
</div>
<div class="paragraph">
<p>If you only want to change only a few configuration options you
can directly provide the values for these options in the CLI args as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db create -n db -o icv.enabled=true icv.reasoning.type=QL -- input.ttl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that &#8220;--&#8221; is used in this case when &#8220;-o&#8221; is the last option to
delimit the value for &#8220;-o&#8221; from the files to be bulk loaded.</p>
</div>
<div class="paragraph">
<p>Please refer to the CLI help for more details of the <code>db create</code>
command.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="database-create-options">Database Create Options</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of Options for Stardog&#8217;s <code>create</code> command</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Arg values</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--durable</code>, <code>-d</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If present, sets all mutation operations to database as transactionally
durable; durability increases the cost of all mutation operations.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--type</code>, <code>-t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the kind of database indexes: memory or disk</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M</code>, <code>D</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">disk</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--searchable</code>, <code>-s</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether the database is searchable</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--index-triples-only</code>, <code>-i</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies that the database&#8217;s indexes should be optimized for RDF triples only</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="repairing-a-database">Repairing a Database</h3>
<div class="paragraph">
<p>If an I/O error or an index exception occurs while querying a DB, the DB might
be corrupted and repaired with the repair command. If the errors occur during
executing admin commands, then the system DB might have been corrupted. System
database corruptions can also cause other problems including authorization
errors.</p>
</div>
<div class="paragraph">
<p>This command needs exclusive access to your Stardog home directory and therefore
requires the Stardog Server not to be running.  This also means that the command
can only be run on the machine where the Stardog home directory is located,
and you will not be able to start the Stardog Server while this command is
running.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The repair process can take considerable time for
large databases.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the built-in Stardog system database is corrupted, then you
can use the database name <code>system</code> as the repair argument.
To repair the database myDB:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db repair myDB</code></pre>
</div>
</div>
<div class="paragraph">
<p>To repair the system database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db repair system</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="backing-up-and-restoring">Backing Up and Restoring</h3>
<div class="paragraph">
<p>Stardog includes both physical and logical backup utilities; logical backups are
accomplished using the <code>export</code> CLI command. Physical backups and restores are
accomplished using <code>stardog-admin db backup</code> and <code>stardog-admin db restore</code> commands,
respectively.</p>
</div>
<div class="paragraph">
<p>These tools perform physical backups, including database metadata,
rather than logical backups via some RDF serialization. They are <strong>native</strong>
Stardog backups and can only be restored with Stardog tools. Backup may be
accomplished while a database is online; backup is performed in a read
transaction: reads and writes may continue, but writes performed during the
backup are not reflected in the backup.</p>
</div>
<div class="paragraph">
<p>See the man pages for <a href="/man/db-backup.html"><code>backup</code></a> and
<a href="/man/db-restore.html"><code>restore</code></a> for details.</p>
</div>
<div class="sect3">
<h4 id="backup">Backup</h4>
<div class="paragraph">
<p><code>stardog-admin db backup</code> assumes a default location for its output, namely,
<code>$STARDOG_HOME/.backup</code>; that default may be overriden by passing
a <code>-t</code> or <code>--to</code> argument. Backup sets are stored in the backup directory by
database name and then in data-versioned subdirectories for each backup volume.
Of course you can use a variety of OS-specific options to accomplish remote
backups over some network or data protocol; those options are left as an
exercise for the admin.</p>
</div>
<div class="paragraph">
<p>To backup a Stardog database called <code>foobar</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db backup foobar</code></pre>
</div>
</div>
<div class="paragraph">
<p>To perform a remote backup, for example, pass in a specific directory that
may be mounted in the current OS namespace via some network protocol, thus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db backup --to /my/network/share/stardog-backups foobar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Stardog&#8217;s backup/restore approach is optimized for minimizing the amount
of time it takes to backup a database; the tradeoff is with restore performance.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="restore">Restore</h4>
<div class="paragraph">
<p>To restore a Stardog database from a Stardog backup volume, simply pass a
fully-qualfied path to the volume in question. The location of the backup should
be the full path to the backup, not the location of the backup directory as
specified in your Stardog configuration. There is no need to specify the name of
the database to restore.</p>
</div>
<div class="paragraph">
<p>To restore a database from its backup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db restore $STARDOG_HOME/.backups/myDb/2012-06-21</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="one-time-database-migrations-for-backup">One-time Database Migrations for Backup</h5>
<div class="paragraph">
<p>The backup system cannot directly backup
databases created in versions before 2.1. These databases must be explicitly
migrated in order to use the new backup system; this is a one-time operation per
database and is accomplished by running</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db migrate foobar</code></pre>
</div>
</div>
<div class="paragraph">
<p>in order to migrate a database called <code>foobar</code>. Again, this is a one-time
operation only and all databases created with 2.1 (or later) do not require
it.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="namespace-prefix-bindings">Namespace Prefix Bindings</h3>
<div class="paragraph">
<p>SPARQL queries can be verbose; but at least the  <code>PREFIX</code> declarations in the
prologue of each query are easy to screw up!  Stardog allows database
administrators to persist and manage custom namespace prefix bindings:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>At database creation time, if data is loaded to the database that
contains namespace prefixes, then those are persisted for the life
of the database. Any subsequent queries to the database may simply
omit the <code>PREFIX</code> declarations:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog query myDB &quot;select * {?s rdf:type owl:Class}&quot;</code></pre>
</div>
</div>
</li>
<li>
<p>To add new bindings, use the <code>namespace</code> subcommand in the CLI:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog namespace add myDb --prefix ex --uri &#39;http://example.org/test#&#39;</code></pre>
</div>
</div>
</li>
<li>
<p>To modify an existing binding, delete the existing one and then add
a new one:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog namespace remove myDb --prefix ex</code></pre>
</div>
</div>
</li>
<li>
<p>Finally, to see all of the existing namespace prefix bindings:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog namespace list myDB</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If no files are used during database creation, or if the files do not
define any prefixes (e.g. NTriples), then the "Big Four" default
prefixes are stored: <code>RDF, RDFS, XSD</code>, and <code>OWL</code>.</p>
</div>
<div class="paragraph">
<p>When executing queries in the CLI, the default table format for SPARQL
<code>SELECT</code> results will use the bindings as qnames. SPARQL <code>CONSTRUCT</code>
query output (including export) will also use the stored prefixes. To reiterate,
namespace prefix bindings are <strong>per database</strong>, not global.</p>
</div>
</div>
<div class="sect2">
<h3 id="index-strategies">Index Strategies</h3>
<div class="paragraph">
<p>By default Stardog builds extra indexes for named graphs. These
additional indexes are used when SPARQL queries specify datasets using
<code>FROM</code> and <code>FROM NAMED</code>. With these additional indexes, better
statistics about named graphs are also computed.</p>
</div>
<div class="paragraph">
<p>Stardog may also be configured to create and to use fewer indexes, if the
database is only going to be used to store RDF triples&#8212;&#8203;that is to say, if the
database will not be used to store named graph information. In this mode,
Stardog will maintain fewer indexes, which will result in faster database
creation and faster updates without compromising query answering performance. In
such databases, quads (that is: triples with named graphs or contexts specified)
may still be added to these database at any time, but query performance may
degrade in such cases.</p>
</div>
<div class="paragraph">
<p>To create a database which indexes only RDF triples, set the option
<code>index.named.graphs</code> to <code>false</code> at database creation time. The CLI
provides a shorthand option, <code>-i</code> or <code>--index-triples-only</code>, which is
equivalent.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This option can only be set at database creation time
and cannot be changed later without rebuilding the database; use this
option with care.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="differential-indexes">Differential Indexes</h3>
<div class="paragraph">
<p>While Stardog is generally biased in favor of read performance, write
performance is also important in many applications. In order to increase write
performance, Stardog may be used, optionally, with a <strong>differential index</strong>.</p>
</div>
<div class="paragraph">
<p>Stardog&#8217;s differential index is used to persist additions and removals
separately from the main indexes, such that updates to the database can
be performed faster. Query answering takes into consideration all the
data stored in the main indexes and the differential index; hence, query
answers are computed as if all the data is stored in the main indexes.</p>
</div>
<div class="paragraph">
<p>There is a slight overhead for query answering with differential indexes
if the differential index size gets too large. For this reason, the
differential index is merged into the main indexes when its size reaches
<code>DIFF_INDEX_MAX_LIMIT</code>. There is no benefit of differential indexes
if the main index itself is small. For this reason, the differential
index is not used until the main index size reaches
<code>DIFF_INDEX_MAX_LIMIT</code>.</p>
</div>
<div class="paragraph">
<p>In most cases, the default value of the <code>DIFF_INDEX_MAX_LIMIT</code> parameter will
work fine and doesn&#8217;t need to be changed. The corollary  is that you shouldn&#8217;t
change this value in a production system till you&#8217;ve tested the effects of a
change in a non-production system.</p>
</div>
</div>
<div class="sect2">
<h3 id="loading-compressed-data">Loading Compressed Data</h3>
<div class="paragraph">
<p>Stardog supports loading data from compressed files directly: there&#8217;s no need to
uncompress files before loading. Loading compressed data is the recommended way
to load large input files. Stardog supports GZIP and ZIP compressions
natively.<span class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnote_9" title="View footnote.">9</a>]</span></p>
</div>
<div class="sect3">
<h4 id="gzip-and-bzip2">GZIP and BZIP2</h4>
<div class="paragraph">
<p>A file passed to <code>create</code> will be treated as compressed if the file name ends
with <code>.gz</code> or <code>.bz2</code>. The RDF format of the file is determined by the
penultimate extension. For exammple, if a file named <code>test.ttl.gz</code>
is used as input, Stardog will perform GZIP decompression during loading and
parse the file with Turtle parser. All the formats supported by Stardog
(RDF/XML, Turtle, Trig, etc.) can be used with compression.</p>
</div>
</div>
<div class="sect3">
<h4 id="zip">ZIP</h4>
<div class="paragraph">
<p>The ZIP support works differently since zipped files can contain
multiple files. When an input file name ends with <code>.zip</code>, Stardog
performs ZIP decompression and tries to load all the files inside the
ZIP file. The RDF format of the files inside the zip is determined
by their file names as usual. If there is an unrecognized file extension
(e.g. '.txt'), then that file will be skipped.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dropping-a-database">Dropping a Database</h3>
<div class="paragraph">
<p>This command removes a database and all associated files and metadata.
This means all files on disk pertaining to the database will be deleted,
so only use <code>drop</code> when you&#8217;re certain! Databases must be offline in
order to be dropped.</p>
</div>
<div class="paragraph">
<p>It takes as its only argument a valid database name. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db drop my_db</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-integrity-constraint-validation">Using Integrity Constraint Validation</h3>
<div class="paragraph">
<p>Stardog supports integrity constraint validation as a data quality
mechanism via closed world reasoning. Constraints can be specified in
OWL, SWRL, and SPARQL. Please see the <a href="/icv">ICV chapter</a> for more about
using ICV in Stardog.</p>
</div>
<div class="paragraph">
<p>The CLI <code>icv</code> subcommand can be used to add, delete, or drop all
constraints from an existing database. It may also be used to validate
an existing database with constraints that are passed into the <code>icv</code>
subcommand; that is, using different constraints than the ones already
associated with the database.</p>
</div>
<div class="paragraph">
<p>For details of ICV usage, see <code>stardog help icv</code> and <code>stardog-admin help icv</code>.
For ICV in transacted mutations of Stardog databases, see the database creation
section above.</p>
</div>
</div>
<div class="sect2">
<h3 id="migrating-a-database">Migrating a Database</h3>
<div class="paragraph">
<p>The <code>migrate</code> subcommand migrates an older Stardog database to the
latest version of Stardog. Its only argument is the name of the database
to migrate. <code>migrate</code> won&#8217;t necessarily work between arbitrary Stardog
version, so before upgrading check the release notes for a new version
carefully to see whether migration is required or possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin db migrate myDatabase</code></pre>
</div>
</div>
<div class="paragraph">
<p>will update <code>myDatabase</code> to the latest database format.</p>
</div>
</div>
<div class="sect2">
<h3 id="getting-database-information">Getting Database Information</h3>
<div class="paragraph">
<p>You can get some information about a database by running the following
command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin metadata get my_db_name</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will return all the metadata stored about the database, including
the values of configuration options used for this database instance. If
you want to get the value for a specific option then you can run the
following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin metadata get -o index.named.graphs my_db_name</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="managing-queries">Managing Queries</h3>
<div class="paragraph">
<p>Stardog includes the capability to manage running queries according to
configurable policies set at run-time; this capability includes support
for <strong>listing</strong> running queries; <strong>deleting</strong> running queries; <strong>reading</strong> the
status of a running query; <strong>killing</strong> running queries that exceed a
time threshold automatically; and <strong>logging</strong> slow queries for analysis.</p>
</div>
<div class="paragraph">
<p>Stardog is pre-configured with sensible <strong>server-wide</strong> defaults for query
management parameters; these defaults may be overridden or disabled per
database.</p>
</div>
<div class="sect3">
<h4 id="configuring-query-management">Configuring Query Management</h4>
<div class="paragraph">
<p>For many uses cases the default configuration will be sufficient. But
you may need to tweak the timeout parameter to be longer or shorter,
depending on the hardware, data load, queries, throughput, etc. The
default configuration has a server-wide query timeout value of
<code>query.timeout</code>, which is inherited by all the databases in the server.
You can customize the server-wide timeout value and then set
per-database custom values, too. Any database without a custom value
inherits the server-wide value. To disable query timeout, set
<code>query.timeout</code> to <code>0</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="listing-queries">Listing Queries</h4>
<div class="paragraph">
<p>To see all running queries, use the <code>query list</code> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin query list</code></pre>
</div>
</div>
<div class="paragraph">
<p>The results are formatted tabularly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">+----+----------+-------+--------------+
| ID | Database | User  | Elapsed time |
+----+----------+-------+--------------+
| 2  | test     | admin | 00:00:20.165 |
| 3  | test     | admin | 00:00:16.223 |
| 4  | test     | admin | 00:00:08.769 |
+----+----------+-------+--------------+

3 queries running</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see which user owns the query (superuser&#8217;s can see all running
queries), as well as the elapsed time and the database against which the
query is running. The ID column is the key to deleting queries.</p>
</div>
</div>
<div class="sect3">
<h4 id="deleting-queries">Deleting Queries</h4>
<div class="paragraph">
<p>To delete a running query, simply pass its ID to the <code>query kill</code>
subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin query kill 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output confirms the query kill completing successfully:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">Query 3 killed successfully</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="automatically-killing-queries">Automatically Killing Queries</h4>
<div class="paragraph">
<p>For production use, especially when a Stardog database is exposed to
arbitrary query input, some of which may not execute in an acceptable
time period, the automatic query killing feature is useful. It will
protect a Stardog Server from queries that consume too many resources.</p>
</div>
<div class="paragraph">
<p>Once the execution time of a query exceeds the value of <code>query.timeout</code>,
the query will be killed automatically.<span class="footnote">[<a id="_footnoteref_10" class="footnote" href="#_footnote_10" title="View footnote.">10</a>]</span> The client that submitted the
query will receive an error message. The value of <code>query.timeout</code> may be
overriden by setting a different value (smaller or longer) in database
options. To disable, set to <code>query.timeout</code> to <code>0</code>.</p>
</div>
<div class="paragraph">
<p>The value of <code>query.timeout</code> is a positive integer concated with a
letter, interpreted as a time duration: 'h' (for hours),
'm' (for minutes), 's' (for seconds), or 'ms' (for milliseconds). For
example, '1h' for 1 hour, '5m' for 5 minutes, '90s' for 90 seconds, and
'500ms' for 500 milliseconds.</p>
</div>
<div class="paragraph">
<p>The default value of <code>query.timeout</code> is five minutes.</p>
</div>
</div>
<div class="sect3">
<h4 id="query-status">Query Status</h4>
<div class="paragraph">
<p>To see more detail about query in-flight, use the <code>query status</code>
subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog-admin query status 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting output includes query metadata, including the query
itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">Username: admin
Database: test
Started : 2013-02-06 09:10:45 AM
Elapsed : 00:01:19.187
Query   :
select ?x ?p ?o1 ?y ?o2
   where {
     ?x ?p ?o1.
     ?y ?p ?o2.
     filter (?o1 &gt; ?o2).
    }
order by ?o1
limit 5</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="slow-query-logging">Slow Query Logging</h4>
<div class="paragraph">
<p>Stardog does not log slow queries in the default configuration because there
isn&#8217;t a single value for what counts as a "slow query", which is entirely
relative to queries, access patterns, dataset sizes, etc. While slow query
logging has very minimal overhead, what counts as a slow query in some context
may be quite acceptable in another. To enable slow query logging, see the
<a href="/#slowquery">discussion above</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="protocols-and-java-api">Protocols and Java API</h4>
<div class="paragraph">
<p>For HTTP protocol support, see <a href="http://docs.stardog.apiary.io/">Stardog&#8217;s Apiary</a> docs.</p>
</div>
<div class="paragraph">
<p>For Java, see <a href="http://docs.stardog.com/java/snarl/)">the Javadocs</a></p>
</div>
</div>
<div class="sect3">
<h4 id="security-and-query-management">Security and Query Management</h4>
<div class="paragraph">
<p>The security model for query management is very simple: any user can
kill any running query submitted by that user, and a superuser can kill any
running query. The same general restriction is applied to query status;
you cannot see status for a query that you do not own, and a superuser can
see the status of every query.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="managing-search-indexes">Managing Search Indexes</h3>
<div class="paragraph">
<p>Stardog&#8217;s search service is described in the <a href="/using">Using Stardog</a>
chapter. However, managing search indexes is an administrative task and, thus,
is described here.</p>
</div>
<div class="paragraph">
<p>There are three modes for rebuilding indexes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>sync</code>: Recompute the search index synchronously with a transacted
write.</p>
</li>
<li>
<p><code>async</code>: Recompute the search index asynchronously as soon as
possible with respect to a transacted write.</p>
</li>
<li>
<p>Scheduled: Use a <a href="http://www.quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/crontrigger">cron expression</a>
to specify when the search index should be updated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This is specified when creating a database by setting the property
<code>search.reindex.mode</code> to <code>sync</code>, <code>async</code>, or to a valid cron expression.
The default is <code>sync</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="transactions-and-database-guarantees">Transactions and Database Guarantees</h3>
<div class="sect3">
<h4 id="atomicity">Atomicity</h4>
<div class="paragraph">
<p>Atoms in ancient Greece were thought to be uncuttable bits of simple stuff.
Databases may provide a guarantee of atomicity&#8212;&#8203;groups of database actions
(i.e., mutations) are irreducible and indivisible: either all of the changes
happen or none of them happens. Stardog&#8217;s transacted writes are atomic.</p>
</div>
</div>
<div class="sect3">
<h4 id="consistency">Consistency</h4>
<div class="paragraph">
<p>Data stored should be valid with respect to the data model (in this case, RDF)
and to the guarantees offered by the database, as well as to any
appliction-specific integrity contraints that may exist. Stardog&#8217;s transactions
are guaranteed not to violate integrity constraints during execution. A
transaction that would leave a database in an inconsistent or invalid state is
aborted.</p>
</div>
<div class="paragraph">
<p>See the <a href="/icv">ICV chapter</a> for a more detailed consideration of Stardog&#8217;s
integrity constraint mechanism.</p>
</div>
</div>
<div class="sect3">
<h4 id="isolation">Isolation</h4>
<div class="paragraph">
<p>A Stardog connection will run in <a href="http://en.wikipedia.org/wiki/Isolation_(database_systems)#Read_committed"><code>READ COMMITTED</code></a>
isolation level if it has not
started an explicit transaction and will run in <code>READ COMMITTED SNAPSHOT</code>
isolation level if it has started a transaction. In either mode, uncommitted
changes will only be visible to the connection that made the changes: no other
connection can see those values before they are committed. Thus, "dirty reads"
can never occur. Neither mode locks the database; if there are conflicting
changes, the latest commit wins.<span class="footnote">[<a id="_footnoteref_11" class="footnote" href="#_footnote_11" title="View footnote.">11</a>]</span></p>
</div>
<div class="paragraph">
<p>The difference between <code>READ COMMITTED</code> and <code>READ COMMITTED SNAPSHOT</code> isolation
levels is that in the former case a connection will see updates committed by
another connection immediately, whereas in the latter case a connection will see
a transactionally consistent snapshot of the data as it existed at the start of
the transaction and will not see any updates.</p>
</div>
<div class="paragraph">
<p>We illustrate the difference between these two levels with the following example
where initially the database contains a single triple <code>:x :value 1</code>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of the difference between RCI and RCSI</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>BEGIN TX</strong></code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INSERT {:x :value 2}<br>
DELETE {:x :value ?old}</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SELECT ?val {?x :val ?val}<br>
&#8656; <code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>BEGIN TX</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>COMMIT</strong></code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code> <br>
&#8656; <code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INSERT {:x :value 3}<br>
DELETE {:x :value ?old}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>9</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>COMMIT</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT ?val {?x :val ?val}</code><br>
&#8656; <code>3</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="durability">Durability</h4>
<div class="paragraph">
<p>By default Stardog&#8217;s transacted writes are not durable; in some applications
transactional durability is required and, thus, should be enabled.</p>
</div>
</div>
<div class="sect3">
<h4 id="commit-failure-autorecovery">Commit Failure Autorecovery</h4>
<div class="paragraph">
<p>Stardog&#8217;s transaction framework is largely maintenance free; but there are some
rare conditions in
which manual intervention may be needed.</p>
</div>
<div class="paragraph">
<p>Stardog&#8217;s strategy for recovering automatically from (the very unlikely
event of) commit failure is as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stardog will roll back the transaction upon a commit
failure;</p>
</li>
<li>
<p>Stardog takes the affected database offline for
maintenance;<span class="footnote">[<a id="_footnoteref_12" class="footnote" href="#_footnote_12" title="View footnote.">12</a>]</span> then</p>
</li>
<li>
<p>Stardog will begin recovery, bringing the
recovered database back online once that task is successful so that
operations may resume.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>With an appropriate logging configuration for production usage (at least
error-level logging), log messages for the preceding recovery operations
will occur. If for whatever reason the database fails to be returned
automatically to online status, an administrator may use the CLI tools
(i.e., <code>stardog-admin db online</code>) to attempt to online the database.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="optimizing-bulk-data-loading">Optimizing Bulk Data Loading</h3>
<div class="paragraph">
<p>Stardog tries hard to do bulk loading at database creation time in the
most efficient and scalable way possible. But data loading time can vary
widely, depending on factors in the data to be loaded, including the
number of unique resources, etc. Here are some tuning tips that may work
for you:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Load <a href="#compressed">compressed data files</a> since compression
minimizes disk access</p>
</li>
<li>
<p>Use a multicore machine since bulk loading is highly parallelized
and indexes are built concurrently</p>
</li>
<li>
<p>Load multiple files together at creation time since different files
will be parsed and processed concurrently improving the load speed</p>
</li>
<li>
<p>Turn off <a href="#jvm-arg">strict parsing</a></p>
</li>
<li>
<p>If you are not using named graphs, use <a href="#index-strategies">triples only indexing</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="capacity-planning">Capacity Planning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The primary system resources used by Stardog are CPU, memory, and
disk.<span class="footnote">[<a id="_footnoteref_13" class="footnote" href="#_footnote_13" title="View footnote.">13</a>]</span> Stardog
will take advantage of multiple CPUs, cores, and core-based threads in data
loading and in throughput-heavy or multi-user loads. And obviously Stardog
performance is influenced by the speed of CPUs and cores. But some workloads are
bound by main memory or by disk I/O (or both) more than by CPU. In general, use
the fastest CPUs you can afford with the largest secondary caches and the most
number of cores and core-based threads of execution, especially in multi-user
workloads.</p>
</div>
<div class="paragraph">
<p>The following subsections provides more detailed guidance for the memory
and disk resource requirements of Stardog.</p>
</div>
<div class="sect2">
<h3 id="memory-usage">Memory usage</h3>
<div class="paragraph">
<p>Stardog uses system memory aggressively and the total system memory
available to Stardog is often the most important factor in
performance. Stardog uses both JVM memory (heap memory) and
also the operating system memory outside the JVM (off heap
memory). Having more system memory available is always good; however,
increasing JVM memory too close to total system memory is not usually
prudent as it may tend to increase Garbage Collection (GC) time in the
JVM.</p>
</div>
<div class="paragraph">
<p>The following table shows recommended JVM memory and system
memory requirements for Stardog.<span class="footnote">[<a id="_footnoteref_14" class="footnote" href="#_footnote_14" title="View footnote.">14</a>]</span></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of Memory Usage for Capacity Planning</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"># of Triples</th>
<th class="tableblock halign-left valign-top">JVM Memory</th>
<th class="tableblock halign-left valign-top">Off-heap memory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 million</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 billion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 billion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 billion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">50 billion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256GB</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>By default, Stardog CLI sets the maximum JVM memory to 2GB. This setting
works fine for most small databases (up to, say, 100 million
triples). As the database size increases, we recommend increasing JVM
memory. You can increase the JVM memory for Stardog by setting the
system property <code>STARDOG_JAVA_ARGS</code> using the standard JVM options. For
example, you can set this property to <code>"-Xms4g -Xmx4g -XX:MaxDirectMemorySize=8g"</code>
to increase the JVM memory to 4GB and off-heap to 8GB. We recommend
setting the minimum heap size (<code>-Xms</code> option) as close to
the max heap size (<code>-Xmx</code> option) as possible.</p>
</div>
<div class="sect3">
<h4 id="system-memory-and-jvm-memory">System Memory and JVM Memory</h4>
<div class="paragraph">
<p>Stardog uses an off-heap, custom memory allocation scheme. Please note
that the memory provisioning recommendations above are for two kinds of memory
allocations for the JVM in which Stardog will run. The first is for memory that
the JVM will manage explicitly (i.e., "JVM memory"); and the second, i.e.,
"Off-heap memory" is for memory that Stardog will manage explicitly, i.e., off
the JVM heap, but for which the JVM should be notified via the
<code>MaxDirectMemorySize</code> property. In most cases, this should be somewhat less than
the total memory available to the underlying operating system as requirements
dictate.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disk-usage">Disk usage</h3>
<div class="paragraph">
<p>Stardog stores data on disk in a compressed format. The disk space
needed for a database depends on many factors besides the number of
triples, including the number of unique resources and literals in the
data, average length of resource identifiers and literals, and how much
the data is compressed. The following table shows typical disk space
used by a Stardog database.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of Typical Disk Space Requirements</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"># of triples</th>
<th class="tableblock halign-left valign-top">Disk space</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 billion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">70GB to 100GB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 billion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">700GB to 1TB</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These numbers are given for information purposes only; the actual disk
usage for a database may be significantly different in practice. Also it
is important to note that the amount of disk space needed at creation
time for bulk loading data is higher as temporary files will be
created. The additional disk space needed at bulk loading time can be
40% to 70% of the final database size.</p>
</div>
<div class="paragraph">
<p>Disk space used by a database is non-trivially smaller if
<a href="#index-strategies">triples only indexing</a> is used. Triples-only indexing
reduces overall disk space used by 25% on average; however, note
the tradeoff: SPARQL queries involving named graphs perform
significantly better with quads indexing.</p>
</div>
<div class="paragraph">
<p>The disk space used by Stardog is additive for multiple databases and
there is very little disk space used other than what is required for the
databases. To calculate the total disk space needed for multiple databases,
one may sum the disk space needed by each database.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-stardog-on-windows">Using Stardog on Windows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog provides batch (<code>.bat</code>) files for use on Windows; they
provide roughly the same set of functionality provided by the Bash
scripts which are used on Unix-like systems. There are, however, a few small
differences between the two. When you start a server with
<code>server start</code> on Windows, this does not detach to the background,
it will run in the current console.</p>
</div>
<div class="paragraph">
<p>To shut down the server correctly, you should either issue a
<code>server stop</code> command from another window or press <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>C</kbd></span> (and then
<kbd>Y</kbd> when asked to terminate the batch job). Do not under any
circumstance close the window without shutting down the server. This
will simply kill the process without shutting down Stardog, which could
cause your database to be corrupted.</p>
</div>
<div class="paragraph">
<p>The <code>.bat</code> scripts for Windows support our standard <code>STARDOG_HOME</code> and
<code>STARDOG_JAVA_ARGS</code> environment variables which can be used to control
where Stardog&#8217;s database is stored and, usually, how much memory is given
to Stardog&#8217;s JVM when it starts. By default, the script will use the JVM
that is available in the directory from which Stardog is run via the
<code>JAVA_HOME</code> environment variable. If this is not set, it will simply
execute <code>java</code> from within that directory.</p>
</div>
<div class="sect2">
<h3 id="running-stardog-as-a-windows-service">Running Stardog as a Windows Service</h3>
<div class="paragraph">
<p>You can run Stardog as a Windows Service using the following
configuration. Please, note, that the following assumes commands are
executed from a Command Prompt with administrative privileges.</p>
</div>
<div class="sect3">
<h4 id="installing-the-service">Installing the Service</h4>
<div class="paragraph">
<p>Change the directory to the Stardog installation directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bat"><span class="tok-k">cd</span> c:\stardog-$VERSION</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-the-service">Configuring the Service</h4>
<div class="paragraph">
<p>The default settings with which the service will be installed are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>2048 MB of RAM</p>
</li>
<li>
<p><code>STARDOG_HOME</code> is the same as the installation directory</p>
</li>
<li>
<p>the name of the installed service will be "Stardog Service"</p>
</li>
<li>
<p>Stardog service will write logs to the "logs" directory within the
installation directory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To change these settings, set appropriate environment variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>STARDOG_MEMORY</code>: the amount of memory in MB (e.g., set
<code>STARDOG_MEMORY</code>=4096)</p>
</li>
<li>
<p><code>STARDOG_HOME</code>: the path to <code>STARDOG_HOME</code> (e.g., set
<code>STARDOG_HOME</code>=c:\\stardog-home)</p>
</li>
<li>
<p><code>STARDOG_SERVICE_DISPLAY_NAME</code>: a different name to be displayed in
the list of services (e.g., set
<code>STARDOG_SERVICE_DISPLAY_NAME</code>=Stardog Service)</p>
</li>
<li>
<p><code>STARDOG_LOG_PATH</code>: a path to a directory where the log files should
be written (e.g., set <code>STARDOG_LOG_PATH</code>=c:\\stardog-logs)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you have changed the default administrator password, you also
need to modify <code>stop-service.bat</code> and specify the new username and
password there (by passing <code>-u</code> and <code>-p</code> parameters in the line that
invokes <code>stardog-admin server stop</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="installing-stardog-as-a-service">Installing Stardog as a Service</h4>
<div class="paragraph">
<p>Run the <code>install-service.bat</code> script.</p>
</div>
<div class="paragraph">
<p>At this point the service has been installed, but it is not running. To
run it, see the next section or use any Windows mechanism for
controlling the services (e.g., type <code>services.msc</code> on the command
line).</p>
</div>
</div>
<div class="sect3">
<h4 id="starting-stopping-changing-service-configuration">Starting, Stopping, &amp; Changing Service Configuration</h4>
<div class="paragraph">
<p>Once the service has been installed, execute <code>stardog-serverw.exe</code>,
which will allow you to configure the service (e.g., set whether the
service is started automatically or manually), manually start and stop
the service, as well as to configure most of the service parameters.</p>
</div>
</div>
<div class="sect3">
<h4 id="uninstalling-the-stardog-service">Uninstalling the Stardog Service</h4>
<div class="paragraph">
<p>The service can be uninstalled by running <code>uninstall-service.bat</code>
script.</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="high-availability-cluster" class="sect0">High Availability Cluster</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>In this section we explain how to configure, use, and administer Stardog Cluster
for uninterrupted operations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Stardog Cluster 2.2.3 is <strong>BETA</strong> software and should be used
accordingly. Please help us test it and report bugs!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-stardog-cluster">What is Stardog Cluster?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog Cluster is a collection of Stardog Server instances running on one or
more virtual or physical machines that, <strong>from the client&#8217;s perspective</strong>, behave
like a single Stardog Server instance.<span class="footnote">[<a id="_footnoteref_15" class="footnote" href="#_footnote_15" title="View footnote.">15</a>]</span> Of course Stardog Cluster should have some different
operational properties, the main one of which is high availability. But from the
client&#8217;s perspective Stardog Cluster should be indistinguishable from
non-clustered Stardog.<span class="footnote">[<a id="_footnoteref_16" class="footnote" href="#_footnote_16" title="View footnote.">16</a>]</span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-about-deployment">What about Deployment?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Clustered database deployment is notable for being a complete pain in the ass
and different in every computing environment on earth. We&#8217;ve made Stardog
Cluster deployment easier for you, but we haven&#8217;t solved the problem of
universal devops or deployment of distributed databases. It may be painful to
deploy Stardog Cluster, and that will likely depend on details of yr computing
environment about which we probably know very little.</p>
</div>
<div class="paragraph">
<p>Three additional points ameliorate this pain. We&#8217;ve built a deployment tool,
called <a href="http://github.com/clarkparsia/starman">Starman</a>, that will work for many
cases; and we&#8217;ve open sourced it. We&#8217;ve fully documented what is required to
configure and deploy a Stardog Cluster. The dependencies are few and ubiquitous
(SSH, JVM 1.6 or newer).</p>
</div>
<div class="paragraph">
<p>Okay, so a quick deployment overview:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if you&#8217;re deploying to EC2, yr own (Ubuntu, for now) servers, or to Oracle&#8217;s
VirtualBox, Starman will very likely just work</p>
</li>
<li>
<p>if you&#8217;re deploying to something else,
<a href="https://github.com/clarkparsia/starman/wiki/How-to-deploy-Stardog-Cluster-manually">read
the deployment recipe</a> and adapt it to yr infrastructure</p>
</li>
<li>
<p>sharing configurations based on other systems so we can put them in Starman&#8217;s repo would be cool</p>
</li>
<li>
<p>pull requests to make Starman (which is based on <a href="http://palletops.com/" class="bare">http://palletops.com/</a>) work with other targets are even cooler</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, here&#8217;s the very high-level overview of how to deploy with Starman:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>configure Stardog Cluster</p>
</li>
<li>
<p>bootstrap and locally install Stardog Cluster images</p>
</li>
<li>
<p>depending on yr deployment target, do some deploy target specific stuff&#8230;&#8203;</p>
</li>
<li>
<p>deploy Stardog Cluster to the chosen deployment target</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-stardog-cluster">Configuring Stardog Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, make sure that you have the Stardog Cluster software and dependencies:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>stardog-x.x.zip: Stardog &gt;= 2.2.1</p>
</li>
<li>
<p>starman and starman-*-standalone.jar: the Starman distribution</p>
</li>
<li>
<p>stardog-license-key.bin: a valid Stardog license</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In fact this is pretty easy since we distribute Starman with Stardog starting
with 2.2.1; but you may at some point start using a custom Starman separately,
etc. so just remember that it is a Stardog Cluster dependency unless yr using
some other deployment system.</p>
</div>
<div class="paragraph">
<p>By default Starman creates a configuration file in <code>~/.starmanconfig</code> and all
installed Stardog Cluster images will be stored under <code>~/.starman</code>. If you wish
to change the location where Starman stores Stardog Cluster images, simply set
the environment variable <code>$STARMAN_HOME</code> to some other location. This will
change the location of <code>~/.starman</code> to <code>$STARMAN_HOME/starman</code>, and
<code>~/.starmanconfig</code> to <code>$STARMAN_HOME/starmanconfig</code>.</p>
</div>
<div class="paragraph">
<p>The following properties can be configured in <code>starmanconfig</code>, depending on
which deploy targets (EC2, VirtualBox, or other servers you choose):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell"># for deploying on some machines you have access to over an IP network...
# the list of IPs for deploying on existing machines
default-nodes = 10.11.12.13:10.11.12.14:10.11.12.15

# for deploying on EC2...
# EC2 credentials
ec2-access-id = myaccessid
ec2-secret-key = secret
# EC2 instance type
ec2-instance-type = m1.medium
# EC2 AMI ID - Ubuntu 14.04 AMIs are supported*
ec2-ami-id = ami-c8cf3ba0
ec2-region-id = us-east-1d

# if you&#39;re using VirtualBox...
# Minimum RAM assigned for VM in VirtualBox deployments
vmfest-node-min-ram = 3500
# Minimum cores assigned for VM in VirtualBox deployments
vmfest-node-min-cores = 2

# JVM options for Stardog instances – they will override the default JVM options specified in stardog-admin
stardog-java-args = -Xmx3g -Xms3g -Dapple.awt.UIElement=true -Dfile.encoding=UTF-8

# Stardog additional properties – these will be appended to stardog.properties
# in addition to the properties used for Stardog cluster configuration.
# Simply use the same property names that Stardog already uses prefixed with &#39;stardog-properties-&#39;.
# E.g.:
stardog-properties-stardog.default.cli.server = snarl://localhost:6000

# Additional CLI options for ./stardog-admin server start – these will be added at the end of the command.
# Note that Starman already sets values for the options ==home, ==port, and ==bind in order to run Stardog in
# cluster mode
stardog-cli-opts = ==disable-security

# Additional properties for zookeeper – these will be appended at the end of zookeeper.properties.
# Use the prefix &#39;zookeeper-properties-&#39;
zookeeper-properties-tickTime=2000</code></pre>
</div>
</div>
<div class="paragraph">
<p>As of Stardog 2.2.1, Starman is only tested with Ubuntu 14.04 AMIs. It may or
may not work with other AMIs. You can find a comprehensive list of available
Ubuntu 14.04 AMIs and the instance types compatible with each of them
<a href="https://cloud-images.ubuntu.com/locator/ec2/">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-stardog-cluster-with-starman">Setting Up Stardog Cluster with Starman</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Second, you have to do some general setup for Stardog Cluster.</p>
</div>
<div class="paragraph">
<p>First, bootstrap your Stardog Cluster image with Starman:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">./starman svm bootstrap --tag &lt;tag_name&gt; \
					--stardog /path/to/stardog-&lt;version&gt;.zip \
					--license /path/to/stardog-license-key.bin</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>&lt;tag_name&gt;</code> is a custom name for the Stardog Cluster image to install, e.g. myImage.</p>
</div>
<div class="paragraph">
<p>Second, locally install a cluster image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">./starman svm install --id &lt;cluster_id&gt; --tag &lt;tag_name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>&lt;cluster_id&gt;</code> should be a positive integer larger than 0.</p>
</div>
<div class="paragraph">
<p>You can list yr bootstrapped and locally installed Stardog Cluster images using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">./starman svm list</code></pre>
</div>
</div>
<div class="paragraph">
<p>Third, now that Stardog Cluster is bootstrapped and its images are localled
prepared, we can deploy them to one of the deployment targets; now you have
to decide what yr deployment target is: EC2, VirtualBox, or other servers. Then
follow the instructions in the appropriate subsection below.</p>
</div>
<div class="sect2">
<h3 id="virtual-machine">Virtual Machine</h3>
<div class="paragraph">
<p>Requirement: Oracle VirtualBox v4.2.x if deploying to VirtualBox servers</p>
</div>
<div class="paragraph">
<p>Before deploying Stardog Cluster image nodes to VirtualBox&#8212;&#8203;we refer to this
provider as <code>vmfest</code>--make sure to follow these steps.</p>
</div>
<div class="paragraph">
<p>Open a terminal and start VirtualBox&#8217;s webservice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ VBoxManage setproperty websrvauthlibrary null # needs to be done only once

$ vboxwebsrv -t0</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a new terminal add the identities stored in your public ssh key:</p>
</div>
<div class="paragraph">
<p>OS X:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ssh-add -K /path/to/your/public/SSH/key</code></pre>
</div>
</div>
<div class="paragraph">
<p>Linux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ssh-add /path/to/your/public/SSH/key</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding your public key to the ssh agent allows interacting with the vitual
machine, and also lets you log in to the virtual machine using <code>ssh &lt;ip
address&gt;</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="amazon-ec2">Amazon EC2</h3>
<div class="paragraph">
<p>Requirements: An EC2 account on Amazon Web Services for EC2 deployments, along
with your key pair and Access ID and Secret Key.</p>
</div>
<div class="paragraph">
<p>Make sure to have a
<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">key pair</a>
and add it via the ssh agent using:</p>
</div>
<div class="paragraph">
<p>OS X:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ssh-add -K /path/to/your/pem</code></pre>
</div>
</div>
<div class="paragraph">
<p>Linux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ssh-add /path/to/your/pem</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding your public key to the ssh agent allows interacting with the remote
machine, and also lets you log in to the virtual machine using <code>ssh &lt;ip
address&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Make sure to have an
<a href="http://docs.aws.amazon.com/AWSSecurityCredentials/1.0/AboutAWSCredentials.html#AccessKeys"><strong>Access
Key ID</strong> and a <strong>Secret Access Key</strong></a> and then add them to your configuration file
located in <code>~/.starmanconfig</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">ec2-access-id = &lt;your Access Key ID&gt;
ec2-secret-key = &lt;your Access Key ID&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally, specify the instance type. Starman by default creates <code>m1.medium</code>
EC2 instances, but you can specify in .starmanconfig` some other EC2 instance
types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">ec2-instance-type = &lt;some instance type&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the only instance types allowed are the ones in the <a href="https://github.com/aws/aws-sdk-java/blob/1.8.2/src%2Fmain%2Fjava%2Fcom%2Famazonaws%2Fservices%2Fec2%2Fmodel%2FInstanceType.java#L22-L56">AWS SDK</a>. Compare those values with the most current EC2 <a href="http://aws.amazon.com/ec2/instance-types/">instance
types</a> for more info.</p>
</div>
</div>
<div class="sect2">
<h3 id="other-servers">Other Servers</h3>
<div class="paragraph">
<p>In order to simplify the process we assume that the remote machines are running
Ubuntu, and that the user has
<a href="http://www.howtogeek.com/168147/add-public-ssh-key-to-remote-server-in-a-single-command/">password-less</a>
SSH access and is able to execute <a href="http://askubuntu.com/a/192062">password-less</a>
sudo in the remote machines.</p>
</div>
<div class="paragraph">
<p>As of Stardog 2.2.1, the only cluster commands supported for deploying to
existing servers are <code>cluster deploy</code>, <code>cluster start</code> and <code>cluster stop</code>.
Before using Starman with existing servers, you will need to edit the Starman
configuration file located in <code>~/.starmanconfig</code> and make sure to add the list
of default nodes as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">default-nodes=10.11.12.13:10.11.12.14:10.11.12.15</code></pre>
</div>
</div>
<div class="paragraph">
<p>where the property <code>default-nodes</code> is a colon-separated list of IP addresses
that correspond to the existing servers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-stardog-cluster">Deploying Stardog Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using any of the following commands make sure to replace the <code>--provider</code>
option argument with any of these: <code>vmfest</code> for VirtualBox, <code>ec2</code> for Amazon
EC2, or <code>default</code> for existing servers.</p>
</div>
<div class="paragraph">
<p>The last bit of information here is the <strong>cluster size</strong>. As of 2.2.1, Stardog
Cluster only supports the cluster topology "one coordinator, many followers",
but we need to determine the size of the cluster, which should be a multiple of
3. We pass that to Starman deploy using the `--numvms`<span class="footnote">[<a id="_footnoteref_17" class="footnote" href="#_footnote_17" title="View footnote.">17</a>]</span> argument.</p>
</div>
<div class="paragraph">
<p>Now we&#8217;re ready to deploy Stardog Cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">./starman cluster deploy --id &lt;cluster_id&gt; --numvms &lt;num_nodes&gt; --provider &lt;provider&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Starman will create the Cluster, and then perform the required setup on the
required nodes. This step will take a while depending on the network, since
Starman is copying Stardog Cluster images to <strong>N</strong> machines.</p>
</div>
<div class="paragraph">
<p>Detailed output can be seen in the log file <code>./logs/pallet.log</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster-management">Cluster Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that the Cluster has been deployed, we hav to start it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">./starman cluster start --id &lt;cluster_id&gt; --provider &lt;provider&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output of cluster startup is a list of IP addresses; to meld these into a
single symbolic name for the database is left as an exercise for the reader but
we recommend suitable configuration of DNS or HaProxy or similar. The nodes of
the Stardog Cluster, as of Stardog 2.2.1, implement a simple round robin
strategy for distributing read operations over the cluster; write operations are
directed to the Coordinator exclusively.</p>
</div>
<div class="paragraph">
<p>To stop the Cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster stop --id &lt;cluster_id&gt; --provider &lt;provider&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="adding-or-removing-nodes">Adding or removing nodes</h3>
<div class="paragraph">
<p>To add nodes to an existing cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster addnodes --id &lt;cluster_id&gt; --numvms &lt;num_vms&gt; --provider &lt;provider&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will add <code>num_vms</code> to a cluster. Please note that if a node is added to a
cluster, it will only start a Stardog server in the new nodes; if you want to
also replicate the ZooKeeper servers, you will have to stop the cluster and
start it again. This limitation is due to the fact that ZooKeeper is not capable
of hot reconfiguration as of <code>v3.4.x</code>.</p>
</div>
<div class="paragraph">
<p>To remove nodes from an existing cluster there are two options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster removenodes --id &lt;cluster_id&gt; --provider &lt;provider&gt; --numvms &lt;num_vms&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will remove <code>num_vms</code> from a cluster. Note that this will remove an entire VM
from the cluster, which may or not also remove a ZooKeeper server. ZooKeeper is
able to account for node failures, but this may not be the behavior the user
intended. The other option is to specify a comma-separated list of IP addresses
that correspond to the IPs of nodes to be removed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster removenodes --id &lt;cluster_id&gt; --provider &lt;provider&gt; --nodes 10.11.12.13,10.11.12.14,10.11.12.15</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-nodes">Listing Nodes</h3>
<div class="paragraph">
<p>We can verify that Stardog Cluster was deployed successfully using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster list --provider</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see a list of the created nodes. Since Starman adds a password-less
login with SSH authentication on the remote machines, you can also log in via
SSH:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ssh &lt;ipaddress&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="undeploying">Undeploying</h3>
<div class="paragraph">
<p>In order to undeploy a Cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster undeploy --id &lt;cluster_id&gt; --provider &lt;provider&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will destroy all the virtual or remote machines part of cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="managing-local-starman-repo">Managing local Starman Repo</h3>
<div class="paragraph">
<p>If you wish to uninstall a Stardog Cluster image from your local Starman system use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman svm uninstall --id &lt;cluster_id&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to remove a Stardog Cluster image tag from your local Starman system use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">./starman svm remove --tag &lt;version&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To list bootstrapped and installed Stardog Pack versions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">./starman svm list</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stardog-client">Stardog Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to interact with the Stardog Cluster using Stardog CLI tools in the
ordinary way--<code>stardog-admin</code> and <code>stardog</code>--you must install Stardog locally
as you usually do by unzipping the contents of <code>stardog-*.zip</code>, for example (for
<code>v2.2.1</code>).</p>
</div>
<div class="paragraph">
<p>With the provided Stardog binaries in the Stardog Cluster distribution you can
query the state of the cluster using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./stardog-admin --server snarl://&lt;ipaddress&gt;:5820/ cluster info</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>ipaddress</code> is the IP address of any of the nodes in the cluster. This
will print the available nodes in the cluster, as well as the roles (participant
or coordinator). You can also input the proxy IP address and port to get the
same information.</p>
</div>
<div class="sect2">
<h3 id="adding-removing-data">Adding/Removing data</h3>
<div class="paragraph">
<p>To add or remove data, simply use the <code>stardog data add</code> or <code>remove</code> commands to
any node in the cluster. Queries can be issued to any node in the cluster using
the <code>stardog query</code> command. All the <code>stardog-admin</code> features are also available
in cluster mode, which means you can use any of the commands to create
databases, adminster users, and the rest of the functionality available in
single server mode.</p>
</div>
<div class="paragraph">
<p>You can use Starman to copy files remotely for bulk loading files to your cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster copyfile --id &lt;cluster id&gt; --provider &lt;provider&gt; &lt;origin&gt; &lt;destination&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;origin&gt;</code> is the path in your local machine and <code>&lt;destination&gt;</code> is the path in
the remote machines. This command will copy the local files to all the servers
in the cluster in the specified path.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting-zookeeper">Troubleshooting ZooKeeper</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ZooKeeper uses
<a href="http://zookeeper.apache.org/doc/r3.3.5/zookeeperInternals.html#sc_quorum">majority
quorums</a> for leader election by default which means that, at any given time, ZooKeeper
requires that there are at least <strong>n/2 + 1</strong> nodes when leader election is
happening. In the event that a Stardog Cluster is stuck in this
phase, you can use Starman to recover a ZooKeeper node using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./starman cluster addnodes ==provider &lt;provider&gt; ==id &lt;cluster id&gt; ==zk-node</code></pre>
</div>
</div>
<div class="paragraph">
<p>Starman will attempt to guess which of the ZooKeeper server(s) was lost and try
to bring a ZooKeeper server back&#8212;&#8203;one at a time&#8212;&#8203;with the same hostname.</p>
</div>
<div class="paragraph">
<p>Starman creates a list of hostnames when nodes are deployed to a cluster and
uses that list to communicate between nodes in the ZooKeeper cluster. Whenever a
ZooKeeper server is lost, a new one can be brought back without having to use
the same IP address, which may not be possible or expensive for some cloud
providers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stardog-cluster-guarantees">Stardog Cluster Guarantees</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog Cluster implements an atomic commitment protocol based on
<a href="http://en.wikipedia.org/wiki/Two-phase_commit_protocol">two-phase commit (2PC)</a>
over a shared replicated memory that&#8217;s provided by Apache ZooKeeper. A cluster is
composed of a set of Stardog servers running together. One of the servers is
known as the Coordinator and the rest as Participants.</p>
</div>
<div class="paragraph">
<p>In case the Coordinator fails at any point, a new Coordinator will be elected
out of the remaining available Participants. Stardog Cluster supports both
<code>read</code> (e.g., querying) and <code>write</code> (e.g., adding data) requests. Read requests
are load-balanced over the available Participants, whereas write requests are
transparently forwarded to and handled by the Coordinator. In some future
release we may change the protocol implemented by the Cluster and thus change
some of the allowable topologies, including multiple-writers and
multiple-readers.</p>
</div>
<div class="sect2">
<h3 id="consistency-guarantees">Consistency Guarantees</h3>
<div class="paragraph">
<p>When a client commits a transaction (containing a list of <code>write</code> requests), it
will be acknowledged by the Coordinator only <strong>after every non-failing Participant
has committed the transaction</strong>. If a Participant fails during the process of
committing a transaction, it will be expelled from the cluster by the
Coordinator and put in a temporary <code>failed</code> state.</p>
</div>
<div class="paragraph">
<p>If the Coordinator fails during the process, the transaction will be aborted,
and a new Coordinator will be elected automatically. Since <code>failed</code> nodes are
not used for any subsequent <code>read</code> or <code>write</code> requests, <strong>if a commit is
acknowledged by the Coordinator, then Stardog Cluster guarantees that the data
has been accordingly modified at <strong>every</strong> available node in the cluster</strong>.</p>
</div>
<div class="paragraph">
<p>While this approach is less performant with respect to write
operations than eventual consistency used by other distributed databases,
typically those databases offer a much less expressive data model than Stardog,
which makes an eventually consistency model more appropriate for those systems.
But since Stardog&#8217;s data model is not only richly expressive but rests in part
on provably correct semantics, we think that a strong consistency model is worth
the cost.<span class="footnote">[<a id="_footnoteref_18" class="footnote" href="#_footnote_18" title="View footnote.">18</a>]</span></p>
</div>
</div>
</div>
</div>
<h1 id="security" class="sect0">Security</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>Stardog&#8217;s security model is based on standard role-based access control: users
have <strong>permissions</strong> over <strong>resources</strong> during <strong>sessions</strong>; permissions can be
grouped into <strong>roles</strong>; and roles can be assigned to <strong>users</strong>.</p>
</div>
<div class="paragraph">
<p>Stardog uses <a href="http://shiro.apache.org/">Apache Shiro</a> for authentication,
authorization, and session management and
<a href="http://www.mindrot.org/projects/jBCrypt/">jBCrypt</a> for password hashing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resources">Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A resource is some Stardog entity or service to which access is to be
controlled. Resources are identified by their <strong>type</strong> and their <strong>name</strong>. A
particular resource is denoted as <code>type_prefix:name</code>. The valid resource
types with their prefixes are shown below.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table of System Resources</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user (e.g., <code>user:admin</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>role</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A role assigned to a user (<code>role:reader</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A database (<code>db:myDB</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metadata of a database (<code>metadata:myDB</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database admin tasks (e.g., <code>admin:myDB</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity Constraints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>icv-constraints</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity constraints associated with a database (e.g., <code>icv-constraints:myDB</code>)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="permissions">Permissions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Permissions are composed of a <strong>permission subject</strong>, an <strong>action</strong>, and a
<strong>permission object</strong>, which is interpreted as the subject resource can perform the
specified action over the object resource.</p>
</div>
<div class="paragraph">
<p>Permission subjects can be of type <code>user</code> or <code>role</code> only. Permission
objects can be of any valid type. Valid actions include the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>read</code></dt>
<dd>
<p>Permits reading the resource properties</p>
</dd>
<dt class="hdlist1"><code>write</code></dt>
<dd>
<p>Permits changing the resource properties</p>
</dd>
<dt class="hdlist1"><code>create</code></dt>
<dd>
<p>Permits creating new resources</p>
</dd>
<dt class="hdlist1"><code>delete</code></dt>
<dd>
<p>Permits deleting a resource</p>
</dd>
<dt class="hdlist1"><code>grant</code></dt>
<dd>
<p>Permits granting permissions over a resource</p>
</dd>
<dt class="hdlist1"><code>revoke</code></dt>
<dd>
<p>Permits revoking permissions over a resource</p>
</dd>
<dt class="hdlist1"><code>execute</code></dt>
<dd>
<p>Permits executing administration actions over a database</p>
</dd>
<dt class="hdlist1"><code>all</code></dt>
<dd>
<p>Special action type that permits all previous actions over a resource</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="wildcards">Wildcards</h3>
<div class="paragraph">
<p>Stardog understands the use of wildcards to represent sets of resources. A
wildcard is denoted with the character <code>*</code>. Wildcards can be used to
create complex permissions; for instance, we can give a user the ability
to create any database by granting it a <code>create</code> permission over <code>db:*</code>.
Similarly, wildcards can be used in order to revoke multiple permissions
simultaneously.</p>
</div>
</div>
<div class="sect2">
<h3 id="superusers">Superusers</h3>
<div class="paragraph">
<p>It is possible at (user) creation time to specify that a given user is a
superuser. Being a superuser is equivalent to having been granted an <code>all</code>
permission over <code>*:*</code>. Therefore, as expected, superusers are allowed to perform
any valid action over any existing resource.</p>
</div>
</div>
<div class="sect2">
<h3 id="database-owner-default-permissions">Database Owner Default Permissions</h3>
<div class="paragraph">
<p>When a user creates a resource, it is automatically granted <code>delete</code>,
<code>write</code>, <code>read</code>, <code>grant</code>, and <code>revoke</code> permissions over the new
resource. If the new resource is a database, then the user is
additionally granted <code>write</code>, <code>read</code>, <code>grant</code>, and <code>revoke</code> permissions
over <code>icv-constraints:theDatabase</code> and <code>execute</code> permission over
<code>admin:theDatabase</code>. These latter two permissions give the creator of the
database the ability to administer the ICV constraints for the database
and to administer the database itself.</p>
</div>
</div>
<div class="sect2">
<h3 id="default-security-configuration">Default Security Configuration</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Out of the box, the Stardog security setup is minimal and <strong>insecure</strong>:
<code>user:admin</code> with password set to "admin" is a superuser;
<code>user:anonymous</code> with password "anonymous" has the "reader" role;
<code>role:reader</code> allows <code>read</code> of any resource.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Do not deploy Stardog in production or hostile environments with the default
security settings.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="setting-password-constraints">Setting Password Constraints</h3>
<div class="paragraph">
<p>To setup the constraints used to validate passwords when adding new users,
configure the following settings in the <code>stardog.properties</code> configuration file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>password.length.min</code>: Sets the password policy for the minimum length of
user passwords, the value can&#8217;t be less than 1 or greater than <code>password.length.max</code>.
Default: <code>4</code>.</p>
</li>
<li>
<p><code>password.length.max</code>: Sets the password policy for the maximum length of
user passwords, the value can&#8217;t be greater than 1024 or less than 1. Default: <code>20</code>.</p>
</li>
<li>
<p><code>password.regex</code>: Sets the password policy of accepted chars in user passwords, via a
Java regular expression. Default: <code>[\\w@#$%]+</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="using-a-password-file">Using a Password File</h3>
<div class="paragraph">
<p>To avoid putting passwords into scripts or environment variables, you can put
them into a suitably secured password file. If no credentials are passed
explicitly in CLI invocations, or you do not ask Stardog to prompt you for
credentials interactively, then it will look for credentials in a password file.
On a Unix system, Stardog will look for a file called <code>.sdpass</code> in the home
directory of the user Stardog is running as; on a Windows system, it will look
for <code>sdpass.conf</code> in <code>Application Data\stardog</code> in the home directory of the
user Stardog is running as. If the file is not found in this location, Stardog
will look in the location provided by the <code>stardog.passwd.file</code> system property.</p>
</div>
<div class="sect3">
<h4 id="password-file-format">Password File Format</h4>
<div class="paragraph">
<p>The format of the password file is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any line that starts with a <code>#</code> is ignored</p>
</li>
<li>
<p>each line contains a single password in the format: <code>hostname:port:database:username:password</code>.</p>
</li>
<li>
<p>wildcards, <code>*</code>, are permitted for any field but the password field; colons and backslashes in fields are escaped with <code>\</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">  #this is my password file; there are no others like it and this one is mine anyway...
  *:*:*:flannery:aNahthu8
  *:*:summercamp:jemima:foh9Moaz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course you should secure this file carefully, making sure that only the user
that Stardog runs as can read it.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managing-stardog-securely">Managing Stardog Securely</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog resources can be managed securely by using the tools included in the
admin CLI or by programming against Stardog APIs. In this section we describe
the permissions required to manage various Stardog resources either by CLI or
API.</p>
</div>
<div class="sect2">
<h3 id="users">Users</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Create a user</dt>
<dd>
<p><code>create</code> permission over <code>user:*</code>. Only superusers can create
other superusers.</p>
</dd>
<dt class="hdlist1">Delete a user</dt>
<dd>
<p><code>delete</code> permission over the user.</p>
</dd>
<dt class="hdlist1">Enable/Disable a user</dt>
<dd>
<p>User must be a superuser.</p>
</dd>
<dt class="hdlist1">Change password of a user</dt>
<dd>
<p>User must be a superuser or user must be trying to
change its own password.</p>
</dd>
<dt class="hdlist1">Check if a user is a superuser</dt>
<dd>
<p><code>read</code> permission over the user or user must be
trying to get its own info.</p>
</dd>
<dt class="hdlist1">Check if a user is enabled</dt>
<dd>
<p><code>read</code> permission over the user or user must be
trying to get its own info.</p>
</dd>
<dt class="hdlist1">List users</dt>
<dd>
<p>Superusers can see all users. Other users can see only users over
which they have a permission.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="roles">Roles</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Create a role</dt>
<dd>
<p><code>create</code> permission over <code>role:*</code>.</p>
</dd>
<dt class="hdlist1">Delete a role</dt>
<dd>
<p><code>delete</code> permission over the role.</p>
</dd>
<dt class="hdlist1">Assign a role to a user</dt>
<dd>
<p><code>grant</code> permission over the role <strong>and</strong> user must
have all the permissions associated to the role.</p>
</dd>
<dt class="hdlist1">Unassign a role from a user</dt>
<dd>
<p><code>revoke</code> permission over the role <strong>and</strong> user
must have all the permissions associated to the role.</p>
</dd>
<dt class="hdlist1">List roles</dt>
<dd>
<p>Superusers can see all roles. Other users can see only roles they
have been assigned or over which they have a permission.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="databases-2">Databases</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Create a database</dt>
<dd>
<p><code>create</code> permission over <code>db:*</code>.</p>
</dd>
<dt class="hdlist1">Delete a database</dt>
<dd>
<p><code>delete</code> permission over <code>db:theDatabase</code>.</p>
</dd>
<dt class="hdlist1">Add/Remove integrity constraints to a database</dt>
<dd>
<p><code>write</code> permission over
<code>icv-constraints:theDatabase</code>.</p>
</dd>
<dt class="hdlist1">Verify a database is valid</dt>
<dd>
<p><code>read</code>
permission over <code>icv-constraints:theDatabase</code>.</p>
</dd>
<dt class="hdlist1">Online/Offline a database</dt>
<dd>
<p><code>execute</code> permission over <code>admin:theDatabase</code>.</p>
</dd>
<dt class="hdlist1">Migrate a database</dt>
<dd>
<p><code>execute</code> permission over <code>admin:theDatabase</code>.</p>
</dd>
<dt class="hdlist1">Optimize a database</dt>
<dd>
<p><code>execute</code> permission over <code>admin:theDatabase</code>.</p>
</dd>
<dt class="hdlist1">List databases</dt>
<dd>
<p>Superusers can see all databases. Regular users can see only
databases over which they have a permission.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="permissions-2">Permissions</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Grant a permission</dt>
<dd>
<p><code>grant</code> permission over the permission object <strong>and</strong> user
must have the permission that it is trying to grant.</p>
</dd>
<dt class="hdlist1">Revoke a permission from a user or role over an object resource</dt>
<dd>
<p><code>revoke</code>
permission over the permission object <strong>and</strong> user must have the permission that
it is trying to revoke.</p>
</dd>
<dt class="hdlist1">List user permissions</dt>
<dd>
<p>User must be a superuser or user must be trying to get
its own info.</p>
</dd>
<dt class="hdlist1">List role permissions</dt>
<dd>
<p>User must be a superuser or user must have been assigned
the role.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-stardog-securely">Deploying Stardog Securely</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To ensure that Stardog&#8217;s RBAC access control implementation will be effective,
all non-administrator access to Stardog databases should occur over network
(i.e., non-native) database connections.<span class="footnote">[<a id="_footnoteref_19" class="footnote" href="#_footnote_19" title="View footnote.">19</a>]</span></p>
</div>
<div class="paragraph">
<p>To ensure the confidentiality of user authentication credentials when using
remote connections, the Stardog server should only accept connections that are
encrypted with SSL. This section describes how Stardog can be configured to use
SSL for data confidentiality and server authentication. It does not address
using SSL for client authentication.<span class="footnote">[<a id="_footnoteref_20" class="footnote" href="#_footnote_20" title="View footnote.">20</a>]</span></p>
</div>
<div class="sect2">
<h3 id="configuring-stardog-to-use-ssl">Configuring Stardog to use SSL</h3>
<div class="paragraph">
<p>StardogHTTP server includes native support for SSL. The SNARL
server (via <code>snarls://</code>) also supports SSL. Stardog may also be deployed
securely using two other methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTTPS reverse proxying; and</p>
</li>
<li>
<p>SSL-enabled application server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, in most cases, it&#8217;s just easier to use Stardog&#8217;s native SSL support.</p>
</div>
<div class="paragraph">
<p>To enable Stardog to optionally support SSL connections, just pass
<code>--enable-ssl</code> to the server start command.  If you want to require the server
to use SSL only, that is, to reject any non-SSL connections, then use
<code>--require-ssl</code>.</p>
</div>
<div class="paragraph">
<p>When starting from the command line, Stardog will use the standard Java
properties for specifying keystore information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javax.net.ssl.keyStorePassword</code>  (the password)</p>
</li>
<li>
<p><code>javax.net.ssl.keyStore</code> (location of the keystore)</p>
</li>
<li>
<p><code>javax.net.ssl.keyStoreType</code> (type of keystore, defaults to JKS)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These properties are checked first in <code>stardog.properties</code>; then in JVM args
passed in from the command line, e.g. <code>-Djavax.net.ssl.keyStorePassword=mypwd</code>. If
you&#8217;re creating a Server progammatically via <code>ServerBuilder</code>, you can specify
values for these properties using the appropriate <code>ServerOptions</code> when creating
the server.  These values will override anything specified in
<code>stardog.properties</code> or via normal JVM args.</p>
</div>
<div class="sect3">
<h4 id="https-reverse-proxying">HTTPS Reverse Proxying</h4>
<div class="paragraph">
<p>An HTTPS reverse proxy<span class="footnote">[<a id="_footnoteref_21" class="footnote" href="#_footnote_21" title="View footnote.">21</a>]</span>
may be used to secure Stardog client-server connections if the Stardog server is
run using the command-line tool or deployed as a servlet. In the following two
sections, we describe how to use Apache and lighttpd as HTTPS reverse
proxies for Stardog. These configurations can be used for new reverse proxy
deployments or can be modified to augment existing reverse proxies with SSL. Of
course other solutions may be used; these are illustrative of the general
technique and approach.</p>
</div>
<div class="paragraph">
<p>In this approach, the network connection between Stardog
clients and the proxy server is secured using SSL. But the connection
between the proxy server and Stardog server is <strong>insecure</strong>; thus, <strong>care
should be taken to ensure that proxy-Stardog connections only occur over
trusted networks.</strong></p>
</div>
<div class="paragraph">
<p>Note also that non-SSL connections to the Stardog
server from hosts other than the proxy server should be prohibited in
order to prevent network exposure of user credentials and data. Stardog&#8217;s
default HTTP server listens on all host interfaces and accepts all
connections. If it is used, then a host-based firewall is necessary to
prohibit connections from servers other than the proxy server.</p>
</div>
<div class="paragraph">
<p>HTTPS reverse proxying depends on having a certificate and private key on the
proxy server. A cheap and easy deployment strategy is to use a self-signed
certificate. Creating such a certificate is documented elsewhere and not
repeated here.<span class="footnote">[<a id="_footnoteref_22" class="footnote" href="#_footnote_22" title="View footnote.">22</a>]</span> Alternately, an SSL cert can be obtained from a commercial
certificate authority.</p>
</div>
<div class="sect4">
<h5 id="reverse-proxy-with-lighttpd">Reverse Proxy with lighttpd</h5>
<div class="paragraph">
<p><a href="http://lighttpd.net">lighttpd</a> can be configured to provide an SSL
layer for remote connections. The following lighttpd configuration file
is a complete example that lets clients use HTTPS connections with the
lighttpd proxy to communicate with a Stardog HTTP server listening on
port 12345 of the lighttpd host.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">server.port = 443
ssl.engine = &quot;enable&quot;
ssl.pemfile = &quot;server.pem&quot;
server.modules = ( &quot;mod_proxy&quot; )
proxy.server = ( &quot;&quot; =&gt; ( ( &quot;host&quot; =&gt; &quot;127.0.0.1&quot; , &quot;port&quot; =&gt; &quot;12345&quot; ) ) )
server.document-root = &quot;/dev/null&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This configuration directs lighttpd to use the certificate and private
key in server.pem for SSL connections.<span class="footnote">[<a id="_footnoteref_23" class="footnote" href="#_footnote_23" title="View footnote.">23</a>]</span></p>
</div>
</div>
<div class="sect4">
<h5 id="reverse-proxy-with-apache-2">Reverse Proxy with Apache 2</h5>
<div class="paragraph">
<p>Apache httpd can be configured to provide an SSL layer for remote
connections. The following partial configuration file<span class="footnote">[<a id="_footnoteref_24" class="footnote" href="#_footnote_24" title="View footnote.">24</a>]</span> allows clients to use
HTTPS connections with the Apache proxy, which communicates with a
Stardog HTTP server listening on port 12345 of the Apache host.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">SSLEngine                 On
SSLCertificateFile        server.pem
&lt;Directory /&gt; SSLRequireSSL &lt;/Directory&gt;
ProxyPass        /        http://127.0.0.1:12345/</code></pre>
</div>
</div>
<div class="paragraph">
<p>This configuration depends on the SSL certificate and private key being
located in the <code>server.pem</code> file in the Apache server root. It also
depends on <code>mod_ssl</code>, <code>mod_proxy</code>, and <code>mod_proxy_http</code> modules being
compiled into the httpd binary or loaded via directives elsewhere in the
configuration file.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ssl-enabled-app-server">SSL-Enabled App Server</h4>
<div class="paragraph">
<p>Stardog may also be deployed as a servlet in a container or app server that can
provide SSL support. For example, if Stardog is deployed into a default Resin
Server, then the following configuration would enable SSL on the server using the
certificate and private key stored in the Java KeyStore at
<code>server-keystore.jks</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;http</span> <span class="tok-na">address=</span><span class="tok-s">&quot;*&quot;</span> <span class="tok-na">port=</span><span class="tok-s">&quot;443&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;jsse-ssl&gt;</span>
           <span class="tok-nt">&lt;key-store-file&gt;</span>server-keystore.jks<span class="tok-nt">&lt;/key-store-file&gt;</span>
           <span class="tok-nt">&lt;password&gt;</span>********<span class="tok-nt">&lt;/password&gt;</span>
      <span class="tok-nt">&lt;/jsse-ssl&gt;</span>
<span class="tok-nt">&lt;/http&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Other Java app servers support SSL including GlassFish, Tomcat, and
JBoss. The configuration of SSL for each application server is
implementation specific; consult the relevant server’s
documentation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-stardog-client-to-use-ssl">Configuring Stardog Client to use SSL</h3>
<div class="paragraph">
<p>Stardog HTTP client supports SSL when the <code>https:</code> scheme is used in the
database connection string; likewise, it uses SSL for SNARL when the connection
string uses the <code>snarls:</code> scheme. For example, the following invocation of the
Stardog command line utility will initiate an SSL connection to a remote
database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog status -c https://stardog.example.org/sp2b_10k</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the client is unable to authenticate to the server, then the connection
will fail and an error message like the following will be generated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">Error during connect.  Cause was SSLPeerUnverifiedException: peer not authenticated</code></pre>
</div>
</div>
<div class="paragraph">
<p>The most common cause of this error is that the server presented a certificate
that was not issued by an authority that the client trusts. The Stardog HTTP
client driver uses standard Java security components to access a store of
trusted certificates. By default, it trusts a list of certificates installed
with the Java runtime environment, but it can be configured to use a custom
trust store.<span class="footnote">[<a id="_footnoteref_25" class="footnote" href="#_footnote_25" title="View footnote.">25</a>]</span></p>
</div>
<div class="paragraph">
<p>The client driver can be directed to use a specific Java KeyStore file as a
trust store by setting the <code>javax.net.ssl.trustStore</code> system property. To
address the authentication error above, that trust store should contain the
issuer of the server’s certificate. Standard Java tools can create such a file.
The following invocation of the <code>keytool</code> utility creates a new trust store
named <code>my-truststore.jks</code> and initializes it with the certificate in
<code>my-trusted-server.crt</code>. The tool will prompt for a passphrase to associate with
the trust store. This is not used to encrypt its contents, but can be used to
ensure its integrity.<span class="footnote">[<a id="_footnoteref_26" class="footnote" href="#_footnote_26" title="View footnote.">26</a>]</span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ keytool -importcert  -keystore my-truststore.jks -alias stardog-server -file my-trusted-server.crt</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following Stardog command line invocation uses the newly created
truststore.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ STARDOG_JAVA_ARGS=”-Djavax.net.ssl.trustStore=my-truststore.jks” stardog \
status -c https://stardog.example.org/sp2b_10k</code></pre>
</div>
</div>
<div class="paragraph">
<p>For custom Java applications that use the Stardog HTTP client driver,
the system property can be set programmatically or when the JVM is
initialized.</p>
</div>
<div class="paragraph">
<p>The most common deployment approach requiring a custom trust store is
when a self-signed certificate is presented by the Stardog server. For
connections to succeed, the Stardog client must trust the self-signed
certificate. To accomplish this with the examples given above, the
self-signed certificate should be in the <code>my-trusted-server.crt</code> file in
the keytool invocation.</p>
</div>
<div class="paragraph">
<p>A client may also fail to authenticate to the server if the hostname in the
Stardog database connection string does not match a name contained in the server
certificate.<span class="footnote">[<a id="_footnoteref_27" class="footnote" href="#_footnote_27" title="View footnote.">27</a>]</span></p>
</div>
<div class="paragraph">
<p>This will cause an error message like the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">Error during connect.  Cause was SSLException: hostname in certificate didn&#39;t match</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client driver does not support connecting when there&#8217;s a mismatch;
therefore, the only workarounds are to replace the server’s certificate or
modify the connection string to use an alias for the same server that
matches the certificate.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securing-stardog-on-linux">Securing Stardog on Linux</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes one approach to installing Stardog on Linux&#8212;&#8203;or
another Unix-like operating system&#8212;&#8203;with the goal of restricting
unauthorized access to Stardog data. The approach detailed below is not
the only effective way to secure a Stardog installation. Stardog
administrators should customize their installation for the requirements
of their environment.</p>
</div>
<div class="paragraph">
<p>In what follows, you&#8217;ll see snippets of shell code. For each snippet, <code>$</code>
represents the shell prompt and <code>\</code> is the line continuation character.
Some of the shell snippets make use of relative paths and are intended
to be run from within directory where Stardog release file was unzipped.
Many of the snippets will need to be run with elevated permissions.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Make sure that you know what you&#8217;re doing before you copy any of the
snippets of shell code or configuration syntax into a real Linux system. We
trust us and you probably should trust us; however: <strong>trust but verify</strong>.
<strong>You&#8217;ve been warned.</strong>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="creating-a-basic-stardog-environment">Creating A Basic Stardog Environment</h3>
<div class="paragraph">
<p>The Stardog library files should be copied from the distribution directory into
a permanent location in the host system&#8212;&#8203;we&#8217;re big fans of the
<code>/opt</code>--and--<code>/var</code> approach, but your needs may vary. The snippet below chooses
a common location and uses a versioning string to facilitate parallel installs
of different Stardog releases. An administrator may choose any location.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ export STARDOG_VERSION={replace_me_with_stardog_version}
$ export STARDOG_LIBDIR=/opt/stardog-${STARDOG_VERSION}/lib
$ install -d ${STARDOG_LIBDIR}
$ cp -r lib/* ${STARDOG_LIBDIR}
$ chown -R root:root ${STARDOG_LIBDIR}
$ chmod -R a+r ${STARDOG_LIBDIR}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Stardog command line tools should be copied from the distribution
directory into a location that places them into most users’ execution
<code>PATH</code>. Execution permissions to the tools are <strong>not</strong> limited because
access to the data directory will be <strong>strictly limited</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ install -c -m a=rx ./stardog /usr/bin/stardog
$ install -c -m a=rx ./stardog-admin /usr/sbin/stardog-admin</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Stardog data directory stores both user data and system
configuration data, <strong>including access control information</strong>. The location
selected for the data directory should be reliable, large enough to meet
data requirements, and secured from unauthorized access.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ export STARDOG_HOME=/var/db/stardog</code></pre>
</div>
</div>
<div class="paragraph">
<p>Access to the data directory is limited to the <code>stardog</code> group and the
only member of that group is the <code>stardog</code> user. Granting access
permissions to members of the <code>stardog</code> group is more flexible than
limiting access to a single user. For example, it may allow a Stardog
network server to run as a user other than <code>stardog</code>; or it may
facilitate other processes other than Stardog, i.e., data backup. The
snippet below creates that user and group.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ groupadd stardog
$ useradd -d ${STARDOG_HOME} -g stardog -s /sbin/nologin stardog</code></pre>
</div>
</div>
<div class="paragraph">
<p>This snippet creates the data directory and limits its access to the
newly created group.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ install -d -o stardog -g stardog -m ug=rwx,o=${STARDOG_HOME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if a Stardog server is used to allow network access to remote
Stardog clients, then the approach described here requires the server to
run as a user in the <code>stardog</code> group.</p>
</div>
<div class="paragraph">
<p>An administrator can accomplish this by running the server as the
<code>stardog</code> user or by adding the relevant user to the <code>stardog</code> group.
For example, the following snippet adding the <code>tomcat</code> user to the
<code>stardog</code> group may be needed in an environment where a Stardog HTTP
server is run as an application within Tomcat.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ usermod --add-to-group stardog tomcat</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course the ideal deployment of the Stardog server depends on the
particulars of the deployment environment, the preferences of the
administrator, and the anticipated user load. The group-based permission
approach provides flexibility to satisfy many alternatives.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in index.ad - include::programming.ad[]</p>
</div>
<hr>
<div class="paragraph">
<p>quote: When someone says "I want a programming language in which I need only say what I wish done," give him a lollipop.
layout: "default"
title: Programming with Java
shortTitle: Java
toc: true
---</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction-2">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the [Network Programming](../network/) chapter, we look at how to
interact with Stardog over a network via HTTP and SNARL protocol. In this
chapter we describe how to program Stardog from Java using SNARL
(<strong>Stardog Native API for the RDF Language</strong>), Sesame, and Jena. We prefer
SNARL to Sesame to Jena and recommend, all other things being equal,
them in that order.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re a Spring developer, you might want to read the [Programming with
Spring](../spring) chapter.</p>
</div>
<div class="paragraph">
<p>If you prefer a ORM-style approach, you might want to checkout [Empire](<a href="https://github.com/mhgrove/Empire" class="bare">https://github.com/mhgrove/Empire</a>), which is an implementation of [JPA](<a href="http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html" class="bare">http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html</a>) for RDF that works with Stardog.</p>
</div>
<div class="sect2">
<h3 id="examples-3">Examples</h3>
<div class="paragraph">
<p>The <strong>best</strong> way to learn to program Stardog with Java is to study the
examples:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[SNARL](<a href="https://gist.github.com/1045573" class="bare">https://gist.github.com/1045573</a>)</p>
</li>
<li>
<p>[Sesame bindings](<a href="https://gist.github.com/1045568" class="bare">https://gist.github.com/1045568</a>)</p>
</li>
<li>
<p>[Jena bindings](<a href="https://gist.github.com/1045572" class="bare">https://gist.github.com/1045572</a>)</p>
</li>
<li>
<p>[SNARL and OWL 2 reasoning](<a href="https://gist.github.com/1045578" class="bare">https://gist.github.com/1045578</a>)</p>
</li>
<li>
<p>[SNARL and Connection Pooling](<a href="https://gist.github.com/1070230" class="bare">https://gist.github.com/1070230</a>)</p>
</li>
<li>
<p>[SNARL and Searching](<a href="https://gist.github.com/1085116" class="bare">https://gist.github.com/1085116</a>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We offer some commentary on the interesting parts of these examples
below.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating-administering-databases">Creating &amp; Administering Databases</h3>
<div class="paragraph">
<p><code>AdminConnection</code> provides simple programmatic access to all administrative
functions available in Stardog.</p>
</div>
<div class="sect3">
<h4 id="creating-a-database-2">Creating a Database</h4>
<div class="paragraph">
<p>You can create a basic temporary memory database with Stardog with one
line of code:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1333782?file=CreateTempMemDb.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>You can also use the
[<code>memory</code>](../java/snarl/com/complexible/stardog/api/admin/AdminConnection.html#memory())
and
[<code>disk</code>](../java/snarl/com/complexible/stardog/api/admin/AdminConnection.html#disk())
functions to configure and create a database in any way you prefer.
These methods return
[<code>DatabaseBuilder</code>](../java/snarl/com/complexible/stardog/api/admin/DatabaseBuilder.html)
objects which you can use to configure the options of the database you&#8217;d
like to create. Finally, the
[<code>create</code>](../java/snarl/com/complexible/stardog/api/admin/DatabaseBuilder.html#create())
method takes the list of files to bulk load into the database when you
create it and returns a valid
[<code>ConnectionConfiguration</code>](../java/snarl/com/complexible/stardog/api/ConnectionConfiguration.html)
which can be used to create new
[<code>Connections</code>](../java/snarl/com/complexible/stardog/api/Connection.html)
to your database.</p>
</div>
<div class="paragraph">
<p>It is important to note that you <strong>must</strong> take
care to always log out of the server when you are done working with
<code>AdminConnection</code>.</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1333782?file=CreateMemSearchDb.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>This illustrates how to create a temporary memory database named 'test'
which supports full text search via [Waldo](../using).</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1333782?file=CreateDiskAndICV.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>This illustrates how to create a persistent disk database with ICV guard
mode enabled at the QL reasoning type. For more information on what the
available options for <code>set</code> are and what they mean, see the refer to the
[admin docs](../admin/), specifically the chapter on administing a
database.</p>
</div>
<div class="paragraph">
<p>Also note, Stardog database administration can be performed from the
[command line](../admin/).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-connection-string">Creating a Connection String</h3>
<div class="paragraph">
<p>As you can see, the
[<code>ConnectionConfiguration</code>](../java/snarl/com/complexible/stardog/api/ConnectionConfiguration.html)
(in
[<code>com.clarkparsia.stardog.api</code>](../java/snarl/com/complexible/stardog/api/package-summary.html)
package) class is where the initial action takes place:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1045578?file=L4044.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>The
[<code>to()</code>](../java/snarl/com/complexible/stardog/api/ConnectionConfiguration.html#to()
method takes a <code>Database Name</code> (as a string); and then
[<code>connect()</code>](../java/snarl/com/complexible/stardog/api/ConnectionConfiguration.html#connect()
actually connects to the database using all specified properties on the
configuration. This class and its constructor methods are used for <strong>all</strong> of Stardog&#8217;s
Java APIs: SNARL (native Stardog API), Sesame, Jena, as well as HTTP and
SNARL protocol. In the latter cases, you must also call
[<code>server</code>](../java/snarl/com/complexible/stardog/api/ConnectionConfiguration.html#server(java.lang.String)
and pass it a valid URL to the Stardog server using the HTTP or SNARL
protocols.</p>
</div>
<div class="paragraph">
<p>Without the call to <code>server()</code>, <code>ConnectionConfiguration</code> will attempt
to connect to a local, embedded version of the Stardog server. The
<code>Connection</code> still operates in the standard client-server mode, the only
difference is that the server is running in the <strong>same</strong> JVM as your
application.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: Whether using SNARL, Sesame, or Jena, most (perhaps all)
Stardog Java code will use <code>ConnectionConfiguration</code> to get a handle on
a Stardog database---whether embedded or remote---and, after getting that
handle, can use the API that makes the most sense for the use cases and
requirements at hand.</p>
</div>
<div class="paragraph">
<p>See the
[<code>ConnectionConfiguration</code>](../java/snarl/com/complexible/stardog/api/ConnectionConfiguration.html)
API docs or the [administration section](../admin/) for more information
on connection strings.</p>
</div>
</div>
<div class="sect2">
<h3 id="managing-security">Managing Security</h3>
<div class="paragraph">
<p>We discuss the security sytem in Stardog in the
[security](../security) chapter in greater detail.</p>
</div>
<div class="paragraph">
<p>When logged into the Stardog
[DBMS](../java/snarl/com/complexible/stardog/api/admin/AdminConnection.html)
you can access all security related features detailed in the security
section using any of the core security interfaces for [managing
users](../java/snarl/com/complexible/stardog/security/UserManager.html),
[roles](../java/snarl/com/complexible/stardog/security/RoleManager.html)
and
[permissions](../java/snarl/com/complexible/stardog/security/PermissionManager.html)</p>
</div>
<div class="paragraph">
<p>[Shiro](<a href="http://shiro.apache.org" class="bare">http://shiro.apache.org</a>) is used internally as the core of the
security framework, but unlike previous versions, you do not need to
configure Shiro directly. All management can be done via the
command-line or via the security API provided by <code>AdminConnection</code></p>
</div>
</div>
<div class="sect2">
<h3 id="using-snarl">Using SNARL</h3>
<div class="paragraph">
<p>In the examples (1) and (4) above, you can see how to use SNARL in Java
to interact with Stardog. The SNARL API will give the best performance
overall and is the native Stardog API. It uses some Sesame domain
classes but is otherwise a clean-sheet API and set of implementations.</p>
</div>
<div class="paragraph">
<p>The SNARL API is fluent with the aim of making code written for Stardog
easier to write and easier to maintain. Most objects are easily re-used
to make basic tasks with SNARL as simple as possible. We are always
interested in feedback on the API, so if you have suggestions or
comments, please send them to the mailing list.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a closer look at some of the interesting parts of SNARL.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-data">Adding Data</h3>
<div class="paragraph">
<p>&lt;gist&gt;1045573?file=SNARLAddData.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>You must always enclose changes to a database within a transaction begin
and commit (or rollback). Changes are kept locally until the transaction is committed,
or you try and perform a query operation to inspect the state of the
database within the transaction.</p>
</div>
<div class="paragraph">
<p>By default, RDF added will go into the default context unless specified
otherwise. As shown, you can use
[Adder](../java/snarl/com/complexible/stardog/api/Adder.html) directly
to add statements and graphs to the database, and if you want to add
data from a file or input stream, you use an
[<code>io()</code>](../java/snarl/com/complexible/stardog/api/IO.html), <code>format()</code>,
and <code>stream()</code> chain of method invocations.</p>
</div>
<div class="paragraph">
<p>See the [SNARL API](../java/snarl) Javadocs for all the gory details.</p>
</div>
</div>
<div class="sect2">
<h3 id="removing-data">Removing Data</h3>
<div class="paragraph">
<p>&lt;gist&gt;1045573?file=SNARLRemoveData.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at
[removing](../java/snarl/com/complexible/stardog/api/Remover.html) data
via SNARL; in the example above, you can see that file or stream-based
removal is symmetric to file or stream-based addition, i.e., calling
<code>remove()</code> in an <code>io()</code> chain with a file or stream call. See the SNARL
API docs for more details about finer-grained deletes, etc.</p>
</div>
</div>
<div class="sect2">
<h3 id="parameterized-sparql-queries">Parameterized SPARQL Queries</h3>
<div class="paragraph">
<p>&lt;gist&gt;1045573?file=SNARLQuery.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>SNARL also lets us parameterize SPARQL queries. We can make a <code>Query</code> object by passing a SPARQL query in the constructor. Simple. Obvious.</p>
</div>
<div class="paragraph">
<p>Next, let&#8217;s set a limit for the results: <code>aQuery.limit(10)</code>; or if we
want no limit, <code>aQuery.limit(Query.NO_LIMIT)</code>. By default, there is no
limit imposed on the query object; we&#8217;ll use whatever is specified in
the query. But you can use limit to override any limit specified in the
query, however specifying NO\_LIMIT will not remove a limit specified in
a query, it will only remove any limit override you&#8217;ve specified
restoring the state to the default of using whatever is in the query.</p>
</div>
<div class="paragraph">
<p>We can execute that query with <code>executeSelect()</code> and iterate over the
results. We can also rebind the "?s" variable easily:
<code>aQuery.parameter("s", aURI)</code>, which will work for all instances of "?s"
in any BGP in the query, and you can specify <code>null</code> to remove the
binding.</p>
</div>
<div class="paragraph">
<p>Query objects are re-useable, so you can create one from your original
query string and alter bindings, limit, and offset in any way you see
fit and re-execute the query to get the updated results.</p>
</div>
<div class="paragraph">
<p>We <strong>strongly</strong> recommend the use of SNARL&#8217;s parameterized queries over
concatenating strings together in order to build your SPARQL query. This
latter approach opens up the possibility for SPARQL injection attacks
unless you are very careful in scrubbing your input.</p>
</div>
</div>
<div class="sect2">
<h3 id="getter-interface">Getter Interface</h3>
<div class="paragraph">
<p>&lt;gist&gt;1045573?file=SNARLGetter.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>SNARL also supports some sugar for the classic statement-level
(<code>getSPO()</code> scars, anyone?) interactions. We ask in the first line of
the snippet above for an iterator over the Stardog connection, based on
<code>aURI</code> in the subject position. Then a while-loop, as one might
expect&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>You can also parameterize <code>Getter`s by binding different positions of
the `Getter</code> (which acts like a kind of RDF statement filter)---and then
iterating as usual. <strong>Note</strong> the <code>aIter.close()</code> which is important for Stardog databases to avoid memory leaks. If you need to materialize the iterator as a graph, you can do that by calling <code>graph()</code>.</p>
</div>
<div class="paragraph">
<p>The snippet doesn&#8217;t show <code>object()</code> or <code>context()</code> parameters on a
<code>Getter</code>, but those work, too, in the obvious way.</p>
</div>
</div>
<div class="sect2">
<h3 id="reasoning">Reasoning</h3>
<div class="paragraph">
<p>Stardog supports query-time [reasoning](/owl2) using a
query rewriting technique. In short, when reasoning is requested, a query
is automatically rewritten in <strong>n</strong> queries, which are then executed.. As
we discuss below in Connection Pooling, reasoning is enabled at the
<code>Connection</code> layer and then any queries executed over that connection
are executed with reasoning enabled; you don&#8217;t need to do anything up
front when you create your database if you want to use reasoning.</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1045578?file=CreateReasoningConn.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>In this code example, you can see that it&#8217;s trivial to enable reasoning
for a <code>Connection</code>: simply call <code>reasoning()</code> with the appropriate
constant (such as <code>ReasoningType.QL</code>) passed in. In addition to OWL2 QL,
EL, and RL, Stardog supports OWL2 DL <strong>schema</strong> queries. Stardog also
supports [SWRL](<a href="http://www.w3.org/Submission/SWRL/" class="bare">http://www.w3.org/Submission/SWRL/</a>).</p>
</div>
<div class="paragraph">
<p>For more information on how reasoning is supported in Stardog, check out
the [reasoning chapter](../owl2).</p>
</div>
</div>
<div class="sect2">
<h3 id="search">Search</h3>
<div class="paragraph">
<p>Stardog&#8217;s [search](../using) system can be used from Java in the following way. The fluent Java API for searching in SNARL looks a lot like the other
search interfaces: We create a <code>Searcher</code> instance with a fluent
constructor: <code>limit()</code> sets a limit on the results; <code>query()</code> contains
the search query, and <code>threshold</code> sets a minimum threshold for the
results.</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1085116?file=SearcherUsage.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>Then we call the <code>search()</code> method of our <code>Searcher</code> instance and
iterate over the results (i.e., <code>SearchResults</code>). Last, we can use
<code>offset()</code> on an existing <code>Searcher</code> to grab another page of results.</p>
</div>
<div class="paragraph">
<p>Stardog also supports performing searches over the full-text index
<strong>within</strong> a SPARQL query via the [LARQ SPARQL
syntax](<a href="http://jena.apache.org/documentation/larq/" class="bare">http://jena.apache.org/documentation/larq/</a>). This provides a
powerful mechanism for querying both your RDF index and full-text index
at the same time while also giving you a more performant option to the
SPARQL <code>regex</code> filter.</p>
</div>
</div>
<div class="sect2">
<h3 id="snarl-connection-views">SNARL Connection Views</h3>
<div class="paragraph">
<p>SNARL [<code>Connections</code>](../java/snarl/com/complexible/stardog/api/Connection.html#)
support obtaining a specified type of <code>Connection</code>. This provides the
ability to extend and enhance the features available to a Connection
while maintaining the standard, simple Connection API. The Connection
[<code>as</code>](../java/snarl/com/complexible/stardog/api/Connection.html#as())
method takes as a parameter the interface, which must be a sub-type of a
Connection, that you would like to use. <code>as</code> will either return the
Connection as the view you&#8217;ve specified, or it will throw an exception
if the view could not be obtained for some reason.</p>
</div>
<div class="paragraph">
<p>An example of obtaining an instance of a
[<code>SearchConnection</code>](../java/snarl/com/complexible/stardog/api/search/SearchConnection.html)
to use Stardog&#8217;s full-text search support would look like this:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1085116?file=SearchConnectionView.java&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="snarl-api-docs">SNARL API Docs</h3>
<div class="paragraph">
<p>Please see [SNARL API](../java/snarl/) docs for more information.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-sesame">Using Sesame</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog supports the [Sesame
API](<a href="http://www.openrdf.org/doc/sesame/users/ch07.html" class="bare">http://www.openrdf.org/doc/sesame/users/ch07.html</a>); thus, for the
most part, using Stardog and Sesame is not much different from using
Sesame with other RDF databases. There are, however, at least two
differences worth pointing out.</p>
</div>
<div class="sect2">
<h3 id="wrap-the-connection-with-code-stardogrepository-code">Wrap the connection with <code>StardogRepository</code></h3>
<div class="paragraph">
<p>&lt;gist&gt;1045568?file=init.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>As you can see from the code snippet, once you&#8217;ve created a
<code>ConnectionConfiguration</code> with all the details for connecting to a
Stardog database, you can wrap that in a <code>StardogRepository</code> which is a
Stardog specific implementation of the Sesame <code>Repository</code> interface. At
this point, you can use the resulting <code>Repository</code> like any other Sesame
<code>Repository</code> implementation. Each time you call
<code>Repository.getConnection</code>, your original <code>ConnectionConfiguration</code> will
be used to spawn a new connection to the database.</p>
</div>
</div>
<div class="sect2">
<h3 id="autocommit">Autocommit</h3>
<div class="paragraph">
<p>Stardog&#8217;s <code>RepositoryConnection</code> implementation will, by default, disable
<code>autoCommit</code> status. When enabled, every single statement added or
deleted via the <code>Connection</code> will incur the cost of a transaction, which
is too heavyweight for most use cases. You can enable
<code>autoCommit</code> and it will work as expected; but <strong>we recommend
leaving it disabled</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-jena">Using Jena</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog supports Jena via a Sesame-Jena bridge, so it&#8217;s got more
overhead than Sesame or SNARL. YMMV. There two points in the Jena
example to emphasize.</p>
</div>
<div class="sect2">
<h3 id="init-in-jena">Init in Jena</h3>
<div class="paragraph">
<p>&lt;gist&gt;1045572?file=InitJena.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>The initialization in Jena is a bit different from either SNARL or
Sesame; you can get a Jena <code>Model</code> instance by passing the <code>Connection</code>
instance (returned by <code>ConnectionConfiguration</code>) to the Stardog factory,
<code>SDJenaFactory</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="add-in-jena">Add in Jena</h3>
<div class="paragraph">
<p>&lt;gist&gt;1045572?file=AddToJena.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>Jena also wants to add data to a <code>Model</code> one statement at a time, which
can be less than ideal. To work around this restriction, we recommend
adding data to a <code>Model</code> in a single Stardog transaction, which is
initiated with <code>aModel.begin()</code>. Then to read data into the model, we
recommend using RDF/XML, since that triggers the <code>BulkUpdateHandler</code> in
Jena or grab a <code>BulkUpdateHandler</code> directly from the underlying Jena
graph.</p>
</div>
<div class="paragraph">
<p>The other options include using the Stardog
[command-line](../admin/#cli) client to bulk load a Stardog database or
to use SNARL for loading and then switch to Jena for other operations,
processing, query, etc.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client-server-stardog">Client-Server Stardog</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using Stardog from Java in either embedded or
client-server mode is <strong>very similar</strong>---the only visible difference
is the use of <code>url()</code> in a <code>ConnectionConfiguration</code>: when it&#8217;s present,
we&#8217;re in client-server model; else, we&#8217;re in embedded mode.</p>
</div>
<div class="paragraph">
<p>That&#8217;s a good and a bad thing: it&#8217;s good because the code is symmetric
and uniform. It&#8217;s bad because it can make reasoning about performance
difficult, i.e., it&#8217;s not entirely clear in client-server mode which
operations trigger (or don&#8217;t trigger) a round trip with the server and,
thus, which may be more expensive than they are in embedded mode.</p>
</div>
<div class="paragraph">
<p>In client-server mode, <strong>everything triggers a round trip</strong> with these
exceptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>closing a connection outside a transaction</p>
</li>
<li>
<p>any parameterizations (or other) of a query or getter instance</p>
</li>
<li>
<p>any database state mutations in a transaction that don&#8217;t need to be
immediately visible to the transaction; that is, changes are sent to
the server only when they are required, on commit, or on any query
or read operation that needs to have the accurate up-to-date state
of the data within the transaction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Stardog generally tries to be as lazy as possible; but in client-server
mode, since state is maintained on the client, there are fewer chances
to be lazy and more interactions with the server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="embedded-stardog">Embedded Stardog</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to the <code>url()</code> issue, the other key difference between
client-server and embedded Stardog is, of course, Java classpath woes.
As of Stardog &lt;t&gt;version&lt;/t&gt;, there is one classpath issue to watch out for: if you&#8217;re using Jena in embedded mode, then Jena&#8217;s libraries should
be on the classpath <strong>after</strong> Stardog&#8217;s, because of conflicting Lucene
JARs.</p>
</div>
<div class="paragraph">
<p>Please let us know if you find any other conflicts among JARs or other
classpath issues.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connection-pooling">Connection Pooling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog supports connection pools for SNARL <code>Connection</code> objects for
efficiency and programmer sanity. Here&#8217;s how they work:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1070230?file=JustCode.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>Per standard practice, we first initialize security and grab a
connection, in this case to the <code>testConnectionPool</code> database.</p>
</div>
<div class="paragraph">
<p>Then we setup a <code>ConnectionPoolConfig</code>, using its fluent API, which
establishes the parameters of the pool:</p>
</div>
<div class="paragraph">
<p>&lt;dl class="metro"&gt;
&lt;dt&gt;`using()<code>&lt;/dt&gt;
&lt;dd&gt;Sets which ConnectionConfiguration we want to pool; this is what is used to actually create the connections.&lt;/dd&gt;
&lt;dt&gt;`minPool()</code>, <code>maxPool()</code>&lt;/dt&gt;
&lt;dd&gt;Establishes min and max pooled objects; max pooled objects includes both leased and idled objects.&lt;/dd&gt;
&lt;dt&gt;`expiration()<code>&lt;/dt&gt;
&lt;dd&gt;Sets the idle life of objects; in this case, the pool reclaims objects idled for 1 hour.&lt;/dd&gt;
&lt;dt&gt;`blockAtCapacity()</code>&lt;/dt&gt;
&lt;dd&gt;Sets the max time (here: in minutes) that we&#8217;ll block waiting for an object when there aren&#8217;t any idle ones in the pool.&lt;/dd&gt;
&lt;/dl&gt;</p>
</div>
<div class="paragraph">
<p>Whew! Next we can <code>create()</code> the pool using this <code>ConnectionPoolConfig</code>
thing.</p>
</div>
<div class="paragraph">
<p>Finally, we call <code>obtain()</code> on the <code>ConnectionPool</code> when we need a new
one. And when we&#8217;re done with it, we return it to the pool so it can be
re-used, by calling <code>release()</code>. When we&#8217;re done, we <code>shutdown()</code> the
pool.</p>
</div>
<div class="paragraph">
<p>Since [reasoning](../owl2) in Stardog is enabled per <code>Connection</code>, you
can create two pools: one with reasoning connections, one with
non-reasoning connections; and then use the one you need to have
reasoning <strong>per query</strong>; never pay for more than you need.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-deprecation">API Deprecation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Methods and classes in SNARL API that are marked with the
<code>com.google.common.annotations.Beta</code> are subject to change or removal in
any release. We are using this annotation to denote new or experimental
features, the behavior or signature of which may change significantly
before it&#8217;s out of "beta".</p>
</div>
<div class="paragraph">
<p>We will otherwise attempt to keep the public APIs as stable as possible,
and methods will be marked with the standard <code>@Deprecated</code> annotation
for a least one full revision cycle before their removal from the SNARL
API. See [What 1.x Means](/compatibility) for more information about API stability.</p>
</div>
<div class="paragraph">
<p>Anything marked <code>@VisibleForTesting</code> is just that, visible as a
consequence of test case requirements; don&#8217;t write any important code
that depends on functions with this annotation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="support-for-maven">Support for Maven</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Like Maven generated archives, Stardog client jars now contain Maven
meta information (pom.xml and pom.properties files).  Dependency information
is included in the pom.xml files and the pom.properties files include some
basic properties. Located in the stardog distribution bin directory, the
script <code>mavenInstall</code> (<code>mavenInstall.bat</code> for Windows systems) will install
the stardog client jars into the local maven repository.</p>
</div>
<div class="paragraph">
<p>Note: Only client dependencies are provided, which does not include running
the server in the embedded mode.  For those use cases, the server jars must
still be included.</p>
</div>
<div class="paragraph">
<p>The following table summarizes the type of client to be built and its
associated stardog dependency.  The stardog dependency list below follows
the [Gradle](<a href="http://www.gradle.org" class="bare">http://www.gradle.org</a>) convention, and is of the form:
<code>groupId:artifactId:version</code>.  Versions 2.1 and higher supported.</p>
</div>
<div class="paragraph">
<p>Type of Client               | Stardog Dependency
:--------------------------  | :------------------
snarl client                 | com.complexible.stardog.protocols.snarl:client:version
http client                  | com.complexible.stardog.protocols.http:client:version
reasoning snarl client       | com.complexible.stardog.reasoning.snarl:client:version
reasoning http client        | com.complexible.stardog.reasoning.http:client:version
search snarl client          | com.complexible.stardog.search.snarl:client:version
search http client           | com.complexible.stardog.search.http:client:version
icv snarl client             | com.complexible.stardog.icv.snarl:client:version
icv http client              | com.complexible.stardog.icv.http:client:version
empire client                | com.complexible.stardog:empire:version
jena snarl client            | com.complexible.stardog:jena:version   com.complexible.stardog.protocols.snarl:client:version
jena http client             | com.complexible.stardog:jena:version   com.complexible.stardog.protocols.http:client:version
sesame snarl client          | com.complexible.stardog:sesame:version com.complexible.stardog.protocols.snarl:client:version
sesame http client           | com.complexible.stardog:sesame:version com.complexible.stardog.protocols.http:client:version</p>
</div>
<hr>
<div class="paragraph">
<p>quote: 'If you can imagine a society in which the computer-robot is the only menial, you can imagine anything.'
title: HTTP Programming
layout: default
related: ""
shortTitle: HTTP
toc: true
summary: 'This chapter describes how to interact with Stardog over a network using HTTP.'
---</p>
</div>
<div class="paragraph">
<p>In the [Programming with Java](../java/) chapter, we consider
interacting with Stardog programatically from a Java program. In this
chapter we consider interacting with Stardog over HTTP. In some use
cases or deployment scenarios, it may be necessary to interact with or
control Stardog remotely over an IP-based network. For those purposes,
Stardog supports [SPARQL 1.0 HTTP Protocol](<a href="http://www.w3.org/TR/rdf-sparql-protocol/" class="bare">http://www.w3.org/TR/rdf-sparql-protocol/</a>); the [SPARQL 1.1 Graph Store HTTP Protocol](<a href="http://www.w3.org/TR/sparql11-http-rdf-update/" class="bare">http://www.w3.org/TR/sparql11-http-rdf-update/</a>); the Stardog HTTP Protocol; and SNARL, an RPC-style protocol
based on [Google Protocol Buffers](<a href="http://code.google.com/apis/protocolbuffers/" class="bare">http://code.google.com/apis/protocolbuffers/</a>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sparql-protocol">SPARQL Protocol</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog supports the standard SPARQL Protocol HTTP bindings in a very
obvious way. Since the Stardog HTTP Protocol is a superset of SPARQL
Protocol, the latter is documented below alongside the former.</p>
</div>
<div class="paragraph">
<p>Stardog supports SPARQL 1.1&#8217;s Service Description format. See the
[spec](<a href="http://www.w3.org/TR/2013/REC-sparql11-service-description-20130321/" class="bare">http://www.w3.org/TR/2013/REC-sparql11-service-description-20130321/</a>)
if you want details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stardog-http-protocol">Stardog HTTP Protocol</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Stardog HTTP Protocol supports SPARQL Protocol 1.1 and additional resource representations and capabilities.</p>
</div>
<div class="paragraph">
<p>The Stardog HTTP API v4 is also available on Apiary:
[<a href="http://docs.stardog.apiary.io/" class="bare">http://docs.stardog.apiary.io/</a>](<a href="http://docs.stardog.apiary.io/" class="bare">http://docs.stardog.apiary.io/</a>).</p>
</div>
<div class="paragraph">
<p>The Stardog Linked Data API (aka "Annex") is also documented on Apiary: [<a href="http://docs.annex.apiary.io/" class="bare">http://docs.annex.apiary.io/</a>](<a href="http://docs.annex.apiary.io/" class="bare">http://docs.annex.apiary.io/</a>).</p>
</div>
<div class="sect2">
<h3 id="generating-urls">Generating URLs</h3>
<div class="paragraph">
<p>If you are running the HTTP server at the following URL</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">http://localhost:12345/</code></pre>
</div>
</div>
<div class="paragraph">
<p>To form the URI of a particular Stardog Database, the Database Short
Name is the first URL path segment appended to the deployment URI. For
example, for the Database called <code>cytwombly</code>, deployed in the above
example HTTP server, the Database Network Name might be</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">http://localhost:12345/cytwombly</code></pre>
</div>
</div>
<div class="paragraph">
<p>All the resources related to this database are identified by URL path
segments relative to the Database Network Name; hence:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">http://localhost:12345/cytwombly/size</code></pre>
</div>
</div>
<div class="paragraph">
<p>In what follows, we use [URI Template](<a href="http://code.google.com/p/uri-templates/" class="bare">http://code.google.com/p/uri-templates/</a>) notation to parameterize the actual request URLs, thus: <code>/{db}/size</code>.</p>
</div>
<div class="paragraph">
<p>We also abuse notation to show the permissible HTTP request types and
default MIME types: <code>REQ | REQ /resource/identifier → mime_type | mime_type</code>.</p>
</div>
<div class="paragraph">
<p>In a few cases, we use <code>void</code> as short hand for the case where there is
a response code but the response body may be empty.</p>
</div>
</div>
<div class="sect2">
<h3 id="http-headers-code-content-type-code-code-accept-code">HTTP Headers: <code>Content-Type</code> &amp; <code>Accept</code></h3>
<div class="paragraph">
<p>All HTTP requests that are mutative (add or remove) must include a valid
<code>Content-Type</code> header set to the MIME type of the request body, where
"valid" is a valid MIME type for N-Triples, Trig, Trix, Turtle, NQuads,
JSON-LD, or RDF/XML:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RDF/XML:   <code>application/rdf+xml</code></p>
</li>
<li>
<p>Turtle:   <code>application/x-turtle</code> or <code>text/turtle</code></p>
</li>
<li>
<p>N-Triples:   <code>text/plain</code></p>
</li>
<li>
<p>TriG:   <code>application/x-trig</code></p>
</li>
<li>
<p>TriX:   <code>application/trix</code></p>
</li>
<li>
<p>NQuads:   <code>text/x-nquads</code></p>
</li>
<li>
<p>JSON-LD:   <code>application/ld+json</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SPARQL <code>CONSTRUCT</code> queries must also include a <code>Accept</code> header set to one of these RDF serialization types.</p>
</div>
<div class="paragraph">
<p>When issuing a <code>SELECT</code> query the <code>Accept</code> header should be set to one
of the valid MIME types for <code>SELECT</code> results:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SPARQL XML Results Format:   <code>application/sparql-results+xml</code></p>
</li>
<li>
<p>SPARQL JSON Results Format:   <code>application/sparql-results+json</code></p>
</li>
<li>
<p>SPARQL Boolean Results:   <code>text/boolean</code></p>
</li>
<li>
<p>SPARQL Binary Results:   <code>application/x-binary-rdf-results-table</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="response-codes">Response Codes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog uses the following HTTP response codes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>200</code>:   Operation has succeeded.</p>
</li>
<li>
<p><code>202</code>:   Operation was recieved successfully and will be processed shortly.</p>
</li>
<li>
<p><code>400</code>:   Indicates parse errors or that the transaction identifier specified for an operation is invalid or does not correspond to a known transaction.</p>
</li>
<li>
<p><code>401</code>:   Request is unauthorized.</p>
</li>
<li>
<p><code>403</code>:   User attempting to perform the operation does not exist, their username or password is invalid, or they do not have the proper credentials to perform the action.</p>
</li>
<li>
<p><code>404</code>:   A resource involved in the request&#8212;&#8203;for example the database or transaction&#8212;&#8203;does not exist.</p>
</li>
<li>
<p><code>409</code>:   A conflict for some database operations; for example, creating a database that already exists.</p>
</li>
<li>
<p><code>500</code>:   A unspecified failure in some internal operation&#8230;&#8203;Call yr office, Senator!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are also Stardog-specific error codes in the <code>SD-Error-Code</code>
header in the response from the server. These can be used to further
clarify the reason for the failure on the server, especially in cases
where it could be ambiguous. For example, if you received a <code>404</code> from
the server trying to commit a transaction denoted by the path
<code>/myDb/transaction/commit/293845klf9f934</code>&#8230;&#8203;it&#8217;s probably not clear what is missing: it&#8217;s either the transaction or the database. In this case, the value of
the <code>SD-Error-Code</code> header will clarify.</p>
</div>
<div class="paragraph">
<p>The enumeration of <code>SD-Error-Code</code> values and their meanings are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>0</code>: Authentication error</p>
</li>
<li>
<p><code>1</code>: Authorization error</p>
</li>
<li>
<p><code>2</code>: Query evaluation error</p>
</li>
<li>
<p><code>3</code>: Query contained parse errors</p>
</li>
<li>
<p><code>4</code>: Query is unknown</p>
</li>
<li>
<p><code>5</code>: Transaction not found</p>
</li>
<li>
<p><code>6</code>: Database not found</p>
</li>
<li>
<p><code>7</code>: Database already exists</p>
</li>
<li>
<p><code>8</code>: Database name is invalid</p>
</li>
<li>
<p><code>9</code>: Resource (user, role, etc) already exists</p>
</li>
<li>
<p><code>10</code>: Invalid connection parameter(s)</p>
</li>
<li>
<p><code>11</code>: Invalid database state for the request</p>
</li>
<li>
<p><code>12</code>: Resource in use</p>
</li>
<li>
<p><code>13</code>: Resource not found</p>
</li>
<li>
<p><code>14</code>: Operation not supported by the server</p>
</li>
<li>
<p><code>15</code>: Password specified in the request was invalid</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In cases of error, the message body of the result will include any error
information provided by the server to indicate the cause of the error.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stardog-resources">Stardog Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To interact with Stardog over HTTP, use the following resource
representations, HTTP response codes, and resource identifiers.</p>
</div>
<div class="sect2">
<h3 id="a-stardog-database">A Stardog Database</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /{db} → void</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a representation of the database. As of Stardog &lt;t&gt;version&lt;/t&gt;, this is
merely a placeholder; in a later release, this resource will serve the
web console where the database can be interacted with in a browser.</p>
</div>
</div>
<div class="sect2">
<h3 id="database-size">Database Size</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /{db}/size → text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the number of RDF triples in the database.</p>
</div>
</div>
<div class="sect2">
<h3 id="query-evaluation">Query Evaluation</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET | POST /{db}/query</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SPARQL endpoint for the database. The valid Accept types are listed
above in the <code>HTTP Headers</code> section.</p>
</div>
<div class="paragraph">
<p>To issue SPARQL queries with reasoning over HTTP, see the [Using Reasoning](<a href="http://docs.stardog.com/owl2/#reasoning" class="bare">http://docs.stardog.com/owl2/#reasoning</a>) section of the [Reasoning](<a href="http://docs.stardog.com/owl2/" class="bare">http://docs.stardog.com/owl2/</a>) chapter.</p>
</div>
</div>
<div class="sect2">
<h3 id="sparql-update-2">SPARQL update</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstring">GET | POST /{db}/update</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SPARQL endpoint for updating the database with SPARQL Update. The valid Accept types are
<code>application/sparql-update</code> <code>or application/x-www-form-urlencoded</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="query-plan">Query Plan</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET | POST /{db}/explain → text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the explanation for the execution of a query, i.e., a query
plan. All the same arguments as for Query Evaluation are legal here; but
the only MIME type for the Query Plan resource is <code>text/plain</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="transaction-begin">Transaction Begin</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/transaction/begin → text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a transaction identifier resource as <code>text/plain</code>, which is
likely to be deprecated in a future release in favor of a hypertext
format. <code>POST</code> to begin a transaction accepts neither body nor arguments.</p>
</div>
<div class="sect3">
<h4 id="transaction-security-considerations-t-secnote-t">Transaction Security Considerations &lt;t&gt;secnote&lt;/t&gt;</h4>
<div class="paragraph">
<p>Stardog&#8217;s implementation of transactions with HTTP is
vulnerable to man-in-the-middle attacks, which could be used to violate
Stardog&#8217;s isolation guarantee (among other nasty side effects). Stardog&#8217;s transaction identifiers are 64-bit GUIDs and, thus, pretty hard to <strong>guess</strong>; but if you can grab a response in-flight, you can steal the transaction identifier if basic access auth or RFC 2069 digest auth is in use. <strong>You&#8217;ve been warned.</strong></p>
</div>
<div class="paragraph">
<p>In a future release, Stardog will use [RFC 2617 HTTP
Digest Authentication](<a href="http://tools.ietf.org/html/rfc2617" class="bare">http://tools.ietf.org/html/rfc2617</a>), which is
less vulnerable to various attacks, and will never ask a client to use a
different authentication type, which should lessen the likelihood of
MitM attacks for properly restricted Stardog clients&#8212;&#8203;that is, a
Stardog client that treats any request by a proxy server or origin
server (i.e., Stardog) to use basic access auth or RFC 2069 digest auth
as a MitM attack. See [RFC 2617](<a href="http://tools.ietf.org/html/rfc2617" class="bare">http://tools.ietf.org/html/rfc2617</a>) for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="transaction-commit">Transaction Commit</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/transaction/commit/{txId} → void | text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a representation of the committed transaction; <code>200</code> means the
commit was successful. Otherwise a <code>500</code> error indicates the commit
failed and the text returned in the result is the failure message.</p>
</div>
<div class="paragraph">
<p>As you might expect, failed commits exit cleanly, rolling back any
changes that were made to the database.</p>
</div>
</div>
<div class="sect2">
<h3 id="transaction-rollback">Transaction Rollback</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/transaction/rollback/{txId} → void | text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a representation of the transaction after it&#8217;s been rolled back.
<code>200</code> means the rollback was successful, otherwise <code>500</code> indicates the
rollback failed and the text returned in the result is the failure
message.</p>
</div>
</div>
<div class="sect2">
<h3 id="querying-transactionally">Querying (Transactionally)</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET | POST /{db}/{txId}/query</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a representation of a query executed within the <code>txId</code>
transaction. Queries within transactions will be slower as extra
processing is required to make the changes visible to the query. Again,
the valid Accept types are listed above in the <code>HTTP Headers</code> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-data-transactionally">Adding Data (Transactionally)</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/{txId}/add → void | text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a representation of data added to the database of the specified
transaction. Accepts an optional parameter, <code>graph-uri</code>, which specifies
the named graph the data should be added to. If a named graph is not
specified, the data is added to the default (i.e., unnamed) context. The
response codes are <code>200</code> for success and <code>500</code> for failure.</p>
</div>
</div>
<div class="sect2">
<h3 id="deleting-data-transactionally">Deleting Data (Transactionally)</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/{txId}/remove → void | text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a representation of data removed from the database within the
specified transaction. Also accepts <code>graph-uri</code> with the analogous
meaning as above (Add in Transaction); response codes are the same as
with Add in Transaction.</p>
</div>
</div>
<div class="sect2">
<h3 id="clear-database">Clear Database</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/{txId}/clear → void | text/plain</code></pre>
</div>
</div>
<div class="paragraph">
<p>Removes all data from the database within the context of the
transaction. <code>200</code> indicates success; <code>500</code> indicates an error. Also
takes an optional parameter, <code>graph-uri</code>, which removes data from a
named graph. To clear only the default graph, pass <code>DEFAULT</code> as the value of <code>graph-uri</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="explanation-of-inferences">Explanation of Inferences</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/reasoning/explain → RDF
POST /{db}/reasoning/{txId}/explain → RDF</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the explanation of the axiom which is in the body of the <code>POST</code>
request. The request takes the axioms in any supported RDF format and
returns the explanation for why that axiom was inferred as Turtle.</p>
</div>
</div>
<div class="sect2">
<h3 id="explanation-of-inconsistency">Explanation of Inconsistency</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET | POST /{db}/reasoning/explain/inconsistency → RDF</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the database is logically inconsistent, this returns an explanation for the
inconsistency.</p>
</div>
</div>
<div class="sect2">
<h3 id="consistency-2">Consistency</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET | POST /{db}/reasoning/consistency → text/boolean</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns whether or not the database is consistent w.r.t to the TBox.</p>
</div>
</div>
<div class="sect2">
<h3 id="listing-integrity-constraints">Listing Integrity Constraints</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /{db}/icv → RDF</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns the integrity constraints for the specified database serialized in any supported RDF format.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-integrity-constraints">Adding Integrity Constraints</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/icv/add</code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepts a set of valid Integrity constraints serialized in any RDF
format supported by Stardog and adds them to the database in an atomic
action. 200 return code indicates the constraints were added
successfully, 500 indicates that the constraints were not valid or
unable to be added.</p>
</div>
</div>
<div class="sect2">
<h3 id="removing-integrity-constraints">Removing Integrity Constraints</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/icv/remove</code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepts a set of valid Integrity constraints serialized in any RDF
format supported by Stardog and removes them from the database in a
single atomic action. <code>200</code> indicates the constraints were successfully
remove; <code>500</code> indicates an error.</p>
</div>
</div>
<div class="sect2">
<h3 id="clearing-integrity-constraints">Clearing Integrity Constraints</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/icv/clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>Drops <strong>all</strong> integrity constraints for a database. <code>200</code> indicates all
constraints were successfully dropped; <code>500</code> indicates an error.</p>
</div>
</div>
<div class="sect2">
<h3 id="converting-constraints-to-sparql-queries">Converting Constraints to SPARQL Queries</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    POST /{db}/icv/convert</code></pre>
</div>
</div>
<div class="paragraph">
<p>The body of the <code>POST</code> is a single integrity constraint, serialized in
any supported RDF format, with <code>Content-type</code> set appropriately. Returns
either a <code>text/plain</code> result containing a single SPARQL query; or it
returns <code>400</code> if more than one constraint was included in the input.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="admin-resources">Admin Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To administer Stardog over HTTP, use the following resource
representations, HTTP response codes, and resource identifiers.</p>
</div>
<div class="sect2">
<h3 id="list-databases">List databases</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /admin/databases → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Lists all the databases available.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;databases&quot;</span> <span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;testdb&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;exampledb&quot;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="copy-a-database">Copy a database</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">PUT /admin/databases/{db}/copy?to={db_copy}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Copies a database <code>db</code> to another specified <code>db_copy</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-a-new-database">Create a new database</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    POST /admin/databases</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creates a new database; expects a multipart request with a JSON
specifying database name, options and filenames followed by (optional)
file contents as a multipart <code>POST</code> request.</p>
</div>
<div class="paragraph">
<p>Expected input (<code>application/json</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;dbname&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;testDb&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;options&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
        <span class="tok-s2">&quot;icv.active.graphs&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;http://graph, http://another&quot;</span><span class="tok-p">,</span>
        <span class="tok-s2">&quot;search.enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
        <span class="tok-p">...</span>
      <span class="tok-p">},</span>
      <span class="tok-s2">&quot;files&quot;</span> <span class="tok-o">:</span> <span class="tok-p">[{</span> <span class="tok-s2">&quot;filename&quot;</span><span class="tok-o">:</span><span class="tok-s2">&quot;fileX.ttl&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;context&quot;</span><span class="tok-o">:</span><span class="tok-s2">&quot;some:context&quot;</span> <span class="tok-p">},</span> <span class="tok-p">...]</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="drop-an-existing-database">Drop an existing database</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    DELETE /admin/databases/{db}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Drops an existing database <code>db</code> and all the information that it
contains. Goodbye Callahan!</p>
</div>
</div>
<div class="sect2">
<h3 id="migrate-an-existing-database">Migrate an existing database</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    PUT /admin/databases/{db}/migrate</code></pre>
</div>
</div>
<div class="paragraph">
<p>Migrates the existing content of a legacy database to new format.</p>
</div>
</div>
<div class="sect2">
<h3 id="optimize-an-existing-database">Optimize an existing database</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    PUT /admin/databases/{db}/optimize</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optimize an existing database.</p>
</div>
</div>
<div class="sect2">
<h3 id="sets-an-existing-database-online">Sets an existing database online.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    PUT /admin/databases/{db}/online</code></pre>
</div>
</div>
<div class="paragraph">
<p>Request message to set an existing database {db} online.</p>
</div>
</div>
<div class="sect2">
<h3 id="sets-an-existing-database-offline">Sets an existing database offline.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    PUT /admin/databases/{db}/offline</code></pre>
</div>
</div>
<div class="paragraph">
<p>Request message to set an existing database offline; receives optionally
a JSON input to specify a timeout for the offline operation. When not
specified, defaults to 3 minutes as the timeout; the timeout should be
provided in <strong>milliseconds</strong>. The timeout is the amount of time the
database will wait for existing connections to complete before going
offline. This will allow open transaction to commit/rollback, open
queries to complete, etc. After the timeout has expired, all remaining
open connections are closed and the database goes offline.</p>
</div>
<div class="paragraph">
<p>Optional input (<code>application/json</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;timeout&quot;</span> <span class="tok-o">:</span> <span class="tok-o">&lt;</span><span class="tok-nx">timeout_in_ms</span><span class="tok-o">&gt;</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="set-option-values-to-an-existing-database">Set option values to an existing database.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    POST /admin/databases/{kb}/options</code></pre>
</div>
</div>
<div class="paragraph">
<p>Set options in the database passed through a JSON object specification,
i.e. JSON Request for option values. Database options can be found
[here](../admin/#admin-db).</p>
</div>
<div class="paragraph">
<p>Expected input (<code>application/json</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;database.name&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;DB_NAME&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;icv.enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-kc">true</span> <span class="tok-o">|</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;search.enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-kc">true</span> <span class="tok-o">|</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
      <span class="tok-p">...</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="get-option-values-of-an-existing-database">Get option values of an existing database.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">PUT /admin/databases/{kb}/options → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves a set of options passed via a JSON object.
The JSON input has empty values for each key, but will be filled with
the option values in the database in the output.</p>
</div>
<div class="paragraph">
<p>Expected input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;database.name&quot;</span> <span class="tok-o">:</span> <span class="tok-p">...,</span>
      <span class="tok-s2">&quot;icv.enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-p">...,</span>
      <span class="tok-s2">&quot;search.enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-p">...,</span>
      <span class="tok-p">...</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;database.name&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;testdb&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;icv.enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;search.enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-p">...</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="add-a-new-user-to-the-system">Add a new user to the system.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    POST /admin/users</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adds a new user to the system; allows a configuration option for
superuser as a JSON object. Superuser configuration is set as default to
false. The password <strong>must</strong> be provided for the user.</p>
</div>
<div class="paragraph">
<p>Expected input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;username&quot;</span>  <span class="tok-o">:</span> <span class="tok-s2">&quot;bob&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;superuser&quot;</span> <span class="tok-o">:</span> <span class="tok-kc">true</span> <span class="tok-o">|</span> <span class="tok-kc">false</span>
      <span class="tok-s2">&quot;password&quot;</span>  <span class="tok-o">:</span> <span class="tok-s2">&quot;passwd&quot;</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="change-user-password">Change user password.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    PUT /admin/users/{user}/pwd</code></pre>
</div>
</div>
<div class="paragraph">
<p>Changes <a href="http://asciidoctor.org/docs/user-manual" class="bare">http://asciidoctor.org/docs/user-manual</a> password in the system. Receives input of new password as
a JSON Object.</p>
</div>
<div class="paragraph">
<p>Expected input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;password&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;xxxxx&quot;</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="check-if-user-is-enabled">Check if user is enabled.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    GET /admin/users/{user}/enabled → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verifies if user is enabled in the system.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;enabled&quot;</span><span class="tok-o">:</span> <span class="tok-kc">true</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="check-if-user-is-superuser">Check if user is superuser.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    GET /admin/users/{user}/superuser → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verifies if the user is a superuser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;superuser&quot;</span><span class="tok-o">:</span> <span class="tok-kc">true</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-users-2">Listing users.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    GET /admin/users → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves a list of users.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;users&quot;</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;anonymous&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;admin&quot;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-user-roles">Listing user roles.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    GET /admin/users/{user}/roles → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves the list of the roles assigned to user.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;roles&quot;</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;reader&quot;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deleting-users">Deleting users.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    DELETE /admin/users/{user}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Removes a user from the system.</p>
</div>
</div>
<div class="sect2">
<h3 id="enabling-users">Enabling users.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    PUT /admin/users/{user}/enabled</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enables a user in the system; expects a JSON object in the following
format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;enabled&quot;</span> <span class="tok-o">:</span> <span class="tok-kc">true</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-user-roles">Setting user roles.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    PUT /admin/users/{user}/roles</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sets roles for a given user; expects a JSON object specifying the roles
for the user in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;roles&quot;</span> <span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;reader&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;secTestDb-full&quot;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-new-roles">Adding new roles.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">    POST /admin/roles</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adds the new role to the system.</p>
</div>
<div class="paragraph">
<p>Expected input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"> <span class="tok-p">{</span>
   <span class="tok-s2">&quot;rolename&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;&quot;</span>
 <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-roles-2">Listing roles.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /admin/roles → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves the list of roles registered in the system.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span class="tok-p">{</span>
   <span class="tok-s2">&quot;roles&quot;</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;reader&quot;</span><span class="tok-p">]</span>
 <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-users-with-a-specified-role">Listing users with a specified role.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /admin/roles/{role}/users → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves users that have the role assigned.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span class="tok-p">{</span>
   <span class="tok-s2">&quot;users&quot;</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;anonymous&quot;</span><span class="tok-p">]</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deleting-roles">Deleting roles.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">DELETE /admin/roles/{role}?force={force}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Deletes an existing role from the system; the force parameter is a
boolean flag which indicates if the delete call for the role must be
forced.</p>
</div>
</div>
<div class="sect2">
<h3 id="assigning-permissions-to-roles">Assigning permissions to roles.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">PUT /admin/permissions/role/{role}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creates a new permission for a given role over a specified resource;
expects input JSON Object in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span class="tok-p">{</span>
   <span class="tok-s2">&quot;action&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;read&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;write&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;create&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;delete&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;revoke&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;execute&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;grant&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
   <span class="tok-s2">&quot;resource_type&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;user&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;role&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;db&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;named-graph&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;metadata&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;admin&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;icv-constraints&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
   <span class="tok-s2">&quot;resource&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;&quot;</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="assigning-permissions-to-users">Assigning permissions to users.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">PUT /admin/permissions/user/{user}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creates a new permission for a given user over a specified resource;
expects input JSON Object in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span class="tok-p">{</span>
   <span class="tok-s2">&quot;action&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;read&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;write&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;create&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;delete&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;revoke&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;execute&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;grant&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
   <span class="tok-s2">&quot;resource_type&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;user&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;role&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;db&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;named-graph&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;metadata&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;admin&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;icv-constraints&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
   <span class="tok-s2">&quot;resource&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;&quot;</span>
 <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deleting-permissions-from-roles">Deleting permissions from roles.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /admin/permissions/role/{role}/delete</code></pre>
</div>
</div>
<div class="paragraph">
<p>Deletes a permission for a given role over a specified resource; expects
input JSON Object in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"> <span class="tok-p">{</span>
    <span class="tok-s2">&quot;action&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;read&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;write&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;create&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;delete&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;revoke&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;execute&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;grant&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;resource_type&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;user&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;role&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;db&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;named-graph&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;metadata&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;admin&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;icv-constraints&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
    <span class="tok-s2">&quot;resource&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;&quot;</span>
 <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deleting-permissions-from-users">Deleting permissions from users.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /admin/permissions/user/{user}/delete</code></pre>
</div>
</div>
<div class="paragraph">
<p>Deletes a permission for a given user over a specified resource; expects
input JSON Object in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span class="tok-p">{</span>
   <span class="tok-s2">&quot;action&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;read&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;write&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;create&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;delete&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;revoke&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;execute&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;grant&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
   <span class="tok-s2">&quot;resource_type&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;user&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;role&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;db&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;named-graph&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;metadata&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;admin&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;icv-constraints&quot;</span> <span class="tok-o">|</span> <span class="tok-s2">&quot;*&quot;</span><span class="tok-p">,</span>
   <span class="tok-s2">&quot;resource&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;&quot;</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-role-permissions">Listing role permissions.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /admin/permissions/role/{role} → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves permissions assigned to the role.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"> <span class="tok-p">{</span>
   <span class="tok-s2">&quot;permissions&quot;</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;stardog:read:*&quot;</span><span class="tok-p">]</span>
 <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-user-permissions">Listing user permissions.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /admin/permissions/user/{user} → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves permissions assigned to the user.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"> <span class="tok-p">{</span>
   <span class="tok-s2">&quot;permissions&quot;</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;stardog:read:*&quot;</span><span class="tok-p">]</span>
 <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="listing-user-effective-permissions">Listing user effective permissions.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET /admin/permissions/effective/user/{user} → application/json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retrieves effective permissions assigned to the user.</p>
</div>
<div class="paragraph">
<p>Output JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript">    <span class="tok-p">{</span>
      <span class="tok-s2">&quot;permissions&quot;</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;stardog:*&quot;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shutdown-server">Shutdown server.</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /admin/shutdown</code></pre>
</div>
</div>
<div class="paragraph">
<p>Shuts down the Stardog Server. If successful, returns a <code>202</code> to
indicate that the request was recieved and that the server will be shut
down shortly.</p>
</div>
</div>
<div class="sect2">
<h3 id="query-version-metadata">Query Version Metadata</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">GET | POST /{db}/vcs/query</code></pre>
</div>
</div>
<div class="paragraph">
<p>Issue a query over the version history metadata using SPARQL.  Method has the same arguments and outputs as the normal query method of a database.</p>
</div>
</div>
<div class="sect2">
<h3 id="versioned-commit">Versioned Commit</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/vcs/{tid}/commit_msg</code></pre>
</div>
</div>
<div class="paragraph">
<p>Input example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>This is the commit message</code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepts a commit message in the body of the request and performs a VCS commit of the specified transaction</p>
</div>
</div>
<div class="sect2">
<h3 id="create-tag">Create Tag</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/vcs/tags/create</code></pre>
</div>
</div>
<div class="paragraph">
<p>Input example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="csv">&quot;f09c0e02350627480839da4661b8e9cbd70f6372&quot;, &quot;This is the commit message&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a tag from the given revision id with the specified commit message.</p>
</div>
</div>
<div class="sect2">
<h3 id="delete-tag">Delete Tag</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/vcs/tags/delete</code></pre>
</div>
</div>
<div class="paragraph">
<p>Input example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="csv">&quot;f09c0e02350627480839da4661b8e9cbd70f6372&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Delete the tag with the given revision.</p>
</div>
</div>
<div class="sect2">
<h3 id="revert-to-tag">Revert to Tag</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="httpstardog">POST /{db}/vcs/revert</code></pre>
</div>
</div>
<div class="paragraph">
<p>Input example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="csv">&quot;f09c0e02350627480839da4661b8e9cbd70f6372&quot;, &quot;893220fba7910792084dd85207db94292886c4d7&quot;, &quot;This is the revert message&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Perform a revert of a revision to the specified revision with the given commit message.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in index.ad - include::js.ad[]</p>
</div>
</div>
</div>
</div>
<h1 id="owl-rule-reasoning" class="sect0">OWL &amp; Rule Reasoning</h1>
<div class="openblock partintro">
<div class="content">
In this chapter we describe how to use Stardog&#8217;s reasoning capabilities; we
address some common problems and known issues. We also describe Stardog&#8217;s
approach to query answering with reasoning in some detail, as well as a set of
guidelines that contribute to efficient query answering with reasoning. If you
are not familiar with the terminology, you can peruse the section on
terminology.
</div>
</div>
<div class="sect1">
<h2 id="introduction-3">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The semantics of Stardog&#8217;s reasoning is based in part on the
<a href="http://www.w3.org/TR/2010/WD-sparql11-entailment-20100126/#id45013">OWL 2
Direct Semantics Entailment Regime</a>. However, the <strong>implementation</strong> of
Stardog&#8217;s reasoning system is worth understanding as well. <strong><em>Stardog
performs reasoning in a lazy and late-binding fashion: it does not
materialize inferences; but, rather, reasoning is performed at query
time according to a user-specified "reasoning level".</em></strong>  This approach
allows for maximum flexibility<span class="footnote">[<a id="_footnoteref_28" class="footnote" href="#_footnote_28" title="View footnote.">28</a>]</span>
while maintaining excellent performance and scalability.</p>
</div>
<div class="sect2">
<h3 id="reasoning-levels">Reasoning Levels</h3>
<div class="paragraph">
<p>Stardog supports several reasoning levels; the reasoning level determines the
kinds of inference rules or axioms that are to be considered during query
evaluation:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>NONE</code> </dt>
<dd>
<p>No axioms or rules are considered; no reasoning is performed.</p>
</dd>
<dt class="hdlist1"><code>RDFS</code> </dt>
<dd>
<p>For the OWL 2 axioms allowed in <a href="http://www.w3.org/TR/rdf-schema/">RDF
schema</a> (mainly subclasses, subproperties, domain, and ranges).</p>
</dd>
<dt class="hdlist1"><code>QL</code> </dt>
<dd>
<p>For <a href="http://www.w3.org/TR/owl2-profiles/#OWL_2_QL">OWL 2 QL</a> axioms.</p>
</dd>
<dt class="hdlist1"><code>RL</code> </dt>
<dd>
<p>For <a href="http://www.w3.org/TR/owl2-profiles/#OWL_2_RL">OWL 2 RL</a> axioms.</p>
</dd>
<dt class="hdlist1"><code>EL</code> </dt>
<dd>
<p>For <a href="http://www.w3.org/TR/owl2-profiles/#OWL_2_EL">OWL 2 EL</a> axioms.</p>
</dd>
<dt class="hdlist1"><code>DL</code> </dt>
<dd>
<p>For <a href="http://www.w3.org/TR/owl2-syntax/">OWL 2 DL</a> axioms.</p>
</dd>
<dt class="hdlist1"><code>SL</code> </dt>
<dd>
<p>For a combination of RDFS, QL, RL, and EL axioms, plus <a href="http://www.w3.org/Submission/SWRL/">SWRL rules</a>.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-reasoning">Using Reasoning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to perform query evaluation with reasoning, Stardog requires a
schema (sometimes called a "TBox") to be present in the database. Since
schemas are serialized as RDF, they are loaded into a Stardog database
in the same way that any RDF is loaded into a Stardog database. Also,
note that, since the schema is just more RDF triples, it may change as
needed: it is neither fixed nor compiled in any special way.</p>
</div>
<div class="paragraph">
<p>The schema may reside in the default graph, in a specific named graph,
or in a collection of graphs. <strong>You can tell Stardog where the schema is
by setting the <code>reasoning.schema.graphs</code> property to one or more named
graph URIs.</strong> If you want the default graph to be considered part of the
schema, then you can use the special built-in URI
<code>tag:stardog:api:context:default</code>. If you want to use all named graphs
(that is, to tell Stardog to look for the schema in every named graph),
you can use <code>tag:stardog:api:context:all</code>. <strong>The default value for this
property is to use the default graph only.</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A common source of confusion for new users is failing to (1) read this chapter,
(2) realize that Stardog does not eagerly materialize inferences on data load, and (3)
properly set the location (in terms of one or more named graps or the default graph)
of the schema.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This design is intended to support both of Stardog&#8217;s primary use cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>managing the data that constitutes the schema</p>
</li>
<li>
<p>reasoning with the schema during query evaluation</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="query-answering">Query Answering</h3>
<div class="paragraph">
<p>All of Stardog&#8217;s interfaces (API, network, and CLI) support reasoning
during query evaluation.</p>
</div>
</div>
<div class="sect2">
<h3 id="command-line">Command Line</h3>
<div class="paragraph">
<p>In order to evaluate queries in Stardog using reasoning via the command
line, a specific reasoning level must be specified in the connection
string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ ./stardog query &quot;myDB;reasoning=QL&quot; &quot;SELECT ?s { ?s a :C } LIMIT 10&quot;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="http">HTTP</h3>
<div class="paragraph">
<p>For HTTP, the reasoning level is specified with the other HTTP request
parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ curl -u admin:admin -X GET &quot;http://localhost:5822/myDB/query?reasoning=ql&amp;query=...&quot;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="code-reasoningconnection-code-api"><code>ReasoningConnection</code> API</h3>
<div class="paragraph">
<p>In order to use the <code>ReasoningConnection</code> API one needs to specify a
reasoning level. See the <a href="/java">Programming Java</a> chapter for
details on specifying the reasoning level programmatically.</p>
</div>
<div class="paragraph">
<p>Currently, the API has two methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>isConsistent()</code>, which can be used to check if the database is
(logically) consistent with respect to the reasoning level.</p>
</li>
<li>
<p><code>isSatisfiable(URI theURIClass)</code>, which can be used to check if the
given class if satisfiable with respect to the database and
reasoning level.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="explaining-reasoning-results">Explaining Reasoning Results</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog can be used to check if the current datbase logically entails a
set of triples; moreover, Stardog can explain why this is
so.<span class="footnote">[<a id="_footnoteref_29" class="footnote" href="#_footnote_29" title="View footnote.">29</a>]</span> An explanation of an inference is the minimum set of
statements explicitly stored in the database that, together with the
schema, logically justify or warrant the inference. Explanations are
useful for understanding data, schema, and their interactions,
especially when large number of statements interact with each other to
infer new statements.</p>
</div>
<div class="paragraph">
<p>Explanations can be retrieved using the CLI
by providing an input file that contains the inferences to be explained:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ stardog reasoning explain &quot;myDB;reasoning=EL&quot; inference_to_explain.ttl</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output is displayed in a concise syntax designed to be legible; but
it can be rendered in any one of the supported RDF syntaxes if desired.
Explanations are also accessible through the <a href="/network/#extended-http)">extended HTTP protocol</a> and SNARL API. See the examples
included in the distribution for more details about retrieving
explanations programmatically.</p>
</div>
<div class="sect2">
<h3 id="proof-trees">Proof Trees</h3>
<div class="paragraph">
<p>Proof trees are a hierarchical presentation of multiple explanations
(of inferences) to make data, schemas, and rules more intelligible.
Proof tree<span class="footnote">[<a id="_footnoteref_30" class="footnote" href="#_footnote_30" title="View footnote.">30</a>]</span> provides an explanation for an
inference or an inconsistency in a <strong>hierarchical structure</strong>. Nodes in
the proof tree may represent an assertion in a Stardog database.
Multiple assertion nodes are grouped under an inferred node.</p>
</div>
<div class="sect3">
<h4 id="example">Example</h4>
<div class="paragraph">
<p>For example, if we are explaining the inferred triple <code>:Alice
rdf:type :Employee</code> , the root of the proof tree will show that
inference:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The children of an inferred node will provide more explanation for
that inference:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The fully expanded proof tree will show the asserted triples and
axioms for every inference:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Bob</span><span class="tok-w"></span>
<span class="tok-w">        </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">domain</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The CLI explanation command prints the proof tree using indented text;
but, using the SNARL API, it is easy to create a tree widget
in a GUI to show the explanation tree, such that users can expand and
collapse details in the explanation.</p>
</div>
<div class="paragraph">
<p>Another feature of proof trees is the ability to merge multiple
explanations into a single proof tree with multiple branches when
explanations have common statements. Consider the following example
database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-c">#schema</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">owl</span><span class="tok-p">:</span><span class="tok-nt">equivalentClass</span><span class="tok-w"> </span><span class="tok-p">(:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-err">some</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">domain</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">Rese</span><span class="tok-k">a</span><span class="tok-err">rchProject</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">projectID</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">domain</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>

<span class="tok-c"># instance data</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Bob</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Rese</span><span class="tok-k">a</span><span class="tok-err">rchProject</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">projectID</span><span class="tok-w"> </span><span class="tok-s">&quot;123-45-6789&quot;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this database, there are three different unique explanations
for the inference <code>:Alice rdf:type :Employee</code>:</p>
</div>
<div class="sect4">
<h5 id="explanation-1">Explanation 1</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">domain</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Bob</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="explanation-2">Explanation 2</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">owl</span><span class="tok-p">:</span><span class="tok-nt">equivalentClass</span><span class="tok-w"> </span><span class="tok-p">(:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-err">some</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">Rese</span><span class="tok-k">a</span><span class="tok-err">rchProject</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Rese</span><span class="tok-k">a</span><span class="tok-err">rchProject</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="explanation-3">Explanation 3</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">owl</span><span class="tok-p">:</span><span class="tok-nt">equivalentClass</span><span class="tok-w"> </span><span class="tok-p">(:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-err">some</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">projectID</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">domain</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">projectID</span><span class="tok-w"> </span><span class="tok-s">&quot;123-45-6789&quot;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All three explanations have some triples in common; but
when explanations are retrieved separately, it is hard to see how
these explanations are related. When explanations are merged, we
get a single proof tree where alternatives for subtrees of the
proof are shown inline. In indented text rendering, the merged
tree for the above explanations would look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-mf">1.1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">domain</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">supervises</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Bob</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-mf">1.2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"></span>
<span class="tok-w">         </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-nn">owl</span><span class="tok-p">:</span><span class="tok-nt">equivalentClass</span><span class="tok-w"> </span><span class="tok-p">(:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-err">some</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-w">         </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-k">A</span><span class="tok-err">lice</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"></span>
<span class="tok-w">         </span><span class="tok-mf">2.1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">projectID</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">domain</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">projectID</span><span class="tok-w"> </span><span class="tok-s">&quot;123-45-6789&quot;</span><span class="tok-w"></span>
<span class="tok-w">         </span><span class="tok-mf">2.2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-k">IN</span><span class="tok-err">FERRED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Rese</span><span class="tok-k">a</span><span class="tok-err">rchProject</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Project</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">AS</span><span class="tok-err">SERTED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">ProjectX</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Rese</span><span class="tok-k">a</span><span class="tok-err">rchProject</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the merged proof tree, alternatives for an
explanation are shown with a number id. In the above tree,
<code>:Alice a :Manager</code> is the first inference for which we have
multiple explanations so it gets the id <code>1</code>. Then each alternative
explanation gets an id appended to this (so explanations <code>1.1</code> and
<code>1.2</code> are both alternative explanations for inference <code>1</code>). We
also have multiple explanations for inference <code>:ProjectX a :Project</code>
so its alternatives get ids <code>2.1</code> and <code>2.2</code>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-defined-rule-reasoning">User-defined Rule Reasoning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Many reasoning problems may be solved with OWL&#8217;s axiom-based approach;
but, of course, not all reasoning problems are amenable to this
approach. A user-defined rules approach complements the OWL axiom-based
approach nicely and increases the expressive power of a reasoning system
from the user&#8217;s point of view. Many RDF databases support user-defined
rules only. Stardog is the only RDF database that
comprehensively supports both axioms and rules. Some problems (and some
people) are simply a better fit for a rules-based approach to modeling
and reasoning than to an axioms-based approach.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There isn&#8217;t a one-size-fits-all answer to the question
"rules or axioms or both?" Use the thing that makes the most sense to you
and to the people you&#8217;re working with, etc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Stardog supports user-defined rule reasoning together with a rich set of
built-in functions using the <a href="http://www.w3.org/Submission/SWRL/">SWRL</a>
syntax and builtin-ins library. In order to apply SWRL user-defined
rules, you must include the rules as part of the database&#8217;s schema: that
is, put your rules where your axioms are, i.e., in the schema. Once the
rules are part of the schema, they will be used for reasoning
automatically when using the <strong>SL</strong> reasoning level.</p>
</div>
<div class="paragraph">
<p>Assertions implied by the rules <strong>will not</strong> be materialized. Instead,
rules are used to expand queries just as regular axioms are used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To trigger rules to fire, execute a relevant query. It&#8217;s that simple.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="stardog-rules-syntax">Stardog Rules Syntax</h3>
<div class="paragraph">
<p>Stardog supports two different syntaxes for defining rules. The first
is native Stardog Rules syntax and is based on SPARQL, so you
can re-use what you already know about SPARQL to write rules.
<strong>Unless you have specific requirements otherwise, you should use this
syntax for user-defined rules in Stardog.</strong> The second is the <strong>de facto</strong>
standard RDF/XML syntax for SWRL. It has the advantage of being supported
in many tools; but it&#8217;s not fun to read or to write. You probably
don&#8217;t want to use it. Better: don&#8217;t use this syntax!</p>
</div>
<div class="paragraph">
<p>Stardog Rules Syntax is basically SPARQL "basic graph patterns" (BGPs)
plus some very explicit new bits (<code>IF-THEN</code>) to denote the head and the
body of a rule.<span class="footnote">[<a id="_footnoteref_31" class="footnote" href="#_footnote_31" title="View footnote.">31</a>]</span> You define URI prefixes
in the normal way (examples below) and use regular SPARQL variables for
rule variables. As you can see, some SPARQL 1.1 syntactic
sugar&#8212;&#8203;property paths, especially, but also bnode syntax&#8212;&#8203;make complex
Stardog Rules concise and elegant.</p>
</div>
<div class="sect3">
<h4 id="how-to-use-stardog-rules">How to Use Stardog Rules</h4>
<div class="paragraph">
<p>There are three things to sort out:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Where to put these rules?</p>
</li>
<li>
<p>How to represent these rules?</p>
</li>
<li>
<p>What are the gotchas?</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>First, the rules go into the database, of course; and, in particular,
they go into the named graph in which Stardog expects to find the TBox.
This setting by default is the "default graph", i.e., unless
you&#8217;ve changed the value of <code>reasoning.schema.graphs</code>, you&#8217;re probably
going to be fine; that is, just add the rules to the database and it
will all work out.<span class="footnote">[<a id="_footnoteref_32" class="footnote" href="#_footnote_32" title="View footnote.">32</a>]</span></p>
</div>
<div class="paragraph">
<p>Second, you represent the rules with specially constructed RDF triples. Here&#8217;s
a kind of template example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-err">@</span><span class="tok-k">prefix</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;tag:stardog:api:rule:&gt;</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-err">[]</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">SPARQLRule</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">content</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;&quot;</span>
<span class="tok-s">   ...la di dah the rule goes here!</span>
<span class="tok-s">   &quot;&quot;&quot;.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>So there&#8217;s a namespace--<code>tag:stardog:api:rule:</code>--that has a predicate,
<code>content</code>, and a class, <code>SPARQLRule</code>. The object of this triple contains
<strong>one</strong> rule in Stardog Rules syntax. A more realistic example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-err">@</span><span class="tok-k">prefix</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;tag:stardog:api:rule:&gt;</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>

<span class="tok-err">[]</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">SPARQLRule</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">content</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;&quot;</span>
<span class="tok-s">    PREFIX :&lt;urn:test:&gt;</span>
<span class="tok-s">      IF {</span>
<span class="tok-s">            ?r a :Rectangle ;</span>
<span class="tok-s">               :width ?w ;</span>
<span class="tok-s">               :height ?h</span>
<span class="tok-s">            BIND (?w * ?h AS ?area)</span>
<span class="tok-s">          }</span>
<span class="tok-s">      THEN {</span>
<span class="tok-s">              ?r :area ?area</span>
<span class="tok-s">          }&quot;&quot;&quot; .</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s pretty easy!</p>
</div>
<div class="paragraph">
<p>Third, what are the gotchas? There are two:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The RDF serialization of rules in, say, a Turtle file has to use the
<code>tag:stardog:api:rule:</code> namespace URI and then whatever prefix, if any,
mechanism that&#8217;s valid for that serialization. In the examples here, we
use Turtle. Hence, we use <code>@prefix</code>, etc.</p>
</li>
<li>
<p>However, the namespace URIs used <strong>by the rules themselves</strong> can be
defined in only two places: the string that contains the rule&#8212;&#8203;in the
example above, you can see the default namespace is <code>urn:test:</code>--or in
the Stardog database in which the rules are stored. Either place will
work; if there are conflicts, the "closest definition wins", that is, if
<code>foo:Example</code> is defined in both the rule content and in the Stardog
database, the definition in the rule content is the one that Stardog
will use.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="stardog-rules-examples">Stardog Rules Examples</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;tag:stardog:api:rule:&gt;</span><span class="tok-w"></span>
<span class="tok-err">PREFIX</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;urn:test:&gt;</span><span class="tok-w"></span>
<span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">gr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://purl.org/goodrelations/v1#&gt;</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-err">Product</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-nn">gr</span><span class="tok-p">:</span><span class="tok-nt">hasPriceSpecification</span><span class="tok-w"> </span><span class="tok-err">[</span><span class="tok-w"> </span><span class="tok-nn">gr</span><span class="tok-p">:</span><span class="tok-nt">hasCurrencyValue</span><span class="tok-w"> </span><span class="tok-mf">100.0</span><span class="tok-w"> </span><span class="tok-err">]</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">Product</span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-nn">gr</span><span class="tok-p">:</span><span class="tok-nt">hasPriceSpecification</span><span class="tok-w"> </span><span class="tok-err">[</span><span class="tok-w"> </span><span class="tok-nn">gr</span><span class="tok-p">:</span><span class="tok-nt">hasCurrencyValue</span><span class="tok-w"> </span><span class="tok-mf">500.0</span><span class="tok-w"> </span><span class="tok-err">]</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">:</span><span class="tok-err">Product</span><span class="tok-mi">3</span><span class="tok-w"> </span><span class="tok-nn">gr</span><span class="tok-p">:</span><span class="tok-nt">hasPriceSpecification</span><span class="tok-w"> </span><span class="tok-err">[</span><span class="tok-w"> </span><span class="tok-nn">gr</span><span class="tok-p">:</span><span class="tok-nt">hasCurrencyValue</span><span class="tok-w"> </span><span class="tok-mf">2000.0</span><span class="tok-w"> </span><span class="tok-err">]</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>

<span class="tok-err">[]</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">SPARQLRule</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">content</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;&quot;</span>
<span class="tok-s">       PREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;</span>
<span class="tok-s">       PREFIX gr: &lt;http://purl.org/goodrelations/v1#&gt;</span>
<span class="tok-s">       PREFIX :&lt;urn:test:&gt;</span>
<span class="tok-s">     IF {</span>
<span class="tok-s">        ?offering gr:hasPriceSpecification ?ps .</span>
<span class="tok-s">        ?ps gr:hasCurrencyValue ?price .</span>
<span class="tok-s">        FILTER (?price &gt;= 200.00).</span>
<span class="tok-s">     }</span>
<span class="tok-s">     THEN {</span>
<span class="tok-s">        ?offering a :ExpensiveProduct .</span>
<span class="tok-s">     }</span>
<span class="tok-s">   &quot;&quot;&quot;.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example is self-contained: it contains some data (the <code>:Product&#8230;&#8203;</code>
triples) and a rule. It also demonstrates the use of SPARQL&#8217;s <code>FILTER</code>
to do numerical (and other) comparisons.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a more complex example that includes four rules and, again, some
data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;tag:stardog:api:rule:&gt;</span><span class="tok-w"></span>
<span class="tok-err">PREFIX</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;urn:test:&gt;</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Circle</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-err">r</span><span class="tok-k">a</span><span class="tok-err">dius</span><span class="tok-w"> </span><span class="tok-mi">10</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-err">t</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Tri</span><span class="tok-k">a</span><span class="tok-err">ngle</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-err">b</span><span class="tok-k">as</span><span class="tok-err">e</span><span class="tok-w"> </span><span class="tok-mi">4</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-err">height</span><span class="tok-w"> </span><span class="tok-mi">10</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-err">r</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Rect</span><span class="tok-k">a</span><span class="tok-err">ngle</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-err">width</span><span class="tok-w"> </span><span class="tok-mi">5</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-err">height</span><span class="tok-w"> </span><span class="tok-mi">8</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-err">s</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Rect</span><span class="tok-k">a</span><span class="tok-err">ngle</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-err">width</span><span class="tok-w"> </span><span class="tok-mi">10</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-err">height</span><span class="tok-w"> </span><span class="tok-mi">10</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>

<span class="tok-err">[]</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">SPARQLRule</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">   </span><span class="tok-nn">rule</span><span class="tok-p">:</span><span class="tok-nt">content</span><span class="tok-w"> </span><span class="tok-s">&quot;&quot;&quot;</span>
<span class="tok-s">     PREFIX :&lt;urn:test:&gt;</span>
<span class="tok-s">     IF {</span>
<span class="tok-s">        ?r a :Rectangle ;</span>
<span class="tok-s">           :width ?w ;</span>
<span class="tok-s">           :height ?h</span>
<span class="tok-s">        BIND (?w * ?h AS ?area)</span>
<span class="tok-s">     }</span>
<span class="tok-s">     THEN {</span>
<span class="tok-s">         ?r :area ?area</span>
<span class="tok-s">     }&quot;&quot;&quot; .</span>

<span class="tok-s">[] a rule:SPARQLRule ;</span>
<span class="tok-s">   rule:content &quot;&quot;&quot;</span>
<span class="tok-s">     PREFIX :&lt;urn:test:&gt;</span>
<span class="tok-s">     IF {</span>
<span class="tok-s">        ?t a :Triangle ;</span>
<span class="tok-s">           :base ?b ;</span>
<span class="tok-s">           :height ?h</span>
<span class="tok-s">        BIND (?b * ?h / 2 AS ?area)</span>
<span class="tok-s">     }</span>
<span class="tok-s">     THEN {</span>
<span class="tok-s">         ?t :area ?area</span>
<span class="tok-s">     }&quot;&quot;&quot; .</span>

<span class="tok-s">[] a rule:SPARQLRule ;</span>
<span class="tok-s">   rule:content &quot;&quot;&quot;</span>
<span class="tok-s">     PREFIX :&lt;urn:test:&gt;</span>
<span class="tok-s">     PREFIX math: &lt;http://www.w3.org/2005/xpath-functions/math#&gt;</span>
<span class="tok-s">     IF {</span>
<span class="tok-s">          ?c a :Circle ;</span>
<span class="tok-s">             :radius ?r</span>
<span class="tok-s">          BIND (math:pi() * math:pow(?r, 2) AS ?area)</span>
<span class="tok-s">     }</span>
<span class="tok-s">     THEN {</span>
<span class="tok-s">         ?c :area ?area</span>
<span class="tok-s">     }&quot;&quot;&quot; .</span>


<span class="tok-s">[] a rule:SPARQLRule ;</span>
<span class="tok-s">   rule:content &quot;&quot;&quot;</span>
<span class="tok-s">     PREFIX :&lt;urn:test:&gt;</span>
<span class="tok-s">     IF {</span>
<span class="tok-s">          ?r a :Rectangle ;</span>
<span class="tok-s">             :width ?w ;</span>
<span class="tok-s">             :height ?h</span>
<span class="tok-s">          FILTER (?w = ?h)</span>
<span class="tok-s">     }</span>
<span class="tok-s">     THEN {</span>
<span class="tok-s">         ?r a :Square</span>
<span class="tok-s">     }&quot;&quot;&quot; .</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example also demonstrates how to use SPARQL&#8217;s <code>BIND</code> to introduce
intermediate variables and do calculations with or to them.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at some other rules, but just the rule content this time for
concision, to see some use of other SPARQL features.</p>
</div>
<div class="paragraph">
<p>This rule says that a person between 13 and 19 (inclusive) years of age
is a teenager:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">swrlb</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://www.w3.org/2003/11/swrlb#&gt;</span><span class="tok-w"></span>
<span class="tok-k">PREFIX</span><span class="tok-w"> </span><span class="tok-nn">xsd</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://www.w3.org/2001/XMLSchema#&gt;</span><span class="tok-w"></span>

<span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Person</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-err">h</span><span class="tok-k">asA</span><span class="tok-err">ge</span><span class="tok-w"> </span><span class="tok-nv">?age</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-k">FILTER</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">?age</span><span class="tok-w"> </span><span class="tok-err">&gt;</span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">13</span><span class="tok-w"> </span><span class="tok-o">&amp;&amp;</span><span class="tok-w"> </span><span class="tok-nv">?age</span><span class="tok-w"> </span><span class="tok-err">&lt;</span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-mi">19</span><span class="tok-p">)</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Teen</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This rule says that a male person with a sibling who is the parent of a
female is an "uncle with a niece":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-err">$x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-err">Person</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">le</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">h</span><span class="tok-k">as</span><span class="tok-err">Sibl</span><span class="tok-k">in</span><span class="tok-err">g</span><span class="tok-w"> </span><span class="tok-err">$y</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-err">$y</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">isP</span><span class="tok-k">a</span><span class="tok-err">rentOf</span><span class="tok-w"> </span><span class="tok-err">$z</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-err">$z</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Fem</span><span class="tok-k">a</span><span class="tok-err">le</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-err">$x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">UncleOfNiece</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use SPARQL 1.1 property paths (and bnodes for unnecessary
variables (that is, ones that aren&#8217;t used in the <code>THEN</code>)) to render this
rule even more concisely:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-err">$x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Person</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">le</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">h</span><span class="tok-k">as</span><span class="tok-err">Sibl</span><span class="tok-k">in</span><span class="tok-err">g</span><span class="tok-o">/</span><span class="tok-p">:</span><span class="tok-err">isP</span><span class="tok-k">a</span><span class="tok-err">rentOf</span><span class="tok-w"> </span><span class="tok-err">[</span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Fem</span><span class="tok-k">a</span><span class="tok-err">le]</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-err">$x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">UncleOfNiece</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Aside: that&#8217;s pure awesome.</strong></p>
</div>
<div class="paragraph">
<p>And of course a person who&#8217;s male and has a niece or nephew is an uncle
of his niece(s) and nephew(s):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">     </span><span class="tok-nv">?x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">le</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">isSibl</span><span class="tok-k">in</span><span class="tok-err">gOf</span><span class="tok-o">/</span><span class="tok-p">:</span><span class="tok-err">isP</span><span class="tok-k">a</span><span class="tok-err">rentOf</span><span class="tok-w"> </span><span class="tok-nv">?z</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?x</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">isUncleOf</span><span class="tok-w"> </span><span class="tok-nv">?z</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next rule example: a super user can read all of the things!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?x</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">SuperUser</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?y</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Resource</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?z</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-nl">&lt;http://www.w3.org/ns/sparql#UUID&gt;</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?z</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Role</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">      </span><span class="tok-nv">?x</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">h</span><span class="tok-k">as</span><span class="tok-err">Role</span><span class="tok-w"> </span><span class="tok-nv">?z</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">re</span><span class="tok-k">a</span><span class="tok-err">dPermission</span><span class="tok-w"> </span><span class="tok-nv">?y</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="supported-built-ins">Supported Built-Ins</h3>
<div class="paragraph">
<p>Stardog supports a wide variety of functions from SPARQL, XPath, SWRL,
and some native Stardog functions, too. All of them may be used in
either Stardog Rules syntax or in SWRL syntax. The supported functions
are enumerated <a href="/using/#functions">here</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="special-predicates">Special Predicates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog supports some builtin predicates with special meaning in order
to make queries and rules easier to read and write. These special
predicates are primarily syntactic sugar for more complex structures.</p>
</div>
<div class="sect2">
<h3 id="direct-strict-subclasses-subproperties-direct-types">Direct/Strict Subclasses, Subproperties, &amp; Direct Types</h3>
<div class="paragraph">
<p>Besides the standard RDF(S) predicates <code>rdf:type</code>, <code>rdfs:subClassOf</code> and
<code>rdfs:subPropertyOf</code>, Stardog supports the following special built-in
predicates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sp:directType</code></p>
</li>
<li>
<p><code>sp:directSubClassOf</code></p>
</li>
<li>
<p><code>sp:strictSubClassOf</code></p>
</li>
<li>
<p><code>sp:directSubPropertyOf</code></p>
</li>
<li>
<p><code>sp:strictSubPropertyOf</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where the <code>sp</code> prefix binds to <code>tag:stardog:api:property:</code>. Stardog also
recognizes <code>sesame:directType</code>, <code>sesame:directSubClassOf</code>, and
<code>sesame:strictSubClassOf</code> predicates where the prefix <code>sesame</code> binds to
<code><a href="http://www.openrdf.org/schema/sesame#" class="bare">http://www.openrdf.org/schema/sesame#</a></code>.</p>
</div>
<div class="paragraph">
<p>We show what these each of these predicates means by relating them to an
equivalent triple pattern; that is, you can just write the predicate
rather than the (more unwieldy) triple pattern.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-c"># c1 is a subclass of c2 but not equivalent to c2</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-nn">sp</span><span class="tok-p">:</span><span class="tok-nt">strictSubClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w">      </span><span class="tok-o">=</span><span class="tok-err">&gt;</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-nn">rdfs</span><span class="tok-p">:</span><span class="tok-nt">subClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                          </span><span class="tok-k">FILTER</span><span class="tok-w"> </span><span class="tok-nf">NOT EXISTS</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                                             </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-nn">owl</span><span class="tok-p">:</span><span class="tok-nt">equivalentClass</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                          </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-c"># c1 is a strict subclass of c2 and there is no c3 between c1 and c2 in</span><span class="tok-w"></span>
<span class="tok-c"># the strict subclass hierarchy</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-nn">sp</span><span class="tok-p">:</span><span class="tok-nt">directSubClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w">      </span><span class="tok-o">=</span><span class="tok-err">&gt;</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-nn">sp</span><span class="tok-p">:</span><span class="tok-nt">strictSubClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                          </span><span class="tok-k">FILTER</span><span class="tok-w"> </span><span class="tok-nf">NOT EXISTS</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                                             </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-nn">sp</span><span class="tok-p">:</span><span class="tok-nt">strictSubClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">3</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                             </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">3</span><span class="tok-w"> </span><span class="tok-nn">sp</span><span class="tok-p">:</span><span class="tok-nt">strictSubClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                          </span><span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-c"># ind is an instance of c1 but not an instance of any strict subclass of c1</span><span class="tok-w"></span>

<span class="tok-p">:</span><span class="tok-k">in</span><span class="tok-err">d</span><span class="tok-w"> </span><span class="tok-nn">sp</span><span class="tok-p">:</span><span class="tok-nt">directType</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w">           </span><span class="tok-o">=</span><span class="tok-err">&gt;</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-k">in</span><span class="tok-err">d</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                          </span><span class="tok-k">FILTER</span><span class="tok-w"> </span><span class="tok-nf">NOT EXISTS</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">                                             </span><span class="tok-p">:</span><span class="tok-k">in</span><span class="tok-err">d</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                             </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-nn">sp</span><span class="tok-p">:</span><span class="tok-nt">strictSubClassOf</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">c</span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">                                          </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The predicates <code>sp:directSubPropertyOf</code> and <code>sp:strictSubPropertyOf</code> are defined analogously.</p>
</div>
</div>
<div class="sect2">
<h3 id="new-individuals-with-swrl">New Individuals with SWRL</h3>
<div class="paragraph">
<p>Stardog also supports a special predicate that extends the expressivity
of SWRL rules. According to the SWLR spec, you can&#8217;t create new
individuals (i.e., new instances of classes) in a SWRL rule.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Don&#8217;t get hung up by the tech vocabulary here&#8230;&#8203;"new individual"
just means that you can&#8217;t have a rule that adds a new instance of some
RDF or OWL class as a result of the rule firing.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This restriction is well-motivated as it can easily cause rules to
not terminate, that is, never reach a fixed point, which causes
big problems. Stardog&#8217;s user-defined rules weakens this restriction in
some crucial aspects, subject to the following restrictions, conditions,
and warnings.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This special predicate is basically a loaded gun with which you may
shoot yourselves in the foot if you aren&#8217;t very careful.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So despite the general restriction in SWRL, in Stardog we actually can
create new individuals with a rule by using the function <code>UUID()</code> as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?p</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">P</span><span class="tok-k">a</span><span class="tok-err">rent</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">BIND</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-err">UUID</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-k">AS</span><span class="tok-w"> </span><span class="tok-nv">?parent</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?parent</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Person</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Alternatively, we can use the predicate
<code><a href="http://www.w3.org/ns/sparql#UUID" class="bare">http://www.w3.org/ns/sparql#UUID</a></code> as a unary SWRL built-in.</p>
</div>
<div class="paragraph">
<p>This rule will create a <strong>random</strong> URI for each instance of the class
<code>:Parent</code> and also assert that each new instance is an instance of
<code>:Person</code>--parents are people, too!</p>
</div>
<div class="sect3">
<h4 id="remarks">Remarks</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The URIs for the generated individuals are meaningless in the sense that they should not be used in further
queries; that is to say, these URIs are not guaranteed by Stardog to be stable.</p>
</li>
<li>
<p>Due to normalization, rules with more than one atom in the head are broken up into several rules.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thus,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Person</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">BIND</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-err">UUID</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-k">AS</span><span class="tok-w"> </span><span class="tok-nv">?parent</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?parent</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">P</span><span class="tok-k">a</span><span class="tok-err">rent</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">le</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>will be normalized into two rules:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Person</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">BIND</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-err">UUID</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-k">AS</span><span class="tok-w"> </span><span class="tok-nv">?parent</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?parent</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">P</span><span class="tok-k">a</span><span class="tok-err">rent</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>

<span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Person</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">BIND</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-err">UUID</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-k">AS</span><span class="tok-w"> </span><span class="tok-nv">?parent</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?parent</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">le</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As a consequence, instead of stating that the new
individual is both an instance of <code>:Male</code> and <code>:Parent</code>, we would create
two <strong>different</strong> new individuals, and assert that one is male and the
other is a parent. If you need to assert various things about the new
individual, we recommend the use of extra rules/axioms. In the previous
example, we can introduce a new class (<code>:Father</code>) and add the following
rule to our schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">F</span><span class="tok-k">a</span><span class="tok-err">ther</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?parent</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">P</span><span class="tok-k">a</span><span class="tok-err">rent</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">            </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">le</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And then modify the original rule accordingly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-nf">IF</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?person</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Person</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-k">BIND</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-err">UUID</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-k">AS</span><span class="tok-w"> </span><span class="tok-nv">?parent</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-err">THEN</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?parent</span><span class="tok-w"> </span><span class="tok-k">a</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">F</span><span class="tok-k">a</span><span class="tok-err">ther</span><span class="tok-w"> </span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="query-rewriting">Query Rewriting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Reasoning in Stardog is based (mostly) on a <strong>query rewriting</strong> technique:
Stardog rewrites the user&#8217;s query with respect to any schema or rules,
and then executes the resulting expanded query (EQ) against the data in
the normal way. This process is completely automated and requires no
intervention from the user.</p>
</div>
<div class="paragraph">
<p>As can be seen in Figure 2, the rewriting process involves five
different phases.</p>
</div>
<div class="paragraph">
<p>![](/img/blackout.png)</p>
</div>
<div class="paragraph">
<p>Figure 1. Query Answering</p>
</div>
<div class="paragraph">
<p>![](/img/blackout-internals.png)</p>
</div>
<div class="paragraph">
<p>Figure 2. Query Rewriting</p>
</div>
<div class="paragraph">
<p>We illustrate the query answering process by means of an example.
Consider a Stardog database, MyDB<sub>1</sub>, containing the following
schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="manchester"> :SeniorManager rdfs:subClassOf :manages some :Manager
 :manages some :Employee rdfs:subClassOf :Manager
 :Manager rdfs:subClassOf :Employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which says that a senior manager manages at least one manager, that
every person that manages an employee is a manager, and that every
manager is also an employee.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s also assume that MyDB<sub>1</sub> contains the following data
assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="manchester">:Bill rdf:type :SeniorManager
:Robert rdf:type :Manager
:Ana :manages :Lucy
:Lucy rdf:type :Employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, let&#8217;s say that we want to retrieve the set of all
employees. We do this by posing the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To answer this query, Stardog first <strong>rewrites</strong> it using the
information in the schema. So the original query is rewritten into four
queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">M</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">SeniorM</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ger</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-nv">?x</span><span class="tok-p">.</span><span class="tok-w"> </span><span class="tok-nv">?x</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then Stardog executes these queries over the data. Reasoning in Stardog
<strong>just is query answering</strong> in the common case.</p>
</div>
<div class="paragraph">
<p>The form of the EQ depends on the reasoning level. For OWL 2 QL, every
EQ produced by Stardog is <strong>guaranteed to be expanded into a set of
queries</strong>. If the reasoning level is OWL 2 RL or EL, then the EQ <strong>may</strong>
(but may not) include a recursive rule. If a recursive rule is included,
Stardog&#8217;s answers will be sound but incomplete with respect to the
semantics of the reasoning level.</p>
</div>
<div class="sect2">
<h3 id="why-query-rewriting">Why Query Rewriting?</h3>
<div class="paragraph">
<p>Query rewriting has several advantages over the alternative technique,
materialization. In materialization, the data gets expanded with respect
to the schema, not with respect to any actual query. And it&#8217;s the data&#8212;&#8203;all of
the data&#8212;&#8203;that gets expanded, whether any actual query subsequently requires
reasoning or not. The schema is used to generate new
triples, typicaly when data is added or removed from the system.
However, materialization introduces some issues:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>data freshness</strong>. Materialization has to be performed every time
the data or the schema change. This is particularly unsuitable for
applications where the data changes frequently.</p>
</li>
<li>
<p><strong>data size</strong>. Depending on the schema, materialization can
significantly increase the size of the data, sometimes dramatically so.
The cost of this data size blowup may be applied to <strong>every</strong> query in terms
of increased I/O.</p>
</li>
<li>
<p><strong>OWL 2 profile reasoning</strong>. Given the fact that QL, RL, and EL are
not comparable with respect to expressive power, an application that
requires reasoning with more than one profile would need to maintain
different corresponding materialized versions of the data.</p>
</li>
<li>
<p><strong>Resources</strong>. Depending on the size of the original data and the
complexity of the schema, materialization may be computationally
expensive. And truth maintenance, which materialization requires, is
<strong>always</strong> computationally expensive.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performance-hints">Performance Hints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The query rewriting approach suggests some guidelines for more efficient
query answering.</p>
</div>
<div class="sect2">
<h3 id="hierarchies-and-queries">Hierarchies and Queries</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Avoid unnecessarily deep class/property hierarchies. </dt>
<dd>
<p>If you do not
need to model several different types of a given class or property in
your schema, then don&#8217;t do that! The reason shallow hierarchies are
desirable is that the maximal hierarchy depth in the schema partly
determines the maximal size of the EQs produced by Stardog. The larger
the EQ, the longer it takes to evaluate, generally.</p>
<div class="paragraph">
<p>For example, suppose our schema contains a very thorough and detailed
set of subclasses of the class <code>:Employee</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="manchester">:Manager rdfs:subClassOf :Employee
:SeniorManager rdfs:subClassOf :Manager
...

:Supervisor rdfs:subClassOf :Employee
:DepartmentSupervisor rdfs:subClassOf :Supervisor
...

:Secretary rdfs:subClassOf :Employee
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we wanted to retrieve the set of all employees, Stardog would
produce an EQ containing a query of the following form for every
subclass <code>:Ci</code> of <code>:Employee</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Ci</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Thus, <strong>ask the most specific query sufficient for yr use case</strong>. Why? More general
queries&#8212;&#8203;that is, queries that contain concepts high up in the class
hierarchy defined by the schema&#8212;&#8203;will typically yield larger EQs.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="domains-and-ranges">Domains and Ranges</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Specify domain and range of the properties in the schema. </dt>
<dd>
<p>These
types of axiom can help reduce the size of the EQs significantly. Why?
Consider the following query asking for people and the employees they manage:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?manager</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"></span>
<span class="tok-w">  </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?manager</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-p">.</span><span class="tok-w"></span>
<span class="tok-w">    </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-nn">rdf</span><span class="tok-p">:</span><span class="tok-nt">type</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">Employee</span><span class="tok-p">.</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We know that this query would cause a large EQ given a deep hierarchy
of <code>:Employee</code> subclasses. However, if we added the following single
range axiom:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="manchester">:manages rdfs:range :Employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the EQ would collapse to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sparql"><span class="tok-w"> </span><span class="tok-k">SELECT</span><span class="tok-w"> </span><span class="tok-nv">?manager</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-k">WHERE</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">?manager</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-err">m</span><span class="tok-k">a</span><span class="tok-err">n</span><span class="tok-k">a</span><span class="tok-err">ges</span><span class="tok-w"> </span><span class="tok-nv">?employee</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>which is considerably easier to evaluate.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="not-seeing-expected-results">Not Seeing Expected Results?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here&#8217;s a few things that you might want to consider.</p>
</div>
<div class="sect2">
<h3 id="are-variable-types-ambiguous">Are variable types ambiguous?</h3>
<div class="paragraph">
<p>When a SPARQL query gets executed, each variable is bound to a URI,
blank node, or to a literal to form a particular result (a collection of
these results is a result set). In the context of reasoning,
URIs might represent different entities: individuals, classes,
properties, etc. According to the <a href="http://www.w3.org/TR/sparql11-entailment/#OWLDSEnRegime">relevant standard</a>,
<strong>every variable in a SPARQL query must bind to at most one of these
types of entity</strong>.</p>
</div>
<div class="paragraph">
<p>Stardog can often figure out the right entity type from the query itself
(e.g., given the triple pattern <code>?i ?p "a literal"</code>, we know <code>?p</code> is
supposed to bind to a data property); however, sometimes this isn&#8217;t
possible (e.g., <code>?s ?p ?o</code>). In case the types can&#8217;t be determined
automatically, <strong>Stardog logs a message and evaluates the query without
any reasoning</strong>.</p>
</div>
<div class="paragraph">
<p>You can add one or more type triples to the query to resolve these
ambiguities.<span class="footnote">[<a id="_footnoteref_33" class="footnote" href="#_footnote_33" title="View footnote.">33</a>]</span></p>
</div>
<div class="paragraph">
<p>These "type triples" have the form <code>?var a TYPE</code>, where <code>TYPE</code> is a URI
representing the type of entity to which the variable <code>?var</code> is supposed
to bind: the most common are <code>owl:ObjectProperty</code> or
<code>owl:DatatypeProperty</code>; in some cases, you might want
<code>owl:NamedIndividual</code>, or <code>owl:Class</code>. For instance, if you are
interested in all the object properties of <code>:i1</code>, you can use the
following query:</p>
</div>
<div class="paragraph">
<p>----sparql
    SELECT ?o
    WHERE {
        :i1 ?p ?o.
        ?p a owl:ObjectProperty.
    }.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Since Stardog now knows that `?p` should bind to an object property, we can now infer that `?o` binds to an individual, so there are no ambiguities and reasoning can be performed as requested.

=== Is the schema where you think it is?

Stardog might be extracting the wrong schema. You have to tell Stardog where to find the schema. See [Schema Extraction](#tbox_extraction) for details.

=== Are you using the right reasoning level?

Perhaps some of the modeling constructs (a.k.a. axioms) in your database are being ignored. You can find out which axioms are being ignored due to the reasoning level used by simply including the following line in the logging.properties file in `STARDOG_HOME`:

----java
        com.clarkparsia.blackout.level = ALL</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="are-you-using-dl">Are you using DL?</h3>
<div class="paragraph">
<p>Stardog supports schema-only reasoning for OWL 2 DL, which effectively means that only TBox queries—queries that contain [TBox BGPs](#query_types) only—will return complete query results.</p>
</div>
</div>
<div class="sect2">
<h3 id="are-you-using-swrl">Are you using SWRL?</h3>
<div class="paragraph">
<p>As from version 2.0, SWRL rules are only taken into account using the <strong>SL</strong> reasoning level.</p>
</div>
</div>
<div class="sect2">
<h3 id="do-you-know-what-to-expect">Do you know what to expect?</h3>
<div class="paragraph">
<p>The [OWL 2 primer](<a href="http://www.w3.org/TR/owl2-primer/" class="bare">http://www.w3.org/TR/owl2-primer/</a>) is always a good place to start.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="known-issues">Known Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog &lt;t&gt;version&lt;/t&gt; does not</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Follow ontology <code>owl:imports</code> statements automatically; any imported
OWL ontologies that are required for reasoning must be loaded into a
Stardog database in the normal way.</p>
</li>
<li>
<p>Handle recursive queries. If recursion is necessary to answer the
query with respect to the schema, results will be sound (no wrong
answers) but potentially incomplete (some correct answers not
returned) with respect to the requested reasoning type.</p>
</li>
<li>
<p>Perform equality reasoning. Only <strong>explicit</strong> <code>owl:sameAs</code> and
<code>owl:differentFrom</code> data assertions will be taken into account for
query answering.</p>
</li>
<li>
<p>Perform datatype reasoning or respect user-defined datatypes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="terminology">Terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter uses the following terms of art.</p>
</div>
<div class="sect2">
<h3 id="databases-3">Databases</h3>
<div class="paragraph">
<p>A <strong>database</strong> (DB), a.k.a. ontology, is composed of two different parts:
the schema or <strong>Terminological Box</strong> (TBox) and the data or <strong>Assertional
Box</strong> (ABox). Analogus to relational databases, the TBox can be thought
of as the schema, and the ABox as the data. In other words, the TBox is
a set of <strong>axioms</strong>, whereas the ABox is a set of <strong>assertions</strong>.</p>
</div>
<div class="paragraph">
<p>As we explain in [Section OWL 2 Profiles](#profiles), the kinds of
assertion and axiom that one might use for a particular database are
determined by the fragment of OWL 2 to which one would like to adhere.
In general, you should choose the OWL 2 profile that most closely fits
the data modeling needs of your application.</p>
</div>
<div class="paragraph">
<p>The most common data assertions are class and property assertions. Class
assertions are used to state that a particular individual is an instance
of a given class. Property assertions are used to state that two
particular individuals (or an individual and a literal) are related via
a given property. For example, suppose we have a DB MyDB-2- that
contains the following data assertions:We use the usual standard
prefixes for RDF(S) and OWL.</p>
</div>
<div class="paragraph">
<p>----manchester
:clark_and_parsia rdf:type :Company
:clark_and_parsia :maintains :Stardog</p>
</div>
<div class="listingblock">
<div class="content">
<pre>stating that `:clark_and_parsia` is a company, and that
`:clark_and_parsia` maintains `:Stardog`.

The most common schema axioms are subclass axioms. Subclass axioms are
used to state that every instance of a particular class is also an
instance of another class. For example, suppose that MyDB-2- contains
the following TBox axiom:

----manchester
:Company rdfs:subClassOf :Organization</pre>
</div>
</div>
<div class="paragraph">
<p>stating that companies are a type of organization.</p>
</div>
</div>
<div class="sect2">
<h3 id="queries">Queries</h3>
<div class="paragraph">
<p>When reasoning is enabled, Stardog executes SPARQL queries (simply
queries from now on) depending on the type of Basic Graph Patterns they
contain.</p>
</div>
<div class="paragraph">
<p>A BGP is said to be an ABox BGP if it is of one of the following forms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>term<sub>1</sub></strong> <code>rdf:type</code> <strong>uri</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <strong>uri</strong> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>owl:differentFrom</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>owl:sameAs</code> <strong>term-2-</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A BGP is said to be a TBox BGP if it is of one of the following forms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>term<sub>1</sub></strong> <code>rdfs:subClassOf</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>owl:disjointWith</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>owl:equivalentClass</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>rdfs:subPropertyOf</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>owl:equivalentProperty</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>owl:inverseOf</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>owl:propertyDisjointWith</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>rdfs:domain</code> <strong>term-2-</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <code>rdfs:range</code> <strong>term-2-</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A BGP is said to be a Hybrid BGP if it is of one of the following forms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>term<sub>1</sub></strong> <code>rdf:type</code> <strong>?var</strong></p>
</li>
<li>
<p><strong>term<sub>1</sub></strong> <strong>?var</strong> <strong>term-2-</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>where <strong>term</strong> (possibly with subscripts) is either an URI or variable;
<strong>uri</strong> is a URI; and <strong>?var</strong> is a variable.</p>
</div>
<div class="paragraph">
<p>When executing a query, ABox BGPs are handled by Stardog. TBox BGPs are
executed by Pellet embedded in Stardog. Hybrid BGPs by a combination of both.</p>
</div>
</div>
<div class="sect2">
<h3 id="reasoning-2">Reasoning</h3>
<div class="paragraph">
<p>Intuitively, reasoning with a DB means to make implicit knowledge
explicit. There are two main use cases for reasoning: infer implicit
knowledge and to discover modeling errors.</p>
</div>
<div class="paragraph">
<p>With respect to the first use case, recall that MyDB-2- contains the
following assertion and axiom:</p>
</div>
<div class="paragraph">
<p>----manchester
 :clark_and_parsia rdf:type :Company
 :Company rdfs:subClassOf :Organization</p>
</div>
<div class="listingblock">
<div class="content">
<pre>From this DB, we can use Stardog in order to *infer* that
`:clark_and_parsia` is an organization:</pre>
</div>
</div>
<div class="paragraph">
<p>:clark_and_parsia rdf:type :Organization</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Using reasoning in order to infer implicit knowledge in the context of
an enterprise application can lead to simpler queries. Let us suppose,
for example, that MyDB-2- contains a complex class hierarchy including
several types of organization (including company). Let us further
suppose that our application requires to use Stardog in order to get the
list of all considered organizations. If Stardog were used **with
reasoning**, then we would need only issue the following simple query:

----sparql
SELECT ?org WHERE { ?org rdf:type :Organization}</pre>
</div>
</div>
<div class="paragraph">
<p>In contrast, if we were using Stardog <strong>with no reasoning</strong>, then we
would have to issue the following considerably more complex query that
considers all possible types of organization:</p>
</div>
<div class="paragraph">
<p>----sparql
SELECT ?org WHERE
              { { ?org rdf:type :Organization } UNION
              { ?org rdf:type :Company } UNION
&#8230;&#8203;
}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Stardog can also be used in order to discover modeling errors in a DB.
The most common modeling errors are *unsatisfiable* classes and
*inconsistent* DBs.

An unsatisfiable class is simply a class that cannot have any instances.
Say, for example, that we added the following axioms to MyDB-2-:

----manchester
 :Company owl:disjointWith :Organization
 :LLC owl:equivalentClass :Company and :Organization</pre>
</div>
</div>
<div class="paragraph">
<p>stating that companies cannot be organizations and vice versa, and that
an LLC is a company and an organization. The disjointness axiom causes
the class <code>:LLC</code> to be unsatisfiable because, for the DB to be
free of any logical contradiction, there can be no instances of <code>:LLC</code>.</p>
</div>
<div class="paragraph">
<p>Asserting (or inferring) that an unsatisfiable class has an instance,
causes the DB to be <strong>inconsistent</strong>. In the particular case of MyDB-2-,
we know that <code>:clark_and_parsia</code> is a company <strong>and</strong> an organization (see
above); therefore, we also know that it is an instance of <code>:LLC</code>, and as
<code>:LLC</code> is known to be unsatisfiable, we have that MyDB-2- is
inconsistent.</p>
</div>
<div class="paragraph">
<p>Using reasoning in order to discover modeling errors in the context of
an enterprise application is useful in order to maintain a correct
contradiction-free model of the domain. In our example, we discovered
that <code>:LLC</code> is unsatisfiable and MyDB-2- is inconsistent, which leads us
to believe that there is a modeling error in our DB. In this case, it is
easy to see that the problem is the disjointness axiom between
<code>:Company</code> and <code>:Organization</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="owl-2-profiles">OWL 2 Profiles</h3>
<div class="paragraph">
<p>As explained in the [OWL 2 Web Ontology Language Profiles
Specification](<a href="http://www.w3.org/TR/owl2-profiles/" class="bare">http://www.w3.org/TR/owl2-profiles/</a>) of the W3C, an OWL 2
profile is a trimmed down version of OWL 2 that trades some expressive
power for the efficiency of reasoning. There are three OWL 2 profiles,
each of which achieves efficiency differently.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>[OWL 2 QL](<a href="http://www.w3.org/TR/owl2-profiles/#OWL_2_QL" class="bare">http://www.w3.org/TR/owl2-profiles/#OWL_2_QL</a>) is aimed at
applications that use very large volumes of instance data, and where
query answering is the most important reasoning task. The expressive
power of the profile is necessarily limited, however it includes
most of the main features of conceptual models such as UML class
diagrams and ER diagrams.</p>
</li>
<li>
<p>[OWL 2 EL](<a href="http://www.w3.org/TR/owl2-profiles/#OWL_2_EL" class="bare">http://www.w3.org/TR/owl2-profiles/#OWL_2_EL</a>) is
particularly useful in applications employing ontologies that
contain very large numbers of properties and/or classes. This
profile captures the expressive power used by many such ontologies
and is a subset of OWL 2 for which the basic reasoning problems can
be performed in time that is polynomial with respect to the size of
the ontology.</p>
</li>
<li>
<p>[OWL 2 RL](<a href="http://www.w3.org/TR/owl2-profiles/#OWL_2_RL" class="bare">http://www.w3.org/TR/owl2-profiles/#OWL_2_RL</a>) is aimed at
applications that require scalable reasoning without sacrificing too
much expressive power. It is designed to accommodate OWL 2
applications that can trade the full expressivity of the language
for efficiency, as well as RDF(S) applications that need some added
expressivity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each profile restricts the kinds of axiom and assertion that can be used
in a DB. Intuitively, QL is the least expressive of the profiles,
followed by RL and EL; however, strictly speaking, no profile is more
expressive than any other as they provide incomparable sets of
constructs.</p>
</div>
<div class="paragraph">
<p>Stardog supports the three profiles of OWL 2. Notably, since TBox BGPs are handled completely by Pellet, Stardog supports reasoning for the whole of OWL 2 for queries containing TBox BGPs only.</p>
</div>
</div>
</div>
</div>
<h1 id="integrity-constraint-validation" class="sect0">Integrity Constraint Validation</h1>
<div class="openblock partintro">
<div class="content">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>It is easier to write an incorrect program than understand a correct one.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Alan Perlis<br>
<cite>Epigrams in Programming</cite>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-integrity-constraint-validation">What is Integrity Constraint Validation?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog Integrity Constraint Validation ("ICV") validates RDF data stored in a
Stardog database according to data rules (i.e., "constraints") described by
users and that make sense for their domain, application, and data. These
constraints may be written in SPARQL, OWL, or SWRL. This chapter explains how to
use ICV.</p>
</div>
<div class="paragraph">
<p>The use of high-level languages (OWL 2, SWRL, and SPARQL) to validate RDF data
using <strong>closed world semantics</strong> is one of Stardog&#8217;s unique capabilities. Using
high level languages like OWL, SWRL, and SPARQL as schema or constraint
languages for RDF and Linked Data has several advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unifying the domain model with data quality rules</p>
</li>
<li>
<p>Aligning the domain model and data quality rules with the
integration model and language (i.e., RDF)</p>
</li>
<li>
<p>Being able to query the domain model, data quality rules,
integration model, mapping rules, etc with SPARQL</p>
</li>
<li>
<p>Being able to use automated reasoning about all of these things to insure logical consistency, explain errors and problems, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are also interested in theory and background, please see the [ICV
specification](/icv/icv-specification.html), which has all the formal details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-with-icv">Getting Started with ICV</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This log of a CLI session gives a full example of how to validate data using a
mix of integrity constraints expressed in OWL and SPARQL. It uses data and
constraints linked below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell"># Stardog commands and the output for RDF validation example

# First create the Stardog database and load data

$ ./stardog-admin db create -n sota sota-data.ttl
Bulk loading data to new database.
Loading data completed...Loaded 23 triples in 00:00:00 @ 0.4K triples/sec.
Successfully created database 'sota'.

# Then add the constraints to the database

$ ./stardog-admin icv add sota sota-constraints.ttl
Successfully added constraints in 00:00:00.

# Now run the validation command
# This command just prints which constraints are violated, see the Java
# example for printing the details about validation

$ ./stardog icv validate sota
Data is NOT valid.
The following constraints were violated:
AxiomConstraint{:related rdfs:range :Issue}
AxiomConstraint{:reportedOn rdfs:domain :Issue}
AxiomConstraint{:Issue rdfs:subClassOf (:reportedBy exactly 1 owl:Thing)}
AxiomConstraint{:Issue rdfs:subClassOf (:reproducedBy min 0 owl:Thing)}
AxiomConstraint{:reproducedBy rdfs:range foaf:Person}
AxiomConstraint{:reportedBy rdfs:range foaf:Person}
AxiomConstraint{:Issue rdfs:subClassOf (:related min 0 owl:Thing)}
AxiomConstraint{:state rdfs:domain :Issue}
AxiomConstraint{:state rdfs:range :ValidState}
AxiomConstraint{:Issue rdfs:subClassOf (:reproducedOn min 0 rdfs:Literal)}


# We can also add SPARQL queries as constraints

$ ./stardog-admin icv add sota-query.sparql

# We can run validation with a mixture of OWL constraints and SPARQL constraints

$ ./stardog icv validate sota
Data is NOT valid.
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the following Gists to follow along at home:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://gist.github.com/evren/5612900#file-sota-constraints-ttl">Constraints in OWL</a></p>
</li>
<li>
<p><a href="https://gist.github.com/evren/5612900#file-sota-data-ttl">Example Data in Turtle</a></p>
</li>
<li>
<p><a href="https://gist.github.com/evren/5612900#file-sota-example-java">Java Example</a></p>
</li>
<li>
<p><a href="https://gist.github.com/evren/5612900#file-sota-example-out">Example Output</a></p>
</li>
<li>
<p><a href="https://gist.github.com/evren/5612900#file-sota-query-example-java">SPARQL Query Example in Java</a></p>
</li>
<li>
<p><a href="https://gist.github.com/evren/5612900#file-sota-query-out">SPARQL Query Output</a></p>
</li>
<li>
<p><a href="https://gist.github.com/evren/5612900#file-sota-query-sparql">Constraints in SPARQL</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And, finally, the <a href="https://gist.github.com/evren/5612900">full Gist with links to
everything</a>. In the rest of this chapter, we explain in more detail about
programmatic access, as well as give a full slate of examples of ICV in action.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="icv-owl-2-reasoning">ICV &amp; OWL 2 Reasoning</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>An integrity constraint may be satisfied or violated in either of two ways: by
an explicit statement in a Stardog database or by a statement that&#8217;s been
validly inferred by Stardog.</strong></p>
</div>
<div class="paragraph">
<p>When ICV is enabled for a Stardog database, it has to be enabled with respect to
a reasoning type or level. The valid choices of reasoning type are any type or
kind of reasoning supported by Stardog. See <a href="/owl2#reasoning">Stardog&#8217;s reasoning &amp; inference
chapter</a> for the details.</p>
</div>
<div class="paragraph">
<p>So ICV is performed with three inputs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a Stardog database,</p>
</li>
<li>
<p>a set of constraints, and</p>
</li>
<li>
<p>a reasoning type (which may be, of course, no reasoning).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This is the case because domain modelers, ontology developers, or integrity
constraint authors must consider the interactions between explicit and inferred
statements and how these are accounted for in integrity constraints.</p>
</div>
<div class="sect2">
<h3 id="security-note">Security Note</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
There is a security implication in this design choice that may not be
obvious. Changing the reasoning type associated with a database and
integrity constraint validation may have serious security implications with
respect to a Stardog database and, thus, may only be performed by a user role
with sufficient privileges for that action.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="icv-examples">ICV Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog ICV has a <a href="/icv/icv-specification.html">formal semantics</a>.  But let&#8217;s
just look at some examples instead; these examples use OWL 2 Manchester syntax,
and they assume a simple data schema, which is available as an
<a href="/icv/company.owl">OWL ontology</a> and as a <a href="/icv/ClassDiagram.png">UML
diagram</a>. The examples  assume that the default namespace is
<code><a href="http://example.com/company.owl#" class="bare">http://example.com/company.owl#</a></code> and that <code>xsd:</code> is bound to the standard,
<code><a href="http://www.w3.org/2001/XMLSchema#" class="bare">http://www.w3.org/2001/XMLSchema#</a></code>.</p>
</div>
<div class="paragraph">
<p><a href="https://gist.github.com/1333767">Reference Java code</a> is available for each of
the following examples and is also distributed with Stardog.</p>
</div>
<div class="sect2">
<h3 id="subsumption-constraints">Subsumption Constraints</h3>
<div class="paragraph">
<p>This kind of constraint guarantees certain subclass and superclass
(i.e., subsumption) relationships exist between instances.</p>
</div>
<div class="sect3">
<h4 id="managers-must-be-employees">Managers must be employees.</h4>
<div class="sect4">
<h5 id="constraint">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Manager rdfs:subClassOf :Employee</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-invalid">Database A (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a :Manager .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-valid">Database B (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a :Manager , :Employee .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF individual is an instance of
<code>Manager</code>, then it must also be an instance of <code>Employee</code>. In
A, the only instance of <code>Manager</code>, namely <code>Alice</code>, is not an instance of
<code>Employee</code>; therefore, A is invalid. In B, <code>Alice</code> is an instance of
Database both <code>Manager</code> and <code>Employee</code>; therefore, B is valid.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="domain-range-constraints">Domain-Range Constraints</h3>
<div class="paragraph">
<p>These constraints control the types of domain and range instances of
properties.</p>
</div>
<div class="sect3">
<h4 id="only-project-leaders-can-be-responsible-for-projects">Only project leaders can be responsible for projects.</h4>
<div class="sect4">
<h5 id="constraint-2">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:is_responsible_for rdfs:domain :Project_Leader</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-invalid-2">Database A (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice :is_responsible_for :MyProject .

:MyProject a :Project .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-invalid">Database B (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a :Project_Leader ;
	:is_responsible_for :MyProject .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-valid">Database C (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a :Project_Leader ;
	:is_responsible_for :MyProject .

:MyProject a :Project .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if two RDF instances are related to each other via the
property <code>is_responsible_for</code>, then the range instance must be an instance of
<code>Project_Leader</code> and the domain instance must be an instance of <code>Project</code>. In
Database A, there is only one pair of individuals related via
<code>is_responsible_for</code>, namely <code>(Alice, MyProject)</code>, and <code>MyProject</code> is an
instance of <code>Project</code>; but <code>Alice</code> is not an instance of <code>Project_Leader</code>.
Therefore, A is invalid. In B, <code>Alice</code> is an instance of <code>Project_Leader</code>, but
<code>MyProject</code> is not an instance of <code>Project</code>; therefore, B is not valid. In C,
<code>Alice</code> is an instance of <code>Project_Leader</code>, and <code>MyProject</code> is an instance of
<code>Project</code>; therefore, C is valid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="only-employees-can-have-an-ssn">Only employees can have an SSN.</h4>
<div class="sect4">
<h5 id="constraint-3">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:ssn rdfs:domain :Employee</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-invalid-3">Database A (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob :ssn "123-45-6789" .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-valid-2">Database B (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob a :Employee ;
	:ssn "123-45-6789" .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> has a data assertion via the
the property <code>SSN</code>, then <code>i</code> must be an instance of <code>Employee</code>. In A, <code>Bob</code> is
not an instance of <code>Employee</code> but has <code>SSN</code>; therefore, A is invalid. In B,
<code>Bob</code> is an instance of <code>Employee</code>; therefore, B is valid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a-date-of-birth-must-be-a-date">A date of birth must be a date.</h4>
<div class="sect4">
<h5 id="constraint-4">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:dob rdfs:range xsd:date</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-invalid-4">Database A (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob :dob "1970-01-01" .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-valid-3">Database B (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob :dob "1970-01-01"^^xsd:date</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> is related to a literal
<code>l</code> via the data property <code>DOB</code>, then <code>l</code> must have the XML Schema type
<code>xsd:date</code>. In A, <code>Bob</code> is related to the untyped literal
<code>"1970-01-01"</code> via <code>DOB</code> so A is invalid. In B, the literal
<code>"1970-01-01"</code> is properly typed so it&#8217;s valid.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="participation-constraints">Participation Constraints</h3>
<div class="paragraph">
<p>These constraints control whether or not an RDF instance participates
in some specified relationship.</p>
</div>
<div class="sect3">
<h4 id="each-supervisor-must-supervise-at-least-one-employee">Each supervisor must supervise at least one employee.</h4>
<div class="sect4">
<h5 id="constraint-5">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql"># this constraint is very concise in Terp syntax:
# :Supervisor rdfs:subClassOf (:supervises some :Employee)

:Supervisor rdfs:subClassOf
              [ a owl:Restriction ;
                owl:onProperty :supervises ;
                owl:someValuesFrom :Employee
              ] .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-valid">Database A (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a owl:Thing .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-invalid-2">Database B (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a :Supervisor .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-invalid">Database C (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a :Supervisor ;
	:supervises :Bob .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-d-valid">Database D (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Alice a :Supervisor ;
	:supervises :Bob .

:Bob a :Employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> is of type <code>Supervisor</code>, then
<code>i</code> must be related to an individual <code>j</code> via the property <code>supervises</code> and also
that <code>j</code> must be an instance of <code>Employee</code>. In A, <code>Supervisor</code> has no instances;
therefore, A is trivially valid. In B, the only instance of <code>Supervisor</code>, namely
<code>Alice</code>, is related to no individual; therefore, B is invalid. In C, <code>Alice</code> is
related to <code>Bob</code> via <code>supervises</code>, but <code>Bob</code> is not an instance of <code>Employee</code>;
therefore, C is invalid. In D, <code>Alice</code> is related to <code>Bob</code> via <code>supervises</code>, and
<code>Bob</code> is an instance of <code>Employee</code>; hence, D is valid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="each-project-must-have-a-valid-project-number">Each project must have a valid project number.</h4>
<div class="sect4">
<h5 id="constraint-6">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql"># Again, this constraint in Terp syntax rocks the hizzous:
# :Project rdfs:subClassOf (:number some xsd:integer[&gt;= 0, &lt; 5000])

:Project rdfs:subClassOf
              [ a owl:Restriction ;
                owl:onProperty :number ;
                owl:someValuesFrom
                        [ a rdfs:Datatype ;
                          owl:onDatatype xsd:integer ;
                          owl:withRestrictions ([xsd:minInclusive 0] [ xsd:maxExclusive 5000])
                        ]
              ] .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-valid-2">Database A (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a owl:Thing .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-invalid-3">Database B (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-invalid-2">Database C (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project ;
	:number "23" .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-d-invalid">Database D (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project ;
	:number "6000"^^xsd:integer .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-e-valid">Database E (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project ;
	:number "23"^^xsd:integer .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> is of type <code>Project</code>, then <code>i</code>
must be related via the property <code>number</code> to an integer between <code>0</code> and <code>5000</code>
(inclusive)—that is, projects have project numbers in a certain range. In  A,
the individual <code>MyProject</code> is not known to be an instance of <code>Project</code> so the
constraint does not apply at all and A is valid. In B, <code>MyProject</code> is an
instance of <code>Project</code> but doesn&#8217;t have any data assertions via <code>number</code> so A is
invalid. In C, <code>MyProject</code> does have a data property assertion via <code>number</code> but
the literal <code>"23"</code> is untyped&#8212;&#8203;that is, it&#8217;s not an integer&#8212;&#8203;therefore, C is
invalid. In D, <code>MyProject</code> is related to an integer via <code>number</code> but it is out
of the range: D is invalid. Finally, in E, <code>MyProject</code> is related to the integer
<code>23</code> which is in the range of <code>[0,5000]</code> so E is valid.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cardinality-constraints">Cardinality Constraints</h3>
<div class="paragraph">
<p>These constraints control the number of various relationships or
property values.</p>
</div>
<div class="sect3">
<h4 id="employees-must-not-work-on-more-than-3-projects">Employees must not work on more than 3 projects.</h4>
<div class="sect4">
<h5 id="constraint-7">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql"># Constraint in Terp syntax:
# :Employee rdfs:subClassOf (:works_on max 3 :Project)

:Employee rdfs:subClassOf
              [ a owl:Restriction ;
                owl:onProperty :works_on;
                owl:maxQualifiedCardinality "3"^^xsd:nonNegativeInteger ;
                owl:onClass :Project
              ] .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-valid-3">Database A (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob a owl:Thing.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-valid-4">Database B (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob a :Employee ;
	:works_on :MyProject .

:MyProject a :Project .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-invalid-3">Database C (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob a :Employee ;
	:works_on :MyProject , :MyProjectFoo , :MyProjectBar , :MyProjectBaz .

:MyProject a :Project .

:MyProjectFoo a :Project .

:MyProjectBar a :Project .

:MyProjectBaz a :Project .</code></pre>
</div>
</div>
<div class="paragraph">
<p>If an RDF instance <code>i</code> is an <code>Employee</code>, then <code>i</code> must not be related via the
property <code>works_on</code> to more than 3 instances of <code>Project</code>. In  A, <code>Bob</code> is not
known to be an instance of <code>Employee</code> so the constraint does not apply and the A
is valid. In B, <code>Bob</code> is an instance of <code>Employee</code> but is known to work on only
a single project, namely <code>MyProject</code>, so B is valid. In C, <code>Bob</code> is related to 4
instances of <code>Project</code> via <code>works_on</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Stardog ICV implements a weak
form of the <strong>unique name assumption</strong>, that is, it assumes that things which have
different names are, in fact, different things.<span class="footnote">[<a id="_footnoteref_34" class="footnote" href="#_footnote_34" title="View footnote.">34</a>]</span>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since Stardog ICV uses closed world (instead of open world)
semantics,<span class="footnote">[<a id="_footnoteref_35" class="footnote" href="#_footnote_35" title="View footnote.">35</a>]</span> it assumes that the different projects with different names are, in
fact, separate projects, which (<strong>in this case</strong>) violates the constraint and
makes C invalid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="departments-must-have-at-least-2-employees">Departments must have at least 2 employees.</h4>
<div class="sect4">
<h5 id="constraint-8">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql"># Constraint in Terp syntax:
# :Department rdfs:subClassOf (inverse :works_in min 2 :Employee)

:Department rdfs:subClassOf
              [ a owl:Restriction ;
                owl:onProperty [owl:inverseOf :works_in] ;
                owl:minQualifiedCardinality "2"^^xsd:nonNegativeInteger ;
                owl:onClass :Employee
              ] .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-valid-4">Database A (valid)</h5>
<div class="listingblock">
<div class="content">
<pre>[source,sparql]
:MyDepartment a owl:NamedIndividual .</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-invalid-4">Database B (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyDepartment a :Department .

:Bob a :Employee ;
	:works_in :MyDepartment .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-valid-2">Database C (valid)</h5>
<div class="listingblock">
<div class="content">
<pre>[source,sparql]
:MyDepartment a :Department .

:Alice a :Employee ;
	:works_in :MyDepartment .

:Bob a :Employee ;
	:works_in :MyDepartment .</pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> is a <code>Department</code>, then there
should exist at least 2 instances <code>j</code> and <code>k</code> of class <code>Employee</code> which are
related to <code>i</code> via the property <code>works_in</code> (or, equivalently, <code>i</code> should be
related to them via the inverse of <code>works_in</code>). In A, <code>MyDepartment</code> is not
known to be an instance of <code>Department</code> so the constraint does not apply. In B,
<code>MyDepartment</code> is an instance of <code>Department</code> but only one instance of
<code>Employee</code>, namely <code>Bob</code>, is known to work in it, so B is invalid. In C,
<code>MyDepartment</code> is related to the individuals <code>Bob</code> and <code>Alice</code>, which are both
instances of <code>Employee</code> and (again, due to weak Unique Name Assumption in
Stardog ICV), are assumed to be distinct, so C is valid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managers-must-manage-exactly-1-department">Managers must manage exactly 1 department.</h4>
<div class="sect4">
<h5 id="constraint-9">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql"># Constraint in Terp syntax:
# :Manager rdfs:subClassOf (:manages exactly 1 :Department)

:Manager rdfs:subClassOf
              [ a owl:Restriction ;
                owl:onProperty :manages ;
                owl:qualifiedCardinality "1"^^xsd:nonNegativeInteger ;
                owl:onClass :Department
              ] .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-valid-5">Database A (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">    Individual: Isabella</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-invalid-5">Database B (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Isabella a :Manager .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-invalid-4">Database C (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Isabella a :Manager ;
	:manages :MyDepartment .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-d-valid-2">Database D (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Isabella a :Manager ;
	:manages :MyDepartment .

:MyDepartment a :Department .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-e-invalid">Database E (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Isabella a :Manager ;
	:manages :MyDepartment , :MyDepartment1 .

:MyDepartment a :Department .

:MyDepartment1 a :Department .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> is a <code>Manager</code>, then it must be
related to exactly 1 instance of <code>Department</code> via the property <code>manages</code>. In A,
the individual <code>Isabella</code> is not known to be an instance of <code>Manager</code> so the
constraint does not apply and A is valid. In B, <code>Isabella</code> is an instance of
<code>Manager</code> but is not related to any instances of <code>Department</code>, so B is invalid.
In C, <code>Isabella</code> is related to the individual <code>MyDepartment</code> via the property
<code>manages</code> but <code>MyDepartment</code> is not known to be an instance of <code>Department</code>, so
C is invalid. In D, <code>Isabella</code> is related to exactly one instance of
<code>Department</code>, namely <code>MyDepartment</code>, so D is valid. Finally, in E, <code>Isabella</code> is
related to two (assumed to be) distinct (again, because of weak UNA) instances
of <code>Department</code>, namely <code>MyDepartment</code> and <code>MyDepartment1</code>, so E is invalid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entities-may-have-no-more-than-one-name">Entities may have no more than one name.</h4>
<div class="sect4">
<h5 id="constraint-10">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:name a owl:FunctionalProperty .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-valid-6">Database A (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyDepartment a owl:Thing .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-valid-5">Database B (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyDepartment :name "Human Resources" .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-invalid-5">Database C (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyDepartment :name "Human Resources" , "Legal" .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that no RDF instance <code>i</code> can have more than one assertion via
the data property <code>name</code>. In A, <code>MyDepartment</code> does not have any data property
assertions so A is valid. In B, <code>MyDepartment</code> has a single assertion via
<code>name</code>, so the ontology is also valid. In C, <code>MyDepartment</code> is related to 2
literals, namely <code>"Human Resources"</code> and <code>"Legal"</code>, via <code>name</code>, so C is invalid.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="property-constraints">Property Constraints</h3>
<div class="paragraph">
<p>These constraints control how instances are related to one another via
properties.</p>
</div>
<div class="sect3">
<h4 id="the-manager-of-a-department-must-work-in-that-department">The manager of a department must work in that department.</h4>
<div class="sect4">
<h5 id="constraint-11">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:manages rdfs:subPropertyOf :works_in .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-invalid-5">Database A (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob :manages :MyDepartment</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-valid-6">Database B (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Bob :works_in :MyDepartment ;
	:manages :MyDepartment .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> is related to <code>j</code> via the
property <code>manages</code>, then <code>i</code> must also be related to <code>j</code> va the property
<code>works_in</code>. In A, <code>Bob</code> is related to <code>MyDepartment</code> via <code>manages</code>, but not via
<code>works_in</code>, so A is invalid. In B, <code>Bob</code> is related to <code>MyDepartment</code> via both
<code>manages</code> and <code>works_in</code>, so B is valid.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="department-managers-must-supervise-all-the-department-s-employees">Department managers must supervise all the department&#8217;s employees.</h4>
<div class="sect4">
<h5 id="constraint-12">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:is_supervisor_of owl:propertyChainAxiom (:manages [owl:inverseOf :works_in]) .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-invalid-6">Database A (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Jose :manages :MyDepartment ;
	:is_supervisor_of :Maria .

:Maria :works_in :MyDepartment .

:Diego :works_in :MyDepartment .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-valid-7">Database B (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Jose :manages :MyDepartment ;
	:is_supervisor_of :Maria , :Diego .

:Maria :works_in :MyDepartment .

:Diego :works_in :MyDepartment .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an RDF instance <code>i</code> is related to <code>j</code> via the
property <code>manages</code> and <code>k</code> is related to <code>j</code> via the property <code>works_in</code>, then
<code>i</code> must be related to <code>k</code> via the property <code>is_supervisor_of</code>. In  A, <code>Jose</code> is
related to <code>MyDepartment</code> via <code>manages</code>, <code>Diego</code> is related to <code>MyDepartment</code>
via <code>works_in</code>, but <code>Jose</code> is not related to <code>Diego</code> via any property, so A is
invalid. In B, <code>Jose</code> is related to <code>Maria</code> and <code>Diego</code>--who are both related to
<code>MyDepartment</code> by way of <code>works_in</code>--via the property <code>is_supervisor_of</code>, so B
is valid.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="complex-constraints">Complex Constraints</h3>
<div class="paragraph">
<p>Constrains may be arbitrarily complex and include many conditions.</p>
</div>
<div class="sect3">
<h4 id="employee-constraints">Employee Constraints</h4>
<div class="paragraph">
<p>Each employee works on at least one project, or supervises at least
one employee that works on at least one project, or manages at least one
department.</p>
</div>
<div class="sect4">
<h5 id="constraint-13">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql"># Constraint in Terp syntax:
# how are you not loving Terp by now?!
# :Employee rdfs:subClassOf (:works_on some (:Project or
   (:supervises some (:Employee and (:works_on some :Project))) or (:manages some :Department)))

:Employee rdfs:subClassOf
              [ a owl:Restriction ;
                owl:onProperty :works_on ;
                owl:someValuesFrom
                        [ owl:unionOf (:Project
                                      [ a owl:Restriction ;
                                        owl:onProperty :supervises ;
                                        owl:someValuesFrom
                                              [ owl:intersectionOf (:Employee
                                                                    [ a owl:Restriction ;
                                                                      owl:onProperty :works_on ;
                                                                      owl:someValuesFrom :Project
                                                                    ])
                                              ]
                                      ]
                                      [ a owl:Restriction ;
                                        owl:onProperty :manages ;
                                        owl:someValuesFrom :Department
                                      ])
                        ]
              ] .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-invalid-7">Database A (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Esteban a :Employee .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-invalid-6">Database B (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Esteban a :Employee ;
	:supervises :Lucinda .

:Lucinda a :Employee .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-valid-3">Database C (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Esteban a :Employee ;
	:supervises :Lucinda .

:Lucinda a :Employee ;
	:works_on :MyProject .

:MyProject a :Project .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-d-valid-3">Database D (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Esteban a :Employee ;
	:manages :MyDepartment .

:MyDepartment a :Department .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-e-valid-2">Database E (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:Esteban a :Employee ;
	:manages :MyDepartment ;
	:works_on :MyProject .

:MyDepartment a :Department .

:MyProject a :Project .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an individual <code>i</code> is an instance of
<code>Employee</code>, then at least one of three conditions must be met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it is related to an instance of <code>Project</code> via the property <code>works_on</code></p>
</li>
<li>
<p>it is related to an instance <code>j</code> via the property <code>supervises</code> and <code>j</code> is an
instance of <code>Employee</code> and is also related to some instance of <code>Project</code> via
the property <code>works_on</code></p>
</li>
<li>
<p>it is related to an instance of <code>Department</code> via the property <code>manages</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A and B are invalid because none of the conditions are met. C
meets the second condition: <code>Esteban</code> (who is an <code>Employee</code>) is related
to <code>Lucinda</code> via the property <code>supervises</code> whereas <code>Lucinda</code> is both an
<code>Employee</code> and related to <code>MyProject</code>, which is a <code>Project</code>, via the
property <code>works_on</code>. D meets the third condition: <code>Esteban</code> is related
to an instance of <code>Department</code>, namely <code>MyDepartment</code>, via the property
<code>manages</code>. Finally, E meets the first and the third conditions because
in addition to managing a department <code>Esteban</code> is also related an
instance of <code>Project</code>, namely <code>MyProject</code>, via the property <code>works_on</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="employees-and-us-government-funding">Employees and US government funding</h4>
<div class="paragraph">
<p>Only employees who are American citizens can work on a project that
receives funds from a US government agency.</p>
</div>
<div class="sect4">
<h5 id="constraint-14">Constraint</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql"># Constraint in Terp syntax:
# :Project and (:receives_funds_from some :US_Government_Agency))
               rdfs:subClassOf (inverse :works_on only (:Employee and (:nationality value "US")))

[ owl:intersectionOf (:Project
                       [ a owl:Restriction ;
                         owl:onProperty :receives_funds_from ;
                         owl:someValuesFrom :US_Government_Agency
                       ]) .
] rdfs:subClassOf
              [ a owl:Restriction ;
                owl:onProperty [owl:inverseOf :works_on] ;
                owl:allValuesFrom [ owl:intersectionOf (:Employee
                                                        [ a owl:Restriction ;
                                                          owl:hasValue "US" ;
                                                          owl:onProperty :nationality
                                                        ])
                                  ]
              ] .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-a-valid-7">Database A (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project ;
	:receives_funds_from :NASA .

:NASA a :US_Government_Agency</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-b-invalid-7">Database B (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project ;
	:receives_funds_from :NASA .

:NASA a :US_Government_Agency .

:Andy a :Employee ;
	:works_on :MyProject .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-c-valid-4">Database C (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project ;
	:receives_funds_from :NASA .

:NASA a :US_Government_Agency .

:Andy a :Employee ;
	:works_on :MyProject ;
	:nationality "US" .</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-d-invalid-2">Database D (invalid)</h5>
<div class="listingblock">
<div class="content">
<pre>[source,sparql]
:MyProject a :Project ;
	:receives_funds_from :NASA .

:NASA a :US_Government_Agency .

:Andy a :Employee ;
	:works_on :MyProject ;
	:nationality "US" .

:Heidi a :Supervisor ;
	:works_on :MyProject ;
	:nationality "US" .</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database-e-valid-3">Database E (valid)</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-sparql" data-lang="sparql">:MyProject a :Project ;
	:receives_funds_from :NASA .

:NASA a :US_Government_Agency .

:Andy a :Employee ;
	:works_on :MyProject ;
	:nationality "US" .

:Heidi a :Supervisor ;
	:works_on :MyProject ;
	:nationality "US" .

:Supervisor rdfs:subClassOf :Employee .
    SubClassOf: Employee</code></pre>
</div>
</div>
<div class="paragraph">
<p>This constraint says that if an individual <code>i</code> is an instance of <code>Project</code> and
is related to an instance of <code>US_Government_Agency</code> via the property
<code>receives_funds_from</code>, then any individual <code>j</code> which is related to <code>i</code> via the
property <code>works_on</code> must satisfy two conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it must be an instance of <code>Employee</code></p>
</li>
<li>
<p>it must not be related to any literal other than <code>"US"</code> via the data property
<code>nationality</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A is valid because there is no individual related to <code>MyProject</code> via <code>works_on</code>,
so the constraint is trivially satisfied. B is invalid since <code>Andy</code> is related
to <code>MyProject</code> via <code>works_on</code>, <code>MyProject</code> is an instance of <code>Project</code> and is
related to an instance of <code>US_Government_Agency</code>, that is, <code>NASA</code>, via
<code>receives_funds_from</code>, but <code>Andy</code> does not have any data property assertions. C
is valid because both conditions are met. D is not valid because <code>Heidi</code>
violated the first condition: she is related to <code>MyProject</code> via <code>works_on</code> but
is not known to be an instance of <code>Employee</code>. Finally, this is fixed in E&#8212;&#8203;by
way of a handy OWL axiom&#8212;&#8203;which states that every instance of <code>Supervisor</code> is an
instance of <code>Employee</code>, so <code>Heidi</code> is inferred to be an instance of <code>Employee</code>
and, consequently, E is valid.<span class="footnote">[<a id="_footnoteref_36" class="footnote" href="#_footnote_36" title="View footnote.">36</a>]</span></p>
</div>
<div class="paragraph">
<p>If you made it this far, you deserve a drink!</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="explaining-icv-violations">Explaining ICV Violations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ICV violations can be explained using Stardog&#8217;s <a href="/owl2#sd-Proof-Trees">proof
trees</a>. The following command will explain the IC violations for constraints
stored in the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">$ stardog icv explain --reasoning EL "myDB"</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to explain violations for external constraints by passing the
file with constraints as an additional argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">$ stardog icv explain --reasoning EL "myDB" constraints.ttl</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-icv-programmatically">Using ICV Programmatically</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here we describe how to use Stardog ICV via the SNARL APIs. For
more information on using SNARL in general, please refer to the
chapter on <a href="/java">programming Stardog with Java</a>.</p>
</div>
<div class="paragraph">
<p>There is command-line interface support for many of the operations
necessary to using ICV with a Stardog database; please see the
<a href="/admin">Admin</a> chapter for that documentation.</p>
</div>
<div class="paragraph">
<p>To use ICV in Stardog, one must:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>create some constraints</p>
</li>
<li>
<p>associate those constraints with a Stardog database</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="creating-constraints">Creating Constraints</h3>
<div class="paragraph">
<p><a href="../java/snarl/com/complexible/stardog/icv/Constraint.html"><code>Constraints</code></a>
can be created using the
<a href="../java/snarl/com/complexible/stardog/icv/ConstraintFactory.html"><code>ConstraintFactory</code></a>
which provides methods for creating integrity constraints. <code>ConstraintFactory</code>
expects your constraints, if they are defined as OWL axioms, as RDF triples (or
graph). To aid in authoring constraints in OWL,
<a href="../java/snarl/com/complexible/common/openrdf/util/ExpressionFactory.html"><code>ExpressionFactory</code></a>
is provided for building the <a href="http://www.w3.org/TR/owl2-mapping-to-rdf/">RDF
equivalent</a> of the OWL axioms of your constraint.</p>
</div>
<div class="paragraph">
<p>You can also write your constraints in OWL in your favorite editor and load them into the database from your OWL file.</p>
</div>
<div class="paragraph">
<p>We recommend defining your constraints as OWL axioms, but you are free
to define them using SPARQL <code>SELECT</code> queries. If you choose to define a
constraint using a SPARQL <code>SELECT</code> query, please keep in mind that if your
query returns results, those are interpreted as the violations of the
integrity constraint.</p>
</div>
<div class="paragraph">
<p>An example of creating a simple constraint using <code>ExpressionFactory</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">URI Product = ValueFactoryImpl.getInstance().createURI("urn:Product");
URI Manufacturer = ValueFactoryImpl.getInstance().createURI("urn:Manufacturer");
URI manufacturedBy = ValueFactoryImpl.getInstance().createURI("urn:manufacturedBy");

// we want to say that a product should be manufactured by a Manufacturer:
Constraint aConstraint = ConstraintFactory.constraint(subClassOf(Product,
                                                                 some(manufacturedBy, Manufacturer)));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-constraints-to-stardog">Adding Constraints to Stardog</h3>
<div class="paragraph">
<p>The
<a href="../java/snarl/com/complexible/stardog/icv/api/ICVConnection.html">ICVConnection</a>
interface provides programmatic access to the ICV support in Stardog. It
provides support for adding, removing and clearing integrity constraints in your
database as well as methods for checking whether or not the data is valid; and
when it&#8217;s not, retrieving the list of violations.</p>
</div>
<div class="paragraph">
<p>This example shows how to add an integrity constraint to a Stardog
database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">// We'll start out by creating a validator from our SNARL Connection
ICVConnection aValidator = aConn.as(ICVConnection.class);

// add add a constraint, which must be done in a transaction.
aValidator.addConstraint(aConstraint);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we show how to add a set of constraints as defined in a local OWL
ontology.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">// We'll start out by creating a validator from our SNARL Connection
ICVConnection aValidator = aConn.as(ICVConnection.class);

// add add a constraint
aValidator.addConstraints()
	.format(RDFFormat.RDFXML)
	.file(new File("myConstraints.owl"));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ic-validation">IC Validation</h3>
<div class="paragraph">
<p>Checking whether or not the contents of a database are valid is easy. Once you
have an
<a href="../java/snarl/com/complexible/stardog/icv/api/ICVConnection.html"><code>ICVConnection</code></a>
you can simply call its
<a href="../java/snarl/com/complexible/stardog/icv/api/ICVConnection.html#isValid(&#41;"><code>isValid()</code></a>
method which will return whether or not the contents of the database are valid
with respect to the constraints associated with that database. Similarly, you
can provide some
<a href="../java/snarl/com/complexible/stardog/icv/Constraint.html"><code>constraints</code></a> to
the <code>isValid()</code> method to see if the data in the database is invalid for those
specific constraints; which can be a subset of the constraints associated
with the database, or they can be new constraints you are working on.</p>
</div>
<div class="paragraph">
<p>If the data is invalid for some constraints—either the explicit
constraints in your database or a new set of constraints you have
authored—you can get some information about what the violation was from
the SNARL IC Connection.
<a href="../java/snarl/com/complexible/stardog/icv/api/ICVConnection.html#getViolationBindings(&#41;"><code>ICVConnection.getViolationBindings()</code></a>
will return the constraints which are violated, and for each constraint,
you can get the violations as the set of bindings that satisfied the
constraint query. You can turn the bindings into the individuals which
are in the violation using
<a href="../java/snarl/com/complexible/stardog/icv/ICV.html#asIndividuals(&#41;"><code>ICV.asIndividuals()</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="icv-and-transactions">ICV and Transactions</h3>
<div class="paragraph">
<p>In addition to using the ICConnection a data oracle to tell whether or
not your data is valid with respect to some constraints, you can also
use Stardog&#8217;s ICV support to protect your database from invalid data by
using ICV as a guard within transactions.</p>
</div>
<div class="paragraph">
<p>When guard mode for ICV is enabled in Stardog, each commit is inspected
to ensure that the contents of the database are valid for the set of
constraints that have been associated with it. Should someone attempt to
commit data which violates one or more of the constraints defined for
the database, the commit will fail and the data will not be
added/removed from your database.</p>
</div>
<div class="paragraph">
<p>By default, reasoning is not used when you enable guard mode, however
you are free to specify any of the reasoning types supported by Stardog
when enabling guard mode. If you have provided a specific reasoning type
for guard mode it will be used during validation of the integrity
constraints. This means you can author your constraints with the
expectation of inference results satisfying a constraint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">AdminConnection dbms = AdminConnectionConfiguration.toEmbeddedServer().credentials("admin", "admin").connect();

dbms.disk("icvWithGuard")			// disk db named 'icvWithGuard'
    .set(DatabaseOptions.ICV_ENABLED, true)	// enable icv guard mode
    .set(DatabaseOptions.ICV_REASONING_TYPE, ReasoningType.QL)	// specify the reasoning level icv guard should use
    .create(new File("data/sp2b_10k.n3"));	// create the db, bulk loading the file(s) to start

dbms.close();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This illustrates how to create a persistent disk database with ICV guard
mode enabled at the QL reasoning type. Guard mode can also be enabled
when the database is created on the [command line](../admin)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="terminology-2">Terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter may make more sense if you read this section on terminology a few
times.</p>
</div>
<div class="sect2">
<h3 id="icv-integrity-constraint-validation">ICV, Integrity Constraint Validation</h3>
<div class="paragraph">
<p>The process of checking whether some Stardog database is valid with
respect to some integrity constraints. The result of ICV is a boolean
value (true if valid, false if invalid) and, optionally, an <code>explanation
of constraint violations</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="schema-tbox">Schema, TBox</h3>
<div class="paragraph">
<p>A schema (or "terminology box" a.k.a., TBox) is a set of statements that
define the relationships between data elements, including property and
class names, their relationships, etc. In practical terms, schema
statements for a Stardog database are RDF Schema and OWL 2 terms,
axioms, and definitions.</p>
</div>
</div>
<div class="sect2">
<h3 id="data-abox">Data, ABox</h3>
<div class="paragraph">
<p>All of the triples in a Stardog database that aren&#8217;t part of the schema
are part of the data (or "assertional box" a.k.a. ABox).</p>
</div>
</div>
<div class="sect2">
<h3 id="integrity-constraint">Integrity Constraint</h3>
<div class="paragraph">
<p>A declarative expression of some rule or constraint which data must
conform to in order to be valid. Integrity Constraints are typically
domain and application specific. They can be expressed in OWL 2 (any
legal syntax), SWRL rules, or (a restricted form of) SPARQL queries.</p>
</div>
</div>
<div class="sect2">
<h3 id="constraints">Constraints</h3>
<div class="paragraph">
<p>Constraints that have been associated with a Stardog database and which
are used to validate the data it contains. Each Stardog may optionally
have one and only one set of constraints associated with it.</p>
</div>
</div>
<div class="sect2">
<h3 id="closed-world-assumption-closed-world-reasoning">Closed World Assumption, Closed World Reasoning</h3>
<div class="paragraph">
<p>Stardog ICV assumes a closed world with respect to data and constraints:
that is, it assumes that all relevant data is known to it and included
in a database to be validated. It interprets the meaning of Integrity
Constraints in light of this assumption; if a constraint says a value
<code>must</code> be present, the absence of that value is interpreted as a
constraint violation and, hence, as invalid data.</p>
</div>
</div>
<div class="sect2">
<h3 id="open-world-assumption-open-world-reasoning">Open World Assumption, Open World Reasoning</h3>
<div class="paragraph">
<p>A legal OWL 2 inference may violate or satisfy an Integrity Constraint
in Stardog. In other words, you get to have your cake (OWL as a
constraint language) and eat it, too (OWL as modeling or inference
language). This means that constraints are applied to a Stardog database
<code>with respect to an OWL 2 profile</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="monotonicity">Monotonicity</h3>
<div class="paragraph">
<p>OWL is a monotonic language: that means you can never <code>add</code> anything to a
Stardog database that causes there to be <code>fewer</code> legal inferences. Or, put
another way, the only way to decrease the number of legal inferences is
to <code>delete</code> something.</p>
</div>
<div class="paragraph">
<p>Monotonicity interacts with ICV in the following ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adding data to or removing it from a Stardog database may make it
invalid.</p>
</li>
<li>
<p>Adding schema statements to or removing them from a Stardog database
may make it invalid.</p>
</li>
<li>
<p>Adding new constraints to a Stardog database may make it invalid.</p>
</li>
<li>
<p>Deleting constraints from a Stardog database <code>cannot make it
invalid</code>.</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>quote: "It goes against the grain of modern education to teach children to program. What fun is there in making plans, acquiring discipline in organizing thoughts, devoting attention to detail and learning to be self-critical?"
title: Programming with Spring
shortTitle: Spring
layout: default
toc: true
---</p>
</div>
<div class="paragraph">
<p>The Spring for Stardog [source code](<a href="http://github.com/clarkparsia/stardog-spring" class="bare">http://github.com/clarkparsia/stardog-spring</a>) is available on Github.</p>
</div>
<div class="paragraph">
<p>Binary releases are available on the [Github release page](<a href="https://github.com/clarkparsia/stardog-spring/releases" class="bare">https://github.com/clarkparsia/stardog-spring/releases</a>).</p>
</div>
<div class="paragraph">
<p>As of 2.1.3, Stardog-Spring and Stardog-Spring-Batch can both be retrieved from Maven central:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>com.complexible.stardog:stardog-spring:2.1.3</code></p>
</li>
<li>
<p><code>com.complexible.stardog:stardog-spring-batch:2.1.3</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The corresponding Stardog Spring version will match the Stardog release, e.g. stardog-spring-2.2.2 for Stardog 2.2.2.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring for Stardog makes it possible to rapidly build Stardog-backed applications with the Spring Framework. As with many other parts of Spring, Stardog&#8217;s Spring
integration uses the template design pattern for abstracting standard
boilerplate away from application developers.</p>
</div>
<div class="paragraph">
<p>Stardog Spring can be included via Maven with "com.complexible.stardog:stardog-spring:version" and "com.complexible.stardog:stardog-spring-batch" for Spring Batch support.  Both of these dependencies require the local "mavenInstall" script be run,
and the Stardog Spring packages installed in Maven.  Embedded server is still supported, but via providing an implementatino of the Provider interface.
This enables users of the embedded server to have full control over how to use the embedded server.</p>
</div>
<div class="paragraph">
<p>At the lowest level, Spring for Stardog includes</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>DataSouce</code> and <code>DataSourceFactoryBean</code> for managing Stardog
connections</p>
</li>
<li>
<p><code>SnarlTemplate</code> for transaction- and connection-pool safe Stardog
programming</p>
</li>
<li>
<p><code>DataImporter</code> for easy bootstrapping of input data into Stardog</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In addition to the core capabilities, Spring for Stardog also integrates
with the Spring Batch framework. Spring Batch enables complex batch
processing jobs to be created to accomplish tasks such as ETL or legacy
data migration. The standard ItemReader and ItemWriter interfaces are
implemented with a separate callback writing records using the SNARL
Adder API.</p>
</div>
<div class="paragraph">
<p>Future releases of Spring for Stardog will address other command
enterprise capabilities: Spring Integration, Spring Data, etc.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building-spring-for-stardog">Building Spring for Stardog</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To build Spring for Stardog, you need a release of Stardog; we use
[Gradle](<a href="http://www.gradle.org/" class="bare">http://www.gradle.org/</a>) to build Stardog for Spring.  Gradle 1.9 is the preferred version. Then,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>edit <code>build.gradle</code> to point <code>stardogLocation</code> at a Stardog release
directory;</p>
</li>
<li>
<p>run <code>gradlew</code>, which will download and bootstrap a gradle build
environment;</p>
</li>
<li>
<p>then run <code>gradlew build</code>, which eventually results in a
<code>stardog-spring.jar</code> in <code>build/libs</code>; finally,</p>
</li>
<li>
<p><code>gradlew install</code> does a build, generates a POM, and installs the
POM in local Maven repo; alternately, though generally you should use the latest from Maven Central.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: The stardogLocation and "fileTree" dependency is included in development of Stardog Spring, as a local embedded server is used for automated testing.  Before running the build, you should edit the "CHANGE" areas in teh build file to point to your local Stardog instance.  See the README on the respective Github projects for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="basic-spring">Basic Spring</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are three Beans to add to a Spring application context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DataSourceFactoryBean</code>: <code>com.clarkparsia.stardog.ext.spring.DataSourceFactoryBean</code></p>
</li>
<li>
<p><code>SnarlTemplate</code>: <code>com.clarkparsia.stardog.ext.spring.SnarlTemplate</code></p>
</li>
<li>
<p><code>DataImporter</code>: <code>com.clarkparsia.stardog.ext.spring.DataImporter</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>DataSourceFactoryBean</code> is a Spring <code>FactoryBean</code> that configures and
produces a <code>DataSource</code>. All of the Stardog <code>ConnectionConfiguration</code>
and <code>ConnectionPoolConfig</code> methods are also property names of the
<code>DataSourceFactoryBean</code>--for example, "to", "url", "createIfNotPresent".</p>
</div>
<div class="paragraph">
<p><code>DataSource</code> is a Spring for Stardog class, similar to
<code>javax.sql.DataSource</code>, that can be used to retrieve a <code>Connection</code> from
the <code>ConnectionPool</code>. This additional abstraction serves as place to add
Spring-specific capabilities (e.g. <code>spring-tx</code> support in the future)
without directly requiring Spring in Stardog.</p>
</div>
<div class="paragraph">
<p><code>SnarlTemplate</code> provides a template abstraction over much of Stardog&#8217;s
native API, [SNARL](/java), and follows the same approach of other
Spring template, i.e., <code>JdbcTemplate</code>, <code>JmsTemplate</code>, and so on.</p>
</div>
<div class="paragraph">
<p>Spring for Stardog also comes with convenience mappers, for
automatically mapping result set bindings into common data types. The
<code>SimpleRowMapper</code> projects the <code>BindingSet</code> as a <code>List&gt;</code> and a
<code>SingleMapper</code> that accepts a constructor parameter for binding a single
parameter for a single result set.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;4570152?file=SingleMapper.java&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>The key methods on <code>SnarlTemplate</code> include the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>query(String sparqlQuery, Map args, RowMapper)</pre>
</div>
</div>
<div class="paragraph">
<p><code>query()</code> executes the SELECT query with provided argument list, and
invokes the mapper for result rows.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>doWithAdder(AdderCallback)</pre>
</div>
</div>
<div class="paragraph">
<p><code>doWithAdder()</code> is a transaction- and connection-pool safe adder call.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>doWithGetter(String subject, String predicate, GetterCallback)</pre>
</div>
</div>
<div class="paragraph">
<p><code>doWithGetter()</code> is the connection pool boilerplate method for the
<code>Getter</code> interface, including the programmatic filters.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>doWithRemover(RemoverCallback)</pre>
</div>
</div>
<div class="paragraph">
<p><code>doWithRemover()</code> As above, the remover method that is transaction and
pool safe.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>execute(ConnectionCallback)</pre>
</div>
</div>
<div class="paragraph">
<p><code>execute()</code> lets you work with a connection directly; again, transaction
and pool safe.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>construct(String constructSparql, Map args, GraphMapper)</pre>
</div>
</div>
<div class="paragraph">
<p><code>construct()</code> executes a SPARQL CONSTRUCT query with provided argument
list, and invokes the <code>GraphMapper</code> for the result set.</p>
</div>
<div class="paragraph">
<p><code>DataImporter</code> is a new class that automates the loading of RDF files
into Stardog at initialization time.</p>
</div>
<div class="paragraph">
<p>It uses the Spring Resource API, so files can be loaded anywhere that is
resolvable by the Resource API: classpath, file, url, etc. It has a
single load method for further run-time loading and can load a list of
files at initialization time. The list assumes a uniform set of file
formats, so if there are many different types of files to load with
different RDF formats, there would be different <code>DataImporter</code> beans
configured in Spring.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a sample <code>applicationContext</code>:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;1115889?file=applicationContext.xml&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>Another example with reasoning and credentials set in the factory bean:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;8747480?file=stardog-spring.xml&lt;/gist&gt;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-batch">Spring Batch</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to the base <code>DataSource</code> and <code>SnarlTemplate</code>, Spring Batch
support adds the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SnarlItemReader</code>:
<code>com.clarkparsia.stardog.ext.spring.batch.SnarlItemReader</code></p>
</li>
<li>
<p><code>SnarlItemWriter</code>:
<code>com.clarkparsia.stardog.ext.spring.batch.SnarlItemWriter</code></p>
</li>
<li>
<p><code>BatchAdderCallback</code>:
<code>com.clarkparsia.stardog.ext.spring.batch.BatchAdderCallback</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These beans can then be used within Spring Batch job definition, for
example:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;4570209?file=batchContext.xml&lt;/gist&gt;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples-4">Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="query-with-select-queries">query() with SELECT queries</h3>
<div class="paragraph">
<p>&lt;gist&gt;1115894?file=spring-select.java&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="dowithgetter">doWithGetter</h3>
<div class="paragraph">
<p>&lt;gist&gt;1115915?file=dowithgetter.java&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="dowithadder">doWithAdder</h3>
<div class="paragraph">
<p>&lt;gist&gt;1115915?file=doWithAdder.java&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="dowithremover">doWithRemover</h3>
<div class="paragraph">
<p>&lt;gist&gt;1115915?file=doWithRemover.java&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="construct">construct()</h3>
<div class="paragraph">
<p>&lt;gist&gt;1115915?file=construct.java&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="update">update()</h3>
<div class="paragraph">
<p>&lt;gist&gt;7846171?file=StardogSpringUpdate.java&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="ask">ask()</h3>
<div class="paragraph">
<p>&lt;gist&gt;7846198?file=StardogSpringAsk.java&lt;/gist&gt;</p>
</div>
<hr>
<div class="paragraph">
<p>quote: Making something variable is easy. Controlling duration of constancy is the trick.
title: Programming with Groovy
shortTitle: Groovy
layout: default
toc: true
---</p>
</div>
<div class="paragraph">
<p>[Groovy](<a href="http://http://groovy.codehaus.org//" class="bare">http://http://groovy.codehaus.org//</a>) is an agile and dynamic
programming language for the JVM, making popular programming features
such as closures available to Java developers. Stardog&#8217;s Groovy support
makes life easier for developers who need to work with RDF, SPARQL, and
OWL by way of Stardog.</p>
</div>
<div class="paragraph">
<p>The Groovy for Stardog [source code](<a href="http://github.com/clarkparsia/stardog-groovy" class="bare">http://github.com/clarkparsia/stardog-groovy</a>) is available on Github.</p>
</div>
<div class="paragraph">
<p>Binary releases are available on the [Github release page](<a href="https://github.com/clarkparsia/stardog-groovy/releases" class="bare">https://github.com/clarkparsia/stardog-groovy/releases</a>) and via Maven central as of version 2.1.3 and beyond using the following dependency declaration (Gradle style) <code>com.complexible.stardog:stardog-groovy:2.1.3</code>.</p>
</div>
<div class="paragraph">
<p>As of version 2.1.3, Stardog-Groovy can be included via "com.complexible.stardog:stardog-groovy:2.1.3" from Maven central.  Note that you must run "mavenInstall" to get the Stardog client dependencies into your local repository.  Using the embedded server with Stardog Groovy is not supported in 2.1.2, due to conflicts of the asm library for various third party dependencies.  If you wish to use the embedded server with similar convenience APIs, please try [Stardog Spring](<a href="http://docs.stardog.com/spring/" class="bare">http://docs.stardog.com/spring/</a>). Also 2.1.3 and beyond of Stardog-Groovy no longer requires the use of the Spring framework.</p>
</div>
<div class="paragraph">
<p>The Stardog-Groovy version always matches the Stardog release, e.g. for Stardog 2.2.2 use stardog-groovy-2.2.2.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview-2">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Groovy for Stardog &lt;t&gt;springVersion&lt;/t&gt; provides a set of Groovy API
wrappers for developers to build applications with Stardog and take
advantage of native Groovy features. For example, you can create a
Stardog connection pool in a single line, much like Groovy SQL support.
In Groovy for Stardog, queries can be iterated over using closures and
transaction safe closures can be executed over a connection.</p>
</div>
<div class="paragraph">
<p>For the first release, Groovy for Stardog includes
<code>com.clarkparsia.stardog.ext.groovy.Stardog</code> with the following methods:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Stardog(map)</code> constructor for managing Stardog connection pools</p>
</li>
<li>
<p><code>each(String, Closure)</code> for executing a closure over a query&#8217;s
results, including projecting SPARQL result variables into the
closure.</p>
</li>
<li>
<p><code>query(String, Closure)</code> for executing a closure over a query&#8217;s
results, passing the BindingSet to the closure</p>
</li>
<li>
<p><code>insert(List)</code> for inserting a list of vars as a triple, or a list
of list of triples for insertion</p>
</li>
<li>
<p><code>remove(List)</code> for removing a triple from the database</p>
</li>
<li>
<p><code>withConnection</code> for executing a closure with a transaction safe
instance of
[Connection](<a href="http://stardog.com/docs/java/snarl/com/clarkparsia/stardog/api/Connection.html" class="bare">http://stardog.com/docs/java/snarl/com/clarkparsia/stardog/api/Connection.html</a>)</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building-groovy-for-stardog">Building Groovy for Stardog</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To build Groovy for Stardog, you need a release of Stardog; we use
[Gradle](<a href="http://www.gradle.org/" class="bare">http://www.gradle.org/</a>) to build Stardog for Groovy.  Gradle 1.9 is the preferred version to use. Then,</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download and run a Stardog server with a "testdb", used for testing.</p>
</li>
<li>
<p>run <code>gradlew build</code>, which eventually results in a
<code>stardog-groovy.jar</code> in <code>build/libs</code>; finally,</p>
</li>
<li>
<p><code>gradlew install</code> does a build, generates a POM, and installs the
POM in local Maven repo; however you should generally use the version from Maven Central.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples-5">Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here are some examples of the more interesting parts of Stardog Groovy.</p>
</div>
<div class="sect2">
<h3 id="create-a-connection">Create a Connection</h3>
<div class="paragraph">
<p>&lt;gist&gt;4652565?file=StardogConnection.groovy&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="sparql-vars-projected-into-groovy-closures">SPARQL Vars Projected into Groovy Closures</h3>
<div class="paragraph">
<p>&lt;gist&gt;4652590?file=Projection.groovy&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="add-remove-triples">Add &amp; Remove Triples</h3>
<div class="paragraph">
<p>&lt;gist&gt;4652608?file=StardogAddRemove.groovy&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="code-withconnection-code-closure"><code>withConnection</code> Closure</h3>
<div class="paragraph">
<p>&lt;gist&gt;4652621?file=StardogWithConnection.groovy&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="sparql-update-support">SPARQL Update Support</h3>
<div class="paragraph">
<p>&lt;gist&gt;7862684?file=StardogGroovyUpdate.groovy&lt;/gist&gt;</p>
</div>
<hr>
<div class="paragraph">
<p>quote: Syntactic sugar causes cancer of the semicolon.
layout: "default"
title: Programming with .Net
shortTitle: .Net
toc: true
---</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction-4">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the [Network Programming](../network/) chapter, we looked at
how to interact with Stardog over a network via HTTP and SNARL
protocols.  In this chapter we describe how to program Stardog
from .Net using [dotNetRDF](<a href="http://www.dotnetrdf.org" class="bare">http://www.dotnetrdf.org</a>).</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: this is an open source library developed and supported by third parties;
questions or issues with the .Net API should be directed to
[dotNetRDF](<a href="http://www.dotnetrdf.org" class="bare">http://www.dotnetrdf.org</a>).</p>
</div>
<div class="paragraph">
<p>You should also be aware that dotNetRDF uses the HTTP API for all
communication with Stardog so you <strong>must</strong> enable
the HTTP server to use Stardog from .Net. It&#8217;s enabled by
default so most users should not need to do anything to fulfill
this requirement.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re a Java developer see the [Programming with Java](../java)
chapter.  Alternatively If you&#8217;re a Spring developer, you might want
to read the [Programming with Spring](../spring) chapter.  If you
prefer a ORM-style approach, you might want to use
[Empire](<a href="https://github.com/mhgrove/Empire" class="bare">https://github.com/mhgrove/Empire</a>), which is an implementation
of [JPA](<a href="http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html" class="bare">http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html</a>)
for RDF that works with Stardog.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-administering-databases-2">Creating &amp; Administering Databases</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>StardogServer</code> class provides some limited administrative functionality by
implementing the dotNetRDF [Servers API][]</p>
</div>
<div class="paragraph">
<p>dotNetRDF actually provides several classes for administering a Stardog server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>[StardogServer](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.StardogServer" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.StardogServer</a>) - Connection for the current version of Stardog</p>
</li>
<li>
<p>[StardogV2Server](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.StardogV2Server" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.StardogV2Server</a>) - Connection for Stardog V2 servers</p>
</li>
<li>
<p>[StardogV1Server](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.StardogV1Server" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.StardogV1Server</a>) - Connection for Stardog V1 servers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This provides backwards compatibility for users who wish to communicate with
older versions of Stardog.  Using the wrong connector for the version of
Stardog you are running may result in errors.</p>
</div>
<div class="paragraph">
<p>[Servers API]: <a href="https://bitbucket.org/dotnetrdf/dotnetrdf/wiki/UserGuide/Storage/Servers" class="bare">https://bitbucket.org/dotnetrdf/dotnetrdf/wiki/UserGuide/Storage/Servers</a></p>
</div>
<div class="sect2">
<h3 id="creating-a-database-3">Creating a Database</h3>
<div class="paragraph">
<p>You can create a basic disk-backed database with Stardog with one line of code:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5732640&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>It is important to note that, as shown in the examples, you <strong>should</strong> take care
to always dispose of the <code>IStorageServer</code> and/or <code>IStorageProvider</code> instances you
create when you are done working with them.</p>
</div>
<div class="paragraph">
<p>You can also use the <code>StardogDiskTemplate</code> or <code>StardogMemTemplate</code> to configure a
disk or memory-backed database with whatever options you desire; they both derive
from <code>BaseStardogTemplate</code> which contains many properties that can be used
to configure Stardog database options:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5732680&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>This illustrates how to create a disk backed database named 'id' which supports
[full text search](../using/#sd-Searching) and has durable transactions
enabled.</p>
</div>
<div class="paragraph">
<p>The following shows how to create a disk backed database with ICV guard mode enabled
 at the QL reasoning type.  For more information on what the available
properties are see [BaseStardogTemplate](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.Provisioning.Stardog.BaseStardogTemplate" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.Management.Provisioning.Stardog.BaseStardogTemplate</a>),
for what they mean to Stardog please refer to the [admin docs](../admin/),
specifically the section on administering a database.</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5732690&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>For performing other basic administrative tasks via dotNetRDF please refer to the
[Servers API][] documentation. Also note, Stardog database administration can be performed from the
[command line](../admin/) which is substantially more powerful and
supports bulk loading of data at database creation time which
dotNetRDF does not currently support.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-to-a-database">Connecting to a Database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Connecting to a database can be done using the dotNetRDF [Storage API][],
this provides a [StardogConnector](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogConnector" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogConnector</a>)
which implements their <code>IStorageProvider</code> interface.</p>
</div>
<div class="paragraph">
<p>Making a connection requires at a minimum knowing the Base URI of your Stardog server
and the name of the database.  The Base URI is the HTTP URL that Stardog prints
out when you start up the server and is typically of the form <code><a href="http://machine:5820" class="bare">http://machine:5820</a></code>
where <code>machine</code> is replaced with the name of the host on which the server
is running and <code>5820</code> changed only if you have configured Stardog to run
on a different HTTP port than the default.  As Stardog implements comprehensive
[security](../security/), you will also likely require user credentials.</p>
</div>
<div class="paragraph">
<p>[Storage API]: <a href="https://bitbucket.org/dotnetrdf/dotnetrdf/wiki/UserGuide/Storage%20API" class="bare">https://bitbucket.org/dotnetrdf/dotnetrdf/wiki/UserGuide/Storage%20API</a></p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5732808&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>dotNetRDF actually provides several classes for connecting to a Stardog server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>[StardogConnector](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogConnector" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogConnector</a>) - Connection for the current version of Stardog</p>
</li>
<li>
<p>[StardogV2Connector](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogV2Connector" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogV2Connector</a>) - Connection for Stardog V2 servers</p>
</li>
<li>
<p>[StardogV1Connector](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogV1Connector" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.StardogV1Connector</a>) - Connection for Stardog V1 servers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This provides backwards compatibility for users who wish to communicate with older
versions of Stardog.  Using the wrong connector for the version of Stardog you
are running may result in errors.</p>
</div>
<div class="paragraph">
<p>Connections to Stardog also allow you to specify the reasoning mode used for queries
as part of the connection information like so:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5732812&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>Note that is it possible to change the reasoning mode used at any time by
changing the value of the <code>Reasoning</code> property, <em>though remember that this
only affects subsequently issued queries i.e. it does not affect queries
that are already in-flight</em>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-storage-api">Using the Storage API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section covers how to carry out various common operations against Stardog
using dotNetRDF&#8217;s [Storage API][], you may wish to refer to their
[Triple Store Integration][] documentation for some more generic examples of
using this API.</p>
</div>
<div class="paragraph">
<p>[Triple Store Integration]: <a href="https://bitbucket.org/dotnetrdf/dotnetrdf/wiki/UserGuide/Triple%20Store%20Integration" class="bare">https://bitbucket.org/dotnetrdf/dotnetrdf/wiki/UserGuide/Triple%20Store%20Integration</a></p>
</div>
<div class="paragraph">
<p>When using this API transactions are primarily handled for you with the connection
operating in auto-commit mode by default, any write operations will automatically use
a new transaction and commit or roll it back as appropriate.</p>
</div>
<div class="paragraph">
<p>Transactions may be manually managed using the <code>Begin()</code>, <code>Commit()</code> and <code>Rollback()</code>
methods, and read operations will only use transactions when they run in the context of
an active transaction.</p>
</div>
<div class="sect2">
<h3 id="adding-data-2">Adding Data</h3>
<div class="paragraph">
<p>The simplest way to add data is to call the <code>SaveGraph()</code> method which saves a RDF
graph to the store.</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5786144&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>By default, RDF added will go to the named graph corresponding to the <code>BaseUri</code>
property of the provided graph unless it is <code>null</code> in which case it gets added
to the default graph.</p>
</div>
<div class="paragraph">
<p>When you use the <code>SaveGraph()</code> method the exact behaviour depends on the target
graph, saving to the default graph appends data while saving to named graph
overwrites data.  You can inspect the <code>IOBehaviour</code> property to see all flags
that apply to Stardog connectivity when used via dotNetRDF.</p>
</div>
</div>
<div class="sect2">
<h3 id="modifying-data">Modifying Data</h3>
<div class="paragraph">
<p>If you want to add or remove data from an existing graph, then you can use the
<code>UpdateGraph()</code> method, which takes a URI for the graph to update and collections
of triples to be added and removed.  <em>Note that removals are always processed
before additions</em>.</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5833189&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="loading-data">Loading Data</h3>
<div class="paragraph">
<p>Since the <code>IStorageProvider</code> API is primarily graph-oriented the simplest way
to load data is to load an entire graph from a database:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;5786161&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>If you need more fine grained control over loading data then you should make
an appropriate SPARQL Query as detailed later in this chapter.</p>
</div>
</div>
<div class="sect2">
<h3 id="removing-data-2">Removing Data</h3>
<div class="paragraph">
<p>As previously mentioned the <code>IStorageProvider</code> API is graph-oriented, you can
delete an entire graph from your Stardog database using the <code>DeleteGraph()</code>
method:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;7230262&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>Alternatively if you want to remove specific triples you should use the
<code>UpdateGraph()</code> method as already shown in the earlier Modifying Data section</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="making-sparql-queries">Making SPARQL Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can make a SPARQL query simply by calling the <code>Query()</code> method which is
from the [IQueryableStorage](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.IQueryableStorage" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.IQueryableStorage</a>)
interface.  SPARQL queries may be passed in directly as strings like so:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;7230219&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>We <strong>strongly</strong> recommend the use of the parameterized query support over
concatenating strings together in order to build your SPARQL query.  This
latter approach opens up the possibility for SPARQL injection attacks
unless you are very careful in scrubbing your input.  This can be done using
the [SparqlParameterizedString](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Query.SparqlParameterizedString" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Query.SparqlParameterizedString</a>)
class like so:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;7230407&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>dotNetRDF uses the ADO.Net style <code>@param</code> to specify parameters in the query string
which then must have values set for them using the relevant methods prior to calling
<code>ToString()</code> to retrieve the final query string.</p>
</div>
<div class="sect2">
<h3 id="reasoning-3">Reasoning</h3>
<div class="paragraph">
<p>Stardog supports various levels of reasoning by using a query rewriting technique.
In short, when reasoning is requested, a query is automatically rewritten into <strong>n</strong>
queries, which are then executed. As mentioned earlier reasoning is enabled at the
<code>StardogConnector</code> layer and then any queries executed over that connection are
executed with reasoning enabled; you don&#8217;t need to do anything up front when you
create your database if you want to use reasoning.  The in-use reasoning mode for
your connection may be changed at any time by setting the <code>Reasoning</code> property
appropriately.</p>
</div>
<div class="paragraph">
<p>For more information on how reasoning is supported in Stardog, check out the
[reasoning section](../owl2/)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="making-sparql-updates">Making SPARQL Updates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From dotNetRDF 1.0.3 onwards it is possible to make native SPARQL updates against Stardog
when using the <code>StardogV2Connector</code> or the <code>StardogConnector</code>.  SPARQL Updates are
made simply by calling the <code>Update()</code> method which is from the
[IUpdateableStorage](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.IUpdateableStorage" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Storage.IUpdateableStorage</a>)
interface.  SPARQL Updates may be passed in directly as strings like so:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;8019566&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>We <strong>strongly</strong> recommend the use of the parameterized update support over
concatenating strings together in order to build your SPARQL update.  This
latter approach opens up the possibility for SPARQL injection attacks
unless you are very careful in scrubbing your input.  This can be done using
the [SparqlParameterizedString](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Query.SparqlParameterizedString" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Query.SparqlParameterizedString</a>)
class like so:</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;8019591&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p>dotNetRDF uses the ADO.Net style <code>@param</code> to specify parameters in the query string
which then must have values set for them using the relevant methods prior to calling
<code>ToString()</code> to retrieve the final query string.</p>
</div>
<div class="sect2">
<h3 id="approximating-stardog-updates">Approximating Stardog Updates</h3>
<div class="paragraph">
<p>Even when using older versions of dotNetRDF or older versions of Stardog which do not
support SPARQL Update natively it is still possible to perform SPARQL Updates on
Stardog using dotNetRDF&#8217;s approximated update support.</p>
</div>
<div class="paragraph">
<p>To do this you create a [GenericUpdateProcessor](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Update.GenericUpdateProcessor" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Update.GenericUpdateProcessor</a>)
instance which wraps your <code>IStorageProvider</code> instance.  This provides a <code>ProcessCommandSet()</code>
method which takes in a [SparqlUpdateCommandSet](<a href="http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Update.SparqlUpdateCommandSet" class="bare">http://www.dotnetrdf.org/api/index.asp?Topic=VDS.RDF.Update.SparqlUpdateCommandSet</a>)
instance and executes it against the underlying store.  Where the underlying store does
not support SPARQL Update natively it does its best to translate the update commands into
their equivalent Storage API operations to execute the update as faithfully as possible.</p>
</div>
<div class="paragraph">
<p>&lt;gist&gt;8019694&lt;/gist&gt;</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> You can safely use the <code>GenericUpdateProcessor</code> even with newer versions of
dotNetRDF and Stardog where native SPARQL Update is supported since if the underlying
store supports SPARQL Update natively the <code>GenericUpdateProcessor</code> delegates execution
to the stores <code>Update()</code> method.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dotnetrdf-documentation-h2">dotNetRDF Documentation&lt;/h2&gt;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please see the [dotNetRDF API](<a href="http://www.dotnetrdf.org/api/" class="bare">http://www.dotnetrdf.org/api/</a>) docs for more detailed
information on the available APIs or see the [dotNetRDF User Guide](<a href="http://bitbucket.org/dotnetrdf/dotnetrdf/wiki/User%20Guide" class="bare">http://bitbucket.org/dotnetrdf/dotnetrdf/wiki/User%20Guide</a>)
for a more general overview of dotNetRDF.</p>
</div>
<hr>
<div class="paragraph">
<p>quote: It is better to have 100 functions operate on one data structure than 10 functions on 10 data structures.
title: Programming with Clojure
shortTitle: Clojure
layout: default
toc: true
---</p>
</div>
<div class="paragraph">
<p>[Clojure](<a href="http://clojure.org" class="bare">http://clojure.org</a>) is a Lisp for the JVM. Stardog&#8217;s Clojure support makes life easier for developers who need to work with RDF, SPARQL, and OWL by way of Stardog from Clojure. The Stardog-clj [source
code](<a href="http://github.com/clarkparsia/stardog-clj" class="bare">http://github.com/clarkparsia/stardog-clj</a>) is available on
Github and licensed under the Apache 2.0 license.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation">Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog-clj is available from Clojars.  To use, just include the following dependency:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[stardog-clj "2.2.2"]</pre>
</div>
</div>
<div class="paragraph">
<p>Starting with Stardog version 2.2.2, the stardog-clj version always matches the latest release of Stardog.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview-3">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Stardog-clj provides a set of functions as API wrappers to the native
SNARL API.  These functions provide the basis for working with Stardog,
starting with connection management, connection pooling, and the core parts
of the API, such as executing a SPARQL query or adding and removing RDF from
the Stardog database.  Over time, other parts of the Stardog API will be appropriately
wrapped with Clojure functions and idiomatic Clojure data structures.</p>
</div>
<div class="paragraph">
<p>Stardog-clj provides the following features:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Specification based descriptions for connections, and corresponding "connection" and "with-connection-pool" functions and macros</p>
</li>
<li>
<p>Functions for query, ask, graph, and update to execute SELECT, ASK, CONSTRUCT, and SPARQL-Update queries respectively</p>
</li>
<li>
<p>Functions for insert and remove, for orchestrating the Adder and Remover APIs in SNARL</p>
</li>
<li>
<p>Macros for resource handling, including with-connection-tx, with-connnection-pool, and with-transaction</p>
</li>
<li>
<p>Support for programming Stardog applications with either the connection pool or direct handling of the connection</p>
</li>
<li>
<p>Idiomatic clojure handling of data structures, with converters that can be passed to query functions</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The API with source docs can be found in the stardog.core and stardog.values namespaces.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-overview">API Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The API provides a natural progression of functions for interacting with Stardog</p>
</div>
<div class="paragraph">
<p>&lt;dl class="metro"&gt;
&lt;dt&gt;`(create-db-spec "testdb" "snarl://localhost:5820/" "admin" "admin" "none")<code>&lt;/dt&gt;
&lt;dd&gt;Creates a connection spec, for use in `connect</code> or <code>make-datasource</code> with the potential parameters:
<code>{:url "snarl://localhost:5820/" :db "testdb" :pass "admin" :user "admin" :max-idle 100 :max-pool 200 :min-pool 10 :reasoning "none"}</code>&lt;/dd&gt;
&lt;dt&gt;`(connect db-spec)<code>&lt;/dt&gt;
&lt;dd&gt;Creates a single Connection using the database spec.  Can be used with standard `with-open</code> macro, <code>with-transaction</code>, <code>with-connection-tx</code>.&lt;/dd&gt;
&lt;dt&gt;`(make-datasource db-spec)<code>&lt;/dt&gt;
&lt;dd&gt;Creates a data source, i.e. ConnectionPool, using the database spec.  Best used within the `with-connection-pool</code> macro.&lt;/dd&gt;
&lt;dt&gt;`(with-transaction [connection&#8230;&#8203;] body)<code>&lt;/dt&gt;
&lt;dd&gt;Executes the body with a transaction on each of the connections.&lt;/dd&gt;
&lt;dt&gt;</code>(with-connection-tx binding-forms body)<code>&lt;/dt&gt;
&lt;dd&gt;Establishes a connection and a transaction to execute the body within.&lt;/dd&gt;
&lt;dt&gt;</code>(with-connection-pool [con pool] .. con, body ..)`&lt;/dt&gt;
&lt;dd&gt;Evaluates body in the context of an active connection obtained from the connection pool.&lt;/dd&gt;
&lt;/dl&gt;</p>
</div>
<div class="paragraph">
<p>Using these functions, queries can then be made against the database.</p>
</div>
<div class="paragraph">
<p><code>query</code></p>
</div>
<div class="paragraph">
<p>Executes a query and returns results. When constructing a query from text, the parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>connection: The connection to query over (required).</p>
</li>
<li>
<p>text: The text of the connection (String - required).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Remaining argument are optional, and may be positional args, a map of args, or named args. Mapped and named args use the keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>base, parameters, reasoning, limit, offset, converter, key-converter</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Positional arguments are in order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>base: The base URI for the query (String).</p>
</li>
<li>
<p>parameters: A parameter map to bind parameters in the query (Map).</p>
</li>
<li>
<p>reasoning: The type of reasoning to use with the query (String/keyword).</p>
</li>
<li>
<p>converter: A function to convert returned values with (Function).</p>
</li>
<li>
<p>key-converter: A function to convert returned binding names with (Function).</p>
</li>
<li>
<p>limit: The limit for the result. Must be present to use offset (integer).</p>
</li>
<li>
<p>offset: The offset to start the result (integer)."</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building-stardog-clj">Building Stardog-clj</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To build Stardog-clj, you need a release of Stardog; we use
[Leiningen](<a href="http://leiningen.org/" class="bare">http://leiningen.org/</a>) as the build tool. Then,</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download stardog from [Stardog.com](<a href="http://www.stardog.com" class="bare">http://www.stardog.com</a>)</p>
</li>
<li>
<p>Run "mavenInstall" from the stardog-2.1.2/bin folder</p>
</li>
<li>
<p>Run "stardog-admin server start"</p>
</li>
<li>
<p>Run "stardog-admin db create -n testdb data/University0_0.owl"</p>
</li>
<li>
<p>You can now run lein compile, use the lein repl, and run lein midje to perform the tests</p>
</li>
<li>
<p>Run "lein install", which will install stardog-clj into ~/.m2/repository/stardog-clj/stardog-clj</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples-6">Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here are some examples of using stardog-clj</p>
</div>
<div class="sect2">
<h3 id="create-a-connection-and-run-a-query">Create a connection and run a query</h3>
<div class="paragraph">
<p>&lt;gist&gt;10039066?file=Stardog.clj&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="insert-data">Insert data</h3>
<div class="paragraph">
<p>&lt;gist&gt;10039743?file=StardogInsert.clj&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="run-a-query-with-a-connection-pool">Run a query with a connection pool</h3>
<div class="paragraph">
<p>&lt;gist&gt;10041003?file=StardogPool.clj&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="sparql-update-example">SPARQL Update Example</h3>
<div class="paragraph">
<p>&lt;gist&gt;11130645?file=StardogUpdate.clj&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="graph-function-for-construct-queries">Graph function for Construct queries</h3>
<div class="paragraph">
<p>&lt;gist&gt;11130603?file=StardogGraph.clj&lt;/gist&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="ask-function-for-ask-queries">Ask function for ASK queries</h3>
<div class="paragraph">
<p>&lt;gist&gt;11130618?file=StardogAsk.clj&lt;/gist&gt;</p>
</div>
</div>
</div>
</div>
<h1 id="snarl-migration-guide" class="sect0">SNARL Migration Guide</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>This document guides migration of code from SNARL 1.0 to SNARL 2.0 API.</p>
</div>
<div class="paragraph">
<p>##Deprecating and Renaming</p>
</div>
<div class="paragraph">
<p>All deprecated methods have been removed.</p>
</div>
<div class="paragraph">
<p>All <code>com.clarkparsia</code> packages have been moved to <code>com.complexible</code>.</p>
</div>
<div class="paragraph">
<p><code>com.clarkparsia.stardog.reasoning.ReasoningType</code> has been moved to <code>com.complexible.stardog.reasoning.api.ReasoningType</code>.</p>
</div>
<div class="paragraph">
<p><code>com.clarkparsia.openrdf.query</code> has been moved to <code>org.openrdf.queryrender</code>.</p>
</div>
<div class="paragraph">
<p>Everything else in <code>com.clarkparsia.openrdf</code> has been moved to <code>com.complexible.common.openrdf</code>.</p>
</div>
<div class="paragraph">
<p>All methods marked @Beta have been promoted.</p>
</div>
<div class="paragraph">
<p>##Queries</p>
</div>
<div class="paragraph">
<p>We introduced a new hierarchy for the class <code>com.complexible.stardog.api.Query</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>	+ com.complexible.stardog.api.Query
   		+ com.complexible.stardog.api.ReadQuery
      		+ com.complexible.stardog.api.BooleanQuery
      		+ com.complexible.stardog.api.GraphQuery
      		+ com.complexible.stardog.api.SelectQuery
   		+ com.complexible.stardog.api.UpdateQuery</code></pre>
</div>
</div>
<div class="paragraph">
<p>Queries can be created from a <code>com.complexible.stardog.api.Connection</code> object using the suitable method according to desired type of query: <code>select</code>, <code>ask</code>, <code>graph</code>, or <code>update</code>.</p>
</div>
<div class="paragraph">
<p>Now you can specify the reasoning type with which a particular <code>com.complexible.stardog.api.ReadQuery</code> is to be executed via the method <code>reasoning(ReasoningType)</code>. The query reasoning type overrides the reasoning type of the parent connection. Note that setting the reasoning type to <code>ReasoningType.NONE</code> will disable reasoning for that particular query, it does not affect the default reasoning specified by the <code>Connection</code>.</p>
</div>
<div class="paragraph">
<p>The methods <code>executeAsk()</code>, <code>executeSelect()</code>, and <code>executeGraph()</code> on <code>com.complexible.stardog.api.Query</code> have been removed. Queries can be executed by using the <code>execute()</code> method which will return a value appropriate for the type of query being executed.</p>
</div>
<div class="paragraph">
<p>##Connections</p>
</div>
<div class="paragraph">
<p>The class <code>com.complexible.stardog.api.admin.StardogDBMS</code> was removed.  It has been replaced by <code>com.complexible.stardog.api.admin.AdminConnectionConfiguration</code> for creating connections to the Stardog DBMS and <code>com.complexible.stardog.api.admin.AdminConnection</code> for the actual connection.</p>
</div>
<div class="paragraph">
<p>The method <code>login</code> on <code>com.complexible.stardog.api.admin.StardogDBMS</code> (now <code>com.complexible.stardog.api.admin.AdminConnectionConfiguration</code>) has been renamed <code>connect</code> to align with usage of the standard <code>com.complexible.stardog.api.ConnectionConfiguration</code></p>
</div>
<div class="paragraph">
<p>The method <code>connect(ReasoningType)</code> on <code>com.complexible.stardog.api.ConnectionConfiguration</code> has been removed.</p>
</div>
<div class="paragraph">
<p>The method <code>getBaseConnection()</code> on <code>com.complexible.stardog.api.reasoning.ReasoningConnection</code> has been removed.  To obtain a <code>ReasoningConnection</code> from a base connection, simply use <code>Connection.as(ReasoningConnection.class)</code>.</p>
</div>
<div class="paragraph">
<p>##Explanations</p>
</div>
<div class="paragraph">
<p>The explain functions of <code>com.complexible.stardog.api.reasoning.ReasoningConnection</code> now return <code>com.complexible.stardog.reasoning.Proof</code> objects. The <code>com.complexible.stardog.reasoning.Proof.getStatements()</code> function can be used to get only the asserted statements which is equivalent to what explain functions returned in 1.x.</p>
</div>
<div class="paragraph">
<p>##Starting the server</p>
</div>
<div class="paragraph">
<p>In order to create a new server we use a <code>ServerBuilder</code> obtained via the method <code>buildServer()</code> on <code>com.complexible.stardog.Stardog</code>; configuration options can be <code>set(Option&lt;T&gt;, T)</code> and the server is created for a particular address with <code>bind</code>. The following example shows how to create a new embedded SNARL server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Server aServer = Stardog
            .buildServer()
            .bind(SNARLProtocol.EMBEDDED_ADDRESS)
            .start();</code></pre>
</div>
</div>
<div class="paragraph">
<p>When programmatically starting a Stardog server in your application, you <strong>must</strong> stop the server when you&#8217;re done with it, otherwise it can prevent the JVM from exiting.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="protocols">Protocols</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As of Stardog 2.0, Stardog&#8217;s supported protocols, SNARL &amp; HTTP, now run on the <strong>same</strong> port.  There is no need to start separate servers or specify different ports.  The new unified Stardog server will automatically detect what protocol you are using and forward the traffic appropriately.  The default port for the server remains <code>5820</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="command-line-2">Command line</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The global options --home, --logfile, --disable-security for <code>server start</code> command have been turned into regular options. See the <code>stardog-admin help server start</code> for details.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in index.ad - include::understanding.ad[]</p>
</div>
<hr>
<div class="paragraph">
<p>quote: "In programming, as in everything else, to be in error is to be reborn."
title: "Man Pages"
layout: default
related: ""
toc: true
---</p>
</div>
<div class="paragraph">
<p>Stardog command-line interface is comprehensively documented in <code>man</code> pages that ship with Stardog. Those <code>man</code> pages are reproduced here in HTML as a convenience to the reader.  To install the man pages locally in your environment:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cp docs/man/Man1/* /usr/local/share/man1
$ cp docs/man/Man8/* /usr/local/share/man8
$ mandb
$ man stardog-admin-server-start</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="code-stardog-code-cli"><code>stardog</code> CLI</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[<code>data add</code>](/man/data-add.html), [<code>data export</code>](/man/data-export.html), [<code>data obfuscate</code>](/man/data-obfuscate.html), [<code>data remove</code>](/man/data-remove.html), [<code>data size</code>](/man/data-size.html)</p>
</li>
<li>
<p>[<code>icv convert</code>](/man/icv-convert.html), [<code>icv explain</code>](/man/icv-explain.html), [<code>icv export</code>](/man/icv-export.html), [<code>icv validate</code>](/man/icv-validate.html)</p>
</li>
<li>
<p>[<code>namespace add</code>](/man/namespace-add.html), [<code>namespace list</code>](/man/namespace-list.html), [<code>namespace remove</code>](/man/namespace-remove.html)</p>
</li>
<li>
<p>[<code>query execute</code>](/man/query-execute.html), [<code>query explain</code>](/man/query-explain.html), [<code>query obfuscate</code>](/man/query-obfuscate.html), [<code>query search</code>](/man/query-search.html)</p>
</li>
<li>
<p>[<code>reasoning consistency</code>](/man/reasoning-consistency.html), [<code>reasoning explain</code>](/man/reasoning-explain.html)</p>
</li>
<li>
<p>[<code>vcs commit</code>](/man/vcs-commit.html), [<code>vcs diff</code>](/man/vcs-diff.html), [<code>vcs list</code>](/man/vcs-list.html), [<code>vcs query</code>](/man/vcs-query.html), [<code>vcs revert</code>](/man/vcs-revert.html), [<code>vcs tag</code>](/man/vcs-tag.html).</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="code-stardog-admin-code-cli"><code>stardog-admin</code> CLI</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[<code>db backup</code>](/man/db-backup.html), [<code>db copy</code>](/man/db-copy.html), [<code>db create</code>](/man/db-create.html), [<code>db drop</code>](/man/db-drop.html), [<code>db list</code>](/man/db-list.html), [<code>db migrate</code>](/man/db-migrate.html), [<code>db offline</code>](/man/db-offline.html), [<code>db online</code>](/man/db-online.html), [<code>db optimize</code>](/man/db-optimize.html), [<code>db restore</code>](/man/db-restore.html), [<code>db status</code>](/man/db-status.html)</p>
</li>
<li>
<p>[<code>icv add</code>](/man/icv-add.html), [<code>icv drop</code>](/man/icv-drop.html),  [<code>icv remove</code>](/man/icv-remove.html)</p>
</li>
<li>
<p>[<code>metadata get</code>](/man/metadata-get.html), [<code>metadata set</code>](/man/metadata-set.html)</p>
</li>
<li>
<p>[<code>role add</code>](/man/role-add.html), [<code>role grant</code>](/man/role-grant.html), [<code>role list</code>](/man/role-list.html), [<code>role permission</code>](/man/role-permission.html), [<code>role remove</code>](/man/role-remove.html), [<code>role revoke</code>](/man/role-revoke.html)</p>
</li>
<li>
<p>[<code>server start</code>](/man/server-start.html), [<code>server status</code>](/man/server-status.html), [<code>server stop</code>](/man/server-stop.html)</p>
</li>
<li>
<p>[<code>query kill</code>](/man/query-kill.html), [<code>query list</code>](/man/query-list.html), [<code>query status</code>](/man/query-status.html)</p>
</li>
<li>
<p>[<code>user add</code>](/man/user-add.html), [<code>user addrole</code>](/man/user-addrole.html), [<code>user disable</code>](/man/user-disable.html), [<code>user enable</code>](/man/user-enable.html), [<code>user grant</code>](/man/user-grant.html), [<code>user list</code>](/man/user-list.html), [<code>user passwd</code>](/man/user-passwd.html), [<code>user permission</code>](/man/user-permission.html), [<code>user remove</code>](/man/user-remove.html), [<code>user removerole</code>](/man/user-removerole.html), [<code>user revoke</code>](/man/user-revoke.html)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Unresolved directive in index.ad - include::bench.ad[]</p>
</div>
<hr>
<div class="paragraph">
<p>quote: "Software is under a constant tension. Being symbolic it is arbitrarily perfectible; but also it is arbitrarily changeable."
title: "FAQ"
layout: "default"
toc: true
---</p>
</div>
<div class="paragraph">
<p>Some frequently asked questions for which we have answers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sparql-1-1">SPARQL 1.1</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Question:</strong> Does Stardog support SPARQL 1.1?</p>
</div>
<div class="paragraph">
<p><strong>Answer:</strong> Yes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deadlocks-and-slowdowns">Deadlocks and Slowdowns</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Question:</strong> Stardog slows down or deadlocks?! I don&#8217;t understand why,
I&#8217;m just trying to send some queries and do something with the
results&#8230;&#8203;in a tight inner loop of doom!</p>
</div>
<div class="paragraph">
<p><strong>Answer:</strong> Make sure you are closing result sets (<code>TupleQueryResult</code>
and <code>GraphQueryResult</code>; or the Jena equivalents) when you are done with
them. These hold open resources both on the client and on the server and
failing to close them when you are done will cause files, streams,
lions, tigers, and bears to be held open. If you do that enough, then
you&#8217;ll eventually exhaust all of the resources in their respective
pools, which can cause slowness or, in some cases, deadlocks waiting for
resources to be returned.</p>
</div>
<div class="paragraph">
<p>Similarly close your connections when you are done with them. Failing to
close <code>Connections</code>, <code>Iterations</code>, <code>QueryResults</code>, and other <strong>closeable</strong>
objects will lead to undesirable behavior.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bulk-update-performance">Bulk Update Performance</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Question:</strong> I&#8217;m adding one triple at a time, in a tight loop, to
Stardog; is this the ideal strategy with respect to performance?</p>
</div>
<div class="paragraph">
<p><strong>Question:</strong> I&#8217;m adding millions of triples to Stardog and I&#8217;m
wondering if that&#8217;s the best approach?</p>
</div>
<div class="paragraph">
<p><strong>Answer:</strong> The answer to both questions is "not really"&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>Generally overall update performance is best if you write between 1k
and 100k triples at a time. You may need to experiment to find the sweet
spot with respect to your data, database size, the size of the
differential index, and update frequency.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="public-endpoint">Public Endpoint</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Question:</strong> I want to use Stardog to serve a public SPARQL endpoint;
is there some way I can do this without publishing user account
information?</p>
</div>
<div class="paragraph">
<p><strong>Answer:</strong> We don&#8217;t necessarily recommend this, but it&#8217;s possible.
Simply pass <code>--disable-security</code> to <code>stardog-admin</code> when you start the
Stardog Server.  This <strong>completely</strong> disables security in Stardog which
will let users access the SPARQL endpoint, and all other functionality,
without needing authorization.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="remote-bulk-loading">Remote Bulk Loading</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Question:</strong> I&#8217;m trying to create a database and bulk load files from
my machine to the server and it&#8217;s not working, the files don&#8217;t seem to
load, what gives?</p>
</div>
<div class="paragraph">
<p><strong>Answer:</strong> Stardog does not tranfser files during database creation to
the server, sending big files over a network kind of defeats the purpose
of blazing fast bulk loading. If you want to bulk load files from your
machine to a remote server, copy them to the server and bulk load them.</p>
</div>
</div>
</div>
<h1 id="compatibility-policies" class="sect0">Compatibility Policies</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The Stardog 2.x release ("Stardog" for short) is a major milestone in
the development of the system. Stardog is a stable platform for the
growth of projects and programs written for Stardog.</p>
</div>
<div class="paragraph">
<p>Stardog provides (and defines) several user-visible things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>SNARL API</p>
</li>
<li>
<p>BigPacket Message Format</p>
</li>
<li>
<p>Stardog Extended HTTP Protocol</p>
</li>
<li>
<p>a command-line interface</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It is intended that programs—as well as SPARQL queries—written to
Stardog APIs, protocols, and interfaces will continue to run correctly,
unchanged, over the lifetime of Stardog. That is, over all releases
identified by version <code>2.x</code>. At some indefinite point, Stardog 3.x may
be released; but, until that time, Stardog programs that work today
should continue to work even as future releases of Stardog
(2.1, 2.2, etc.) occur.</p>
</div>
<div class="paragraph">
<p>APIs, protocols, and interfaces may grow, acquiring new parts and
features, but not in a way that breaks existing Stardog programs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="expectations">Expectations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although we expect that nearly all Stardog programs will maintain this
compatibility over time, it is impossible to guarantee that no future
change will break any program. This document sets expectations for the
compatibility of Stardog programs in the future. The main, foreseeable
reasons for which this compatibility may be broken in the future
include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Security</strong>: We reserve the right to break compatibility if doing
so is required to address a security problem in Stardog.</p>
</li>
<li>
<p><strong>Unspecified behavior</strong>: Programs that depend on unspecified&lt;fn&gt;The
relevant specs include the Stardog-specific specifications
documented on this site, but also W3C (and other) specifications of
various languages, including SPARQL, RDF, RDFS, OWL 2, HTTP, Google
Protocol Buffers, as well as others.&lt;/fn&gt; behaviors may not work in the
future if those behaviors are modified.</p>
</li>
<li>
<p><strong>3rd Party Specification Errors</strong>: It may become necessary to break
compatibility of Stardog programs in order to address problems in
some 3rd party specification.</p>
</li>
<li>
<p><strong>Bugs</strong>: It will not always be possible to fix bugs found in
Stardog&#8212;&#8203;or in its 3rd party dependencies&#8212;&#8203;while also preserving
compatibility. With that proviso, we will endeavor to only break
compatibility when repairing critical bugs.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It is always possible that the performance of a Stardog program may be
(adversely) affected by changes in the implementation of Stardog. No
guarantee can be made about the performance of a given program between
releases, except to say that our expectation is that performance will
generally trend in the appropriate direction.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-migration-safety">Data Migration &amp; Safety</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We expect that data safety will always be given greater weight
than any other consideration. But since Stardog stores a user&#8217;s data
differently from the form in which data is input to Stardog, we may from
time to time change the way it is stored such that explicit data
migration will be necessary.</p>
</div>
<div class="paragraph">
<p>Stardog provides for two data migration strategies:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Command-line migration tool(s)</p>
</li>
<li>
<p>Dump and reload</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We expect that explicit migrations may be required from time to time
between different releases of Stardog 2.x. We will endeavor to minimize
the need for such migrations. We will only require the "dump and reload"
strategy between <strong>major</strong> releases of Stardog (that is, from 1.x to 2.x, etc.),
unless that strategy of migration is required to repair a security
or other data safety bug.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="code-migration">Code Migration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Finally, the 2.0 release is not backward compatible with 1.x in two respects:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>license keys for customers must be regenerated for 2.x; this is one-time change</p>
</li>
<li>
<p>SNARL API 2.0 introduces backward incompatible changes and all code has been repackages (also a one-time change)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>See the <a href="#snarl-migration-guide">SNARL Migration Guide</a> for more details.</p>
</div>
</div>
</div>
<h1 id="known-issues-2" class="sect0">Known Issues</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The known issues in Stardog 2.2.3:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Our <code>CONSTRUCT</code> slightly deviates from
<a href="http://www.w3.org/TR/sparql11-query/#construct">SPARQL 1.1 specification</a> in that
it does not implicitly <code>DISTINCT</code> query results; rather, it implicitly applies
<code>REDUCED</code> semantics to <code>CONSTRUCT</code> query results.<span class="footnote">[<a id="_footnoteref_37" class="footnote" href="#_footnote_37" title="View footnote.">37</a>]</span></p>
</li>
<li>
<p>Asking for all individuals with reasoning via the query
<code>{?s a owl:Thing}</code> might also retrieve some classes and properties. <strong>WILLFIX</strong></p>
</li>
<li>
<p>Schema queries do not bind graph variables.</p>
</li>
<li>
<p>Dropping a database with the CLI deletes all of the data files
in Stardog Home associated with that database. If you
want to keep the data files and remove the database from the
system catalog, then you need to manually copy these files to
another location before deleting the database.</p>
</li>
<li>
<p>If relative URIs exist in the data files passed to create, add, or
remove commands, then they will be resolved using the constant base
URI <code><a href="http://api.stardog.com/" class="bare">http://api.stardog.com/</a></code> iff the format of the file allows base
URIs. Turtle and RDF/XML formats allows base URIs but N-Triples
format doesn&#8217;t allow base URIs and relative URIs in N-Triples data
will cause errors.</p>
</li>
<li>
<p>Queries with <code>FROM NAMED</code> with a named graph that is <strong>not</strong> in
Stardog will <strong>not</strong> cause Stardog to download the data from an arbitrary
HTTP URL and include it in the query. Stardog will <strong>only</strong> evaluate
queries over data that has been loaded into it.</p>
</li>
<li>
<p>SPARQL queries without a context or named graph are executed against
the default, unnamed graph. In Stardog, the default graph is <strong>not</strong>
the union of all the named graphs and the default graph. Note: this
behavior is configurable via the <code>query.all.graphs</code> configuration
parameter.</p>
</li>
<li>
<p>RDF literals are limited to 8MB (after compression) in Stardog.
Input data with literals larger than 8MB (after compression) will
raise an exception.</p>
</li>
</ol>
</div>
</div>
</div>
<h1 id="terminology-3" class="sect0">Terminology</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>In the Stardog documentation, the following terms have a specific
technical meaning.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Stardog Database Management System, aka Stardog Server
</td>
<td class="hdlist2">
<p>An
instance of Stardog; only one Stardog Server may run per JVM. A computer may run
multiple Stardog Servers by running one per multiple JVMs.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Stardog Home, aka <code>STARDOG_HOME</code>
</td>
<td class="hdlist2">
<p>A directory in a filesystem in which Stardog
stores files and other information; established either in a Stardog
configuration file or by environment variable. Only one Stardog Server may run
simultaneously from a <code>STARDOG_HOME</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Stardog Network Home
</td>
<td class="hdlist2">
<p>A URL (HTTP or SNARL) which identifies a Stardog Server
running on the network.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Database
</td>
<td class="hdlist2">
<p>A Stardog database is a graph of RDF data under management of a
Stardog Server. It may contain zero or more RDF Named Graphs. A Stardog Server
may manage more than one Database; there is no hard limit, and the practical
limit is disk space.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Database Short Name, aka Database Name
</td>
<td class="hdlist2">
<p>An identifier used to name a
database, provided as input when a database is created.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Database Network Name
</td>
<td class="hdlist2">
<p>A Database Short Name is part of the URI of a Database
addressed over some network protocol.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Index
</td>
<td class="hdlist2">
<p>The unit of persistence for a Database. We sometimes (sloppily) use
Database and Index interchangeably in the manual.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Memory Database
</td>
<td class="hdlist2">
<p>A Database may be stored in-memory or on disk; a Memory Database is
read entirely into system memory but can be (optionally) persisted to disk.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Disk Database
</td>
<td class="hdlist2">
<p>A Disk Database is only paged into system memory as needed and
is persisted using one or more indexes.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Connection String
</td>
<td class="hdlist2">
<p>An identifier (a restricted subset of legal URLs, actually)
that is used to connect to a Stardog database to send queries or perform other
operations.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Named Graph
</td>
<td class="hdlist2">
<p>A Named Graph is an explicitly named unit of data within a
Database. Named Graphs are queries explicitly by specifying them in SPARQL
queries. There is no practical limit on the number of Named Graphs in a
Database.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Default Graph
</td>
<td class="hdlist2">
<p>The Default Graph in a Database is the context into which RDF
triples are stored when a Named Graph is not explicitly specified. A SPARQL
query executed by Stardog that does not contain any Named Graph statements is
executed against the data in the Default Graph only.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Security Realm
</td>
<td class="hdlist2">
<p>A Security Realm defines the users and their permissions for
each Database in an Stardog Server. There is only one Security Realm per Stardog
Server.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. Thanks to all Stardog users, contributors, testers, etc., especially Robert Butler, Al Baker, Marko A. Rodriguez, Brian Sletten, Alin Dreghiciu, Rob Vesse, Stephane Fallah, John Goodwin, José Devezas, Chris Halaschek-Wiener, Gavin Carothers, Brian Panulla, Ryan Kohl, Morton Swimmer, Quentin Reul, Paul Dlug, James Leigh, Alex Tucker, Ron Zettlemoyer, Jim Rhyne, Andrea Westerinen, Huy Phan, Zach Whitley, Maurice Rabb, the crew at XSB, and the nice people at El Rinconcito Cafe in DC.
</div>
<div class="footnote" id="_footnote_2">
<a href="#_footnoteref_2">2</a>. That is, the server listens to one port (5820) and handles both protocols.
</div>
<div class="footnote" id="_footnote_3">
<a href="#_footnoteref_3">3</a>. That is, the server listens to one port (5820) and handles both protocols.
</div>
<div class="footnote" id="_footnote_4">
<a href="#_footnoteref_4">4</a>. Stardog will not retrieve data from the Web or from any other network via HTTP URLs in order to query that data. If you want to query data using Stardog, you must add that data to a new or existing Stardog database.
</div>
<div class="footnote" id="_footnote_5">
<a href="#_footnoteref_5">5</a>. Stardog does not support SPARQL 1.1 federation (the <code>SERVICE</code> keyword)
</div>
<div class="footnote" id="_footnote_6">
<a href="#_footnoteref_6">6</a>. Find another database that can do that!
</div>
<div class="footnote" id="_footnote_7">
<a href="#_footnoteref_7">7</a>. It&#8217;s very unlikely you&#8217;ll need this.
</div>
<div class="footnote" id="_footnote_8">
<a href="#_footnoteref_8">8</a>. For more details about configuring these values, see the <code>examples/stardog.properties</code> file that is distributed with Stardog.
</div>
<div class="footnote" id="_footnote_9">
<a href="#_footnoteref_9">9</a>. Compressed data may only be loaded at database creation time. We will support adding compressed data to an existing database in a future release.
</div>
<div class="footnote" id="_footnote_10">
<a href="#_footnoteref_10">10</a>. However, there may be some delay since Stardog only periodically checks the <code>query.timeout</code> value against internal query evaluation timers.
</div>
<div class="footnote" id="_footnote_11">
<a href="#_footnoteref_11">11</a>. However, <code>READ COMMITTED</code> does allow for non-repeatable reads.
</div>
<div class="footnote" id="_footnote_12">
<a href="#_footnoteref_12">12</a>. The probability of recovering from a catastrophic transaction failure is inversely proportional to the number of subsequent write attempts; hence, Stardog offlines the database to prevent subsequent write attempts and to increase the likelihood of recovery.
</div>
<div class="footnote" id="_footnote_13">
<a href="#_footnoteref_13">13</a>. Stardog also uses file handles and sockets, but we don&#8217;t discuss those here.
</div>
<div class="footnote" id="_footnote_14">
<a href="#_footnoteref_14">14</a>. These are conservative values and are somewhat dataset specific. Yr data may require less memory..or more!
</div>
<div class="footnote" id="_footnote_15">
<a href="#_footnoteref_15">15</a>. To fully achieve this effect requires,  DNS or HaProxy or similar environmental configuration that&#8217;s left as an exercise for the user.
</div>
<div class="footnote" id="_footnote_16">
<a href="#_footnoteref_16">16</a>. The client here means the client of Stardog APIs, not necessarily people, administrators, etc.
</div>
<div class="footnote" id="_footnote_17">
<a href="#_footnoteref_17">17</a>. This will be renamed in a future release.
</div>
<div class="footnote" id="_footnote_18">
<a href="#_footnoteref_18">18</a>. Based on customer feedback we may relax these consistency guarantees in some future release. Please get in touch if you think an eventually consistent approach is more appropriate for yr use of Stardog.
</div>
<div class="footnote" id="_footnote_19">
<a href="#_footnoteref_19">19</a>. In other words, embedded Stardog access is inherently <strong>insecure</strong> and should be used accordingly.
</div>
<div class="footnote" id="_footnote_20">
<a href="#_footnoteref_20">20</a>. Stardog does not support client authentication using X.509 certificates instead of passphrases.
</div>
<div class="footnote" id="_footnote_21">
<a href="#_footnoteref_21">21</a>. Reverse proxying may be useful beyond SSL layering—it may be used to distribute load across multiple Stardog servers. For general documentation of reverse proxying with lighttpd, see <a href="http://redmine.lighttpd.net/wiki/lighttpd/Docs:ModProxy" class="bare">http://redmine.lighttpd.net/wiki/lighttpd/Docs:ModProxy</a>; likewise for Apache: <a href="http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#forwardreverse" class="bare">http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#forwardreverse</a>.
</div>
<div class="footnote" id="_footnote_22">
<a href="#_footnoteref_22">22</a>. For example, see <a href="http://docs.oracle.com/javaee/1.4/tutorial/doc/Security6.html" class="bare">http://docs.oracle.com/javaee/1.4/tutorial/doc/Security6.html</a> for creating a certificate with the Java keytool; or <a href="http://www.openssl.org/docs/apps/req.html" class="bare">http://www.openssl.org/docs/apps/req.html</a> for an example of generating a self signed root certificate using the openssl req tool.
</div>
<div class="footnote" id="_footnote_23">
<a href="#_footnoteref_23">23</a>. lighttpd can be configured to present chaining certificates with the server certificate. This may be necessary if the server certificate is not directly signed by a trusted authority, but chains to a trusted authority. For details on this configuration see <a href="http://redmine.lighttpd.net/wiki/lighttpd/Docs:SSL" class="bare">http://redmine.lighttpd.net/wiki/lighttpd/Docs:SSL</a> (the ssl.ca-file option).
</div>
<div class="footnote" id="_footnote_24">
<a href="#_footnoteref_24">24</a>. A complete configuration file is not provided because the minimal configuration file required by Apache is more detailed than the configuration file required by lighttpd. The configuration directives shown are those necessary to enable SSL and reverse proxying.
</div>
<div class="footnote" id="_footnote_25">
<a href="#_footnoteref_25">25</a>. The Stardog HTTP client driver uses an <code>X509TrustManager</code>. The details of how a trust store is selected to initialize the trust manager are <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html#X509TrustManager" class="bare">http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html#X509TrustManager</a>.
</div>
<div class="footnote" id="_footnote_26">
<a href="#_footnoteref_26">26</a>. See the <code>javax.net.ssl.trustStorePassword</code> system property docs: <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html#X509TrustManager" class="bare">http://docs.oracle.com/javase/6/docs/technotes/guides/security/jsse/JSSERefGuide.html#X509TrustManager</a>.
</div>
<div class="footnote" id="_footnote_27">
<a href="#_footnoteref_27">27</a>. The matching algorithm used is described&#8212;&#8203;<a href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html--" class="bare">http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html--</a> in the Apache docs about <code>BrowserCompatHostnameVerifier</code>.
</div>
<div class="footnote" id="_footnote_28">
<a href="#_footnoteref_28">28</a>. You only pay for the reasoning that you use; no more and no less. Eager materialization is for hard disk manufacturers.
</div>
<div class="footnote" id="_footnote_29">
<a href="#_footnoteref_29">29</a>. Find another database, any other database anywhere, that can do that!
</div>
<div class="footnote" id="_footnote_30">
<a href="#_footnoteref_30">30</a>. Triggered using the <code>--format tree</code> option of the <code>reasoning explain</code> CLI command.
</div>
<div class="footnote" id="_footnote_31">
<a href="#_footnoteref_31">31</a>. Quick refresher: the <code>IF</code> clause defines the conditions to match in the data; if they match, then the contents of the <code>THEN</code> clause "fire", that is, they are inferred and, thus, available for other queries, rules, or axioms, etc.
</div>
<div class="footnote" id="_footnote_32">
<a href="#_footnoteref_32">32</a>. Of course if you&#8217;ve tweaked <code>reasoning.schema.graphs</code>, then you should put the rules into the named graphs that are specifed in that configuration parameter.
</div>
<div class="footnote" id="_footnote_33">
<a href="#_footnoteref_33">33</a>. These are harmless and won&#8217;t otherwise affect query evaluation; they can also be added to the data, instead of to queries, if that fits yr use case better.
</div>
<div class="footnote" id="_footnote_34">
<a href="#_footnoteref_34">34</a>. The standard inference semantics of OWL 2 do not adopt the unique name assumption because, in information integration scenarios, things often have more than one name but that doesn&#8217;t mean they are different things. For example, when several databases or other data sources all contain some partial information about, say, an employee, but they each name or identify the employee in different ways. OWL 2 won&#8217;t assume these are different employees just because there are several names.
</div>
<div class="footnote" id="_footnote_35">
<a href="#_footnoteref_35">35</a>. Strictly speaking, this is a bit misleading. Stardog ICV uses both open and closed world semantics: since inferences can violate or satisfy constraints, and Stardog uses open world semantics to calculate inferences, then the ICV process is compatible with open world reasoning, to which it then applies a form of closed world validation, as described in this chapter.
</div>
<div class="footnote" id="_footnote_36">
<a href="#_footnoteref_36">36</a>. This is a good example of open world and closed world reasoning interacting for the win.
</div>
<div class="footnote" id="_footnote_37">
<a href="#_footnoteref_37">37</a>. Strictly speaking, this is a Sesame parser deviation from the SPARQL 1.1 spec with which we happen to agree.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2014-12-03 13:57:53 EST
</div>
</div>
</body>
</html>